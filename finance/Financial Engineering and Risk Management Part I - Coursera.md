## 001.Course Overview

### 001. Course Overview

In this module, we're going to give you a brief overview of the entire course of Financial Engineering and Risk Management. We'll introduce the ideas of financial markets, financial products, what do financial markets and financial products do for you. We'll introduce the ideas of the main problems in financial engineering, and how these relate to the different issues that come up in practical application financial engineering and risk management. Why do we need financial markets? Financial markets enable efficient allocation of resources both across time, and across states of nature. What do you mean by across time? What we mean is, that you have income available today, but you want to allocate that income for sometime in the future. You have income available today, but tomorrow the states of nature are uncertain. You don't know whether you would have income available there. You don't know what your costs are going to be in the future. Depending upon various events happening, you might need more or less amount of funds. And financial markets allow you the possibility of taking funds that are available today, move them across time, and move them across to states of nature that are uncertain. A young worker with a high salary right now, what should she do? If there are financial markets available, she could invest in stocks and bonds to finance retirement, home ownership, education and so on. If there were no financial markets available, she would have such as, a home car and so on. But she's not going to be able to move that later on in time to have them available when the states of nature are not good. This idea of states of nature actually becomes more clearer if you consider the example of a farmer producing oranges. The farmer is producing oranges, and she is open to the risk of the price of orange when she produced when he product gets ready and it goes into the market. If there were financial markets available, as they are right now, she could hedge the price of the oranges in the future using the futures market. She could also buy vetter related derivatives, and use these derivatives to protect against the possibility of her produce going bad as a result of freeze, and so on. If there were no financial markets available, she would be open to the vagaries of the spot market. She can not hedge the price, nor can she hedge against the uncertainty of a produce not coming through, because of some weather-related emergency. What do markets do? They essentially do three things. They gather information. Markets are a place where buyers and sellers come together. They take action based on their information. This information gets aggregated, and that aggregated information gets deflected in the price of the product. And in some sense, this information gathering is necessary in order for a fair price to be created. It aggregates liquidity, so there are many buyers and sellers for a particular product. If there was no market, the buyers and the sellers would have to go looking for a counter party. Looking for a person who wants to take the opposite position. With a market, all the buyers and sellers come together, the liquidity gets aggregated, and as a result, the, both the buyers and sellers get a better price. By gathering information and by gathering liquidity, markets introduce or promote efficiency and fairness. What about products? Financial products are created to satisfy needs. New products hedge risk. They also allow for speculation. Products allow to, one to raise funds for an operation, for example, using by, by issuing shares and an IPO. They also allow you to fund liabilities. Financial markets can be modeled in several different ways. There are two standard market models that are out there. One of them is called a discrete time model, in which time goes forward in discrete steps. There are single period discrete time models and there are multiperiod discrete time models. The other class of model is called continuous time models. Continuous time models, time does not ad, advance discretely but in a continuous fashion. The pros and cons of discrete time models are as follows. The good thing about a discrete time model is that it's simple. We can introduce all important concepts with very easy mathematics. Much less sophisticated mathematics than is necessary for the continuous time model. The problem with discrete time models is there are no closed form solutions possible. Solutions are not as elegant as those available for continuous time models, and one has to resort to numerical calculations. This used to be a problem when computation was hard, and you couldn't do sophisticated comput, computation on simple machines. But as the price of computers have been coming down, people have tended to move more and more into discrete time models because they are simpler. You can introduce all kinds of interesting effects and compute them, rather than trying to look for a closed form solution. The focus of this course will be on discrete time multi-period models. We want to keep the mathematics simple, and yet be able to introduce all the concepts that are necessary, for you to understand financial engineering and risk management. There is a little bit of a caveat. Very, very few continuous time concepts will be used. For example, the Black-Scholes formula, which comes from continuous time analysis will be introduced because this is a very classic formula. And anyone graduating from a course on financial engineering and risk management, ought to know this formula. Another topic that's of interest, is what's the difference between financial economics and financial engineering. Financial economics is concerned with using equilibrium concepts to price something called primary assets. These are equities, bonds, interest rates, and so on. Financially engineering on the other hand assumes the price of the primary assets such that equities and interest rates are given. And the focus of this field is on pricing derivatives and these primary assets using the no arbitrage condition. But these distinction between financial economics and financial engineering is by no means a complete separation. For example, the capital asset pricing model, which prices assets is of interest to both financial engineering and financial economics. There are three central problems of Financial Engineering. Security pricing, portfolio selection, and risk management. The main focus of security pricing is to price derivative securities such as forwards, swaps, futures, and options on the underlying primary securities using the no arbitrage condition. The focus of portfolio selection, is to choose a trading strategy to maximize the utility of consumption and final wealth. It turns out that portfolio selection is very intimately related to security pricing, and this will become clearer as we go through the course. Single-period models, such as Markowitz portfolio selection, are very widely used in industry. Multi-period models are much harder, but starting to get more traction. There's also the issue of pricing and using real options, such as options on gas pipelines, oil leases, and mines. These are also part of a portfolio selection strategy. The third important topic is risk management. And the goal of this area is to understand the risks inherent in the portfolio. Here, we are not trying to choose a portfolio, the portfolio is already given. We just want to stress test the, the portfolio to understand how it performs in different market conditions. The important topics that come up in risk management are tail risk, which is a probability of large losses. Two risk measures that have become very important for tail risk, are the value at risk and the condition of value at risk. These two risk measures were introduced for risk management, but have started to become much more important for portfolio selection as well. Financial engineering has led to some very interesting problems in applied math and operations research. For example, how does a company manage its operational risks using financial products? This is a marriage between supply chain management one side, which is one of the core ideas in operations research. And financial engineering on the other side, which talks about risk management and portfolio selection. You bring the two together, and now you have the possibility of hedging operational risks, which have got nothing to do with financial engineering per se, and combining them with financial products to get an idea of how one could hedge the risk across different areas.

## 002.Basics of Fixed Income Securities

### 002. Introduction to No-arbitrage

In this module, we'll introduce the concept of no-arbitrage and work through a very simple example of the application of the no-arbitrage principle to pricing. Consider a contract that pays ck dollars at time t equal to k, where k takes values one, two, three up to T. And let's say that one has to pay a price p at time t equal to zero in order to receive this contract, in order to get this cash flow. So the story is, here is time t equal to zero, where you pay a price p. Here is time t is equal to one, and all the way up to time t equal to capital T. And you, you get cash flows c one, c two, and so on, up to c capital T. And the goal of this module, is to introduce ideas of no-arbitrage that allow us to, fix this price p. It'll turn out that in certain circumstances we will be able to fix this price exactly. And in certain other circumstances, we can only be able to bound the price. We can tell you the price cannot be larger than a certain quantity, and cannot be smaller than a certain quantity. There are two ideas of arbitrage that are used in financial engineering. One idea is called weak no-arbitrage, and the second idea is called strong no-arbitrage. Both of these ideas essentially eliminate the possibility of a free lunch. Let's first consider weak no-arbitrage. What this condition says is, suppose there is a contract such that the cash flows associated with this contract are non negative for all times K greater than equal to one. C1, C2, C3 and so on up through C capital T are all greater than equal to zero. If there is such a contract then the price for this contract must be greater than equal to zero. The stronger arbitrage condition says that suppose there is a contract for which the cash flows are non negative for all times in the future, and there exists some time, cl in the future, such that the cash flow is strictly positive. Then the price for such a contract must be strictly positive. Both of these conditions are motivated by the fact that in a market if there are contracts for which you get something for nothing, then just by supply and demand that price, that contract will be priced to a point where you had to pay a fair price. Let's walk through the rationale for the weak no-arbitrage condition. Suppose there exists a contract for which CK is greater than equal to zero. That means you get non negative cash flows for all times in the future, but the price for such a contract is less than zero. So, weak no-arbitrage says that price must be greater than equal to zero. Here, I'm assuming that the price is less than zero, and let's see what happens. Since CK is greater than equal to zero, you do not owe anything in the future. And the buyer of such a contract receives minus P, because P is less than zero, which means you have to pay a negative amount or receive it. Which is the same thing as saying you receive a positive amount at time T equal to zero, the buyer never loses anything. And at the same time, gets money at time t equal to zero. This is a free lunch, weak no-arbitrage condition says this cannot happen. Why cannot it not, what, why can't this happen? This cannot happen because if there is such a contract such that p is less than zero, then the seller of such a contract will start increasing the price. It's a bad deal for the seller. The seller will keep increasing the price, but for any price p less than zero this is a very good deal for the buyer, so the buyers are still going to be there. And this price, the seller will keep increasing the price until p hits equal to zero. At least she might be able to increase the price to be something greater than zero, but the weak no-arbitrage condition does and, doesn't allow us to figure out how exactly this price is going to work once the price becomes greater than zero. We can only say using a weak no-arbitrage condition, that the price will be increased until p becomes greater than equal to zero. You can make the same argument from the buyer's perspective, since it is a good deal for any price less than zero, the buyers will be willing to pay a higher price in order to compete. They will compete with each other until the speed less than zero cannot be sustained in the market. Recall, in the other module, I talked about the fact that how prices get set by supply and demand. You again see here that the rationale for weak no-arbitrage is built on supply and demand. We are building it on the fact that there are many buyers, many s-, sellers. We are also using the fact that the information about the details of the contract are publicly available, are uniformly available to buyers and sellers. This is going to be important and we'll emphasize this again on the next slide. Here, I'm going to work through the rationale for a strong no-arbitrage condition. Suppose p is less than equal to zero. Strong no-arbitrage conditions says that p must be strictly greater than zero for a contract for which the future cash flows are greater than equal to zero, and that exists sometime where the cash flow is strictly positive. Since CL is greater than zero for some L greater than equal to one, even if p is equal to zero, this is a free lunch. It's a free lunch as long as p is less than equal to zero. Again using the same arguments that we used before, the seller of such a contract will have an incentive to increase the price. The buyers will still be around, because it's still a good deal at something positive. We cannot guarantee what the precise value of the price is going to be. But for some price strictly positive it'll still remain a good deal because there exists a cash flow cl which is strictly positive for some time, L, in the future. And again, buyers and sellers will compete in order to set the price p. The implicit assumptions that are underlying the no-arbitrage conditions are the markets are liquid, which means there are sufficient numbers of buyers and sellers. If the markets are il-liquid, then no-arbitrage condition is not valid, and the bounds that we generate using the no-arbitrage argument will no longer be valid. We also assume that price information is available to all buyers and sellers. The price information here basically means, what are the cash flows? If there are buyers and sellers which are ignorant about the cash flows, then the price formation process will not happen. We also assume that the competition in supply and demand will correct any deviation from the no-arbitrage prices. And this again presupposes that there is a market, these markets are liquid. The price information goes to every buyer and every seller, so that they can decide how to set the price efficiently. The rest of this module I'll just walk you though a very simple example in how to use no-arbitrage condition to price a very simple fixed income instrument. In the later modules we will go over more complicated examples where you use no-arbitrage condition to set prices for more complex derivatives. So consider a very simple bond. What this bond gives you is 8 dollars in one year, and we want to set the price for this bond. Suppose in the market, one is able to borrow and lend unlimited amounts at an interest rate r per year. So, the bond pays $8 in one year. We can borrow and lend unlimited amounts at the interest rate of r per year. And we want to figure out, what is a fair price, or an arbitrage free price for a contract that pays $8 in one year. We'll do it by constructing two different portfolios. So let's construct the following portfolio. You buy the contract at price p, and you borrow a divided one plus r dollars at an interest rate of r. Consider the cash flows associated with this portfolio. In the future, in one year, the contract will pay A dollars and you've borrowed A divided by one plus r at the interest rate of r, so you have to pay A dollars. These two cancel each other. So the cash flow in one year is A minus A equal to zero. So c1 is equal to zero. And what is the price of this portfolio? The price of this portfolio is p, the amount that you had to pay to get the contract, minus A divided by one plus r, because this was the cash flow that you received at time T equal to zero. So the net price that you paid for the portfolio is p minus A over one plus r. Now, let's use the weak no-arbitrage condition. The weak no-arbitrage condition says that if the cash flows in the future, and in this particular case there's only one time in which there is a cash flow in the future in one year. If the cash flows in the future are greater than equal to zero, then the price must be greater than equal to zero. C1 greater than equal to zero implies that the price of the portfolio Z must be greater than equal to zero. Price Z is equal to P minus A divided by one plus R. This must be greater than equal to zero, which means that P must be greater than equal to A divided by one plus R. So we now get a lower bound for the price. No-arbitrage weak no-arbitrage condition gives me a lower bound on the price. And we got this lower bound by constructing an appropriate portfolio. Now, in the next slide, we'll get an upper bound for the price by constructing a different portfolio. So construct a portfolio, we sell the contract at price B, and lend A divided by one plus r at the interest rate r. Now what happens? The cash flow is again zero in the future, because you've lent an amount A divided by one plus r at interest rate r. So in one year this becomes, this returns your value A. Since you have sold the contract, you are now responsible to pay A dollars to the buyer of the contract in one year. These two cash flows cancel each other, and therefore C1 again is greater than equal to zero. In fact C1 is equal to zero, which is the same thing as greater than equal to zero. It satisfies the condition that greater than, C1 is greater than equal to zero. What about the price of this portfolio? The price of the portfolio is how much did you have to pay, in order construct this portfolio. . Since you sold the contracted price p you receive that amount, so that's minus p, because you had to lend A divided by one plus r, the interest rate r. This is the out flow, so A divided by one plus r is the total amount that you had to pay. The difference between these two, A divided by one plus r minus p, tells you the price of the portfolio. A weak no-arbitrage condition tells me that since C1 is greater than equal to zero, the price that I paid for this contract must also be greater than equal to zero. So, z is equal to A divided by one plus r minus p. This must be greater than equal to zero, which means that A divided by one plus r must be greater than equal to p. If you combine this upper bound with the lower bound, that we constructed in the slide just before, you get that p must be exactly equal to one plus r. Could this be a surprise? Not at all. All we are doing is constructing the net present value calculation using a no-arbitrage condition. The advantage of doing this net present value calculation using the no-arbitrage condition is that it clearly shows what are the assumptions that are needed in order for the net present value to exist. It relied heavily on the ability to borrow and lend at the interest rate r, an unlimited amount. If we are a, if these assumptions are not true, then the net present value is not the correct price. And we would have to use some other techniques to figure out what the correct price would be. And no-arbitrage conditions would still be valid, except that we will have to use them with different portfolios perhaps. So what happens if the borrowing and then the lending rates are different? I can't use net present value, but I can use no-arbitrage. What if the borrowing and lending markets are elastic, which means that if you want to borrow or lend. The interest rate that you're going to be charged depends on the amount that you're borrowing or lending. What happens in that case? Again the net present value calculation is not valid, but we can construct no-arbitrage conditions which would give us, if not the exact price, at least bounds on what such a contract can cost.

### 003. Interest Rates and Fixed Income Instruments

In this module, we're going to introduce you to interest rates, present values, and how present values are implied by the no arbitrage principles, and also, introduce you to the idea of fixed income instruments. An amount A, invested for N periods at simple interest rate of R per period, is going to be worth A times 1 plus n r at maturity. In every period, you'd get an interest R times A. So over n periods, you're going to get an interest of n time a times r, and you get back your initial investment and therefore the total amount is going to be a, times one, plus n times r. An amount a, invested for n periods at the compound interest of r per period, is going to be worth, a, times one plus r raised to the power of n, at maturity. And the way to think about it is what is happening at time zero you invest A amount. One period later this amount A has now become 1 plus R times A. This total amount is now invested for another period. So it becomes A times one plus R squared, and so on. So after N periods, it becomes one plus R to the power N times A, or A times one plus R to the power N. Interest rates are typically quoted on an annual basis, even if the compounding period is less than one year. If there are n compounding periods in a year and the interest rate is r per year or per annum, then an amount a, invested for y years, is going to yield a times 1 plus r over n. So R over N, this is the interest per period and the total number of periods in Y years is going to be Y times N so this is the total number of periods. And the amount that you end up getting is A times one plus the interest per period raised to the power the total number of periods. Continuous compounding corresponds to the situation where the length of the compounding period goes to zero, therefore an amount A invested for Y years is now going to be worth, the number of periods of N going to infinity of A times one plus R over N raised to the power YN. And if you take the limit of N going to infinity, that expression solves as A times E raised to the power of Y at maturity. The number of. The compounding period is going to zero, therefore the number of compounding periods is going to infinity. And you end up getting that the expression simplifies to A times E raised to the power RY. For those of you who are [INAUDIBLE] differential equations, you can find out that basically what's going to happen is dA dt. Is going to be R times A, and if you solve this differential equation you'll get exactly the same expression that we have on that slide. Next, what we want to use is this idea of compounding to calculate present value. Remember, in the last module, we showed how the present value for a very simple bond, which pays A dollars in one year, you can calculate that using a no-arbitrage argument. We're going to do the same thing here using an interest rate R, and then we're going to expand that to the idea of borrowing rates and lending rates being different. So we want to compute the price p for a contract that pays c0, c1, c2, and so on cn at times 0, 1, 2, 3, 4, n and so on. If ck is greater than zero, that's a cash inflow, if ck is less than zero, that's a cash outflow. The present value, assuming an interest rate R per period, can be written as C0 plus C1 divided by one plus R, C2 divided by one plus R squared, and CN divided by one plus R N, capital N. In terms of an expression, this is the expression for the present value. We are going to argue that this present value is in fact the arbitrage free price b for this contract. Here's the argument. We're going to assume that we can borrow and lend at unlimited amounts at the rate r. And the portfolio vehicle to construct is false. You're going to buy the contract. If you buy the contract, what happens? At time t equal to 0, you have to pay an amount minus b, and you receive and amount c 0. At time t equal to 1, you pay, you'd receive c 1, time t equal to 2, you'd receive c 2, and time equal to k, some general k, you'd receive c k and at time t equal to capital T, you'd receive c T. I'm going to borrow c1 divided by 1 plus r amount for up to time 1. So at time t equal to 0, this is the amount that comes into my pocket. At time t equal to 1, I have to pay out, I have to return the amount that I borrowed. And how much do I have to return? It's going to be the amount that I borrowed times 1 plus r. And which cancels out the divide by 1 plus r you end up getting exactly minus c1. Similarly I'm going to borrow c2 divided by 1 plus r squared up to time 2. I will get c2 divided by 1 plus r squared into my pocket at time t equal to 0 and I have to pay out an amount c2 at time t equal to 2. Generically for a general time k, I'm going to borrow ck divided by 1 plus r to the power k. I received that amount at time t equal to 0 and then I have to pay out minus ck at time t equal to k. And what you notice by doing this construction, is that the cash flows at all future times cancel out exactly. So, the portfolio's cash flow is for all time k equal to 1, 2, 3 up to capital T turns out to be 0. And the weak no-arbitrage condition then tells me that the price that I would have had to pay for constructing this portfolio at time t equal to 0 must be greater or equal to 0. All future cash flows are greater than or equal to 0. Therefore the price at time t equal to 0 must be greater than or equal to 0. What is the price at time t equal to 0? It's the negative of the cash flow. How much did I have to pay? It's the negative of the amount that I received. So the price of the portfolio is going to be, minus the summation from k equal to 0 to capital T, c k over 1 plus r, to the power k. That must be greater than or equal to 0. That gives me a lower bound, and the price must be greater than or equal to this expression, which is exactly the present value calculation. In order to get an upper bound of the price, I'm going to reverse the portfolio. I'm going to sell the contract. And if I sell the contract, what happens? I receive an amount, p, at time t equal to zero, but now I'm responsible for the cash flows associated with the contract. I have to be, paying the cash flows to the buyer. So I have to pay out C0. I have to pay out C1, C2, all the way up to minus CT. The negative is in front. Because now instead of receiving these cash flows, I have to pay them out. I'm going to lend an amount, C1 divided by one plus R, up to time one. So when I lend them out, money goes away at time T equal to zero. But I get it back at time T equal to one. I lend an amount c2 divided by 1 plus r squared up to time 2. Similarly, money goes out at time t equal to 0. But it comes back now at time t equal to 2. And how much comes back? It's minus c2 divided by 1 plus r squared times 1 plus r squared, which is exactly c2. Again, if you notice, what we have done here is constructed a portfolio, such that its future cash flows are going to be equal to 0, or more weakly, greater or equal to 0, because everything cancels out. And therefore, the weak arbitrage condition tells me that the price that I paid for this particular portfolio at time t equal to 0, must be greater than equal to 0. What is the price? It's the negative of the cash flow at time t equal to zero. It's going to be the sum of k equal to 0 1 through capital T, ck divided by 1 plus r k, 1 plus r to the power k minus b. And this price of the portfolio must be greater than or equal to zero. Which means that the p must be less than equal to the present value. The two bounds together implies that the arbitrage-free price, the no-arbitrage price for a contract, which has a cash flow C zero up through C capital T associated per period. And in the market where you could borrow or lend unlimited amounts at an interest rate of R per period. Is given by the present value. Notice I put a lot of caveats here. I said you could borrow or lend at the rate r. You could borrow unlimited amounts or lend unlimited amounts at the rate r. Both of these are necessary for this price to work out. What if the lending rate is different from the borrowing rate? Now the present value calculation doesn't work and we have to construct a different arbitrage argument. Here's the arbitrage argument for borrowing and lending rate. So we can lend at the rate RL and borrow at the rate RB and typically the lending rate is going to be less than the borrowing rate. what is the lending rate for a typical investor, it's the amount of money, that the interest rate that you are given for deposits in a bank. And, the borrowing rate is the amount of interest that you have to pay for loans taken from the bank. And, typically, the borrowing rate is going to be larger than, strictly larger than, the lending rate. So, let's construct our portfolio. We had two different portfolios that we had constructed when we did the no arbitrage argument in the previous two slides. One of them gave us a lower bound, and the other one gave us the upper bound. The two bounds were the same and therefore you ended up getting an exact price. So let's construct those portfolios. We buy the contract, and we borrow c k over one plus r b to the power of k, for k years. Now notice, we are borrowing, so the borrowing rate is here. By the same argument that we had in the previous slides, the cash flow in year k is going to to be c k, coming from the contract, minus c k over 1 plus r b to the power of k, times 1 plus r b to the power of k. This is the amount of money that I have to return. On the amount that I borrowed. They cancel exactly. Therefor CK is greater than equal to zero. For all times in the future, in fact it's exactly equal to zero. The new arbitrage condition, the weak new arbitrage condition tells me that the price of this portfolio must be greater than equal to zero. What is the price for this portfolio? It's going to be P, the amount that I paid, for the contract minus C0 minus the summation from K equals 1 through capital N CK over 1 plus RB to the power of K. That must be greater than or equal to zero. This expression here, is exactly the present value for the cash flow evaluated at the borrowing rate RB. This portfolio gives me a lower bound on the price, which says the price must be greater than the present value of the cash flow evaluated at the borrowing rate r B. Now let's flip the portfolio. Sell the contract and lend c k over 1 plus r l to the power k for k years. Notice because I'm lending I'm going to have to use the lending rate here. Rl and which RL is less than typically, strictly less than but it is less than equal to RB. Again, the cash flow associated with this portfolio is going to be exactly equal to zero. In fact, and I'm going to only use the fact that CK is greater then equal to zero. The weak no-arbitrage condition now tells me that the price that I should have paid for this portfolio must be greater than equal to zero. What is the price that I paid? It's going to be minus P plus C, C zero plus K going from 1 through N, CK over 1 plus RL to the power of K. Why is this the price? Because when I sell the contract, I receive, p. When I lend, all of this money goes out of my pocket therefore the net price, for the portfolio is going to be the net outflow, which is exactly the quantity that's written out there. That must be greater than equal to zero, and you end up getting an upper bound for the price, that p must be less than equal to the present value of the cash flow, c, computed using the lending rate rl. This time around, we don't get an exact price for p. We find that the price is upper bounded, by the present value calculated RL. It's lower bounded by the present value calculated at RB and therefore we get a no arbitrage interval. This is an example of an incomplete market, markets where we can not completely hedge away the risk and therefore you don't get an exact price using a no-arbitrage argument. So how is this price P set? It's set, basically, by supply and demand, depending upon whether the buyers or the sellers, who has more of the market power. The price would either go to the lower bound, or it could go to the upper bound. So the supply and demand sets the price. Next we want to expand the ideas going from the cash flows to fixed income instruments. Fixed income instruments are securities that guarantee a fixed cash flow. They guarantee you a dollar amount. But are these instruments risk free? Not at all. There is default risk associated with them, which means that, at some point this entity that is backing these fixed income security might go bankrupt. And, therefore, the cash flow that you were really promised is not going to come through. About the only entity that is there that is risk free is the US government or equally stable governments that are going to guarantee you that the cash flow is going to come. Corporate fixed income securities are always open to default risk. Another risk associated with them is the inflation risk. So even if the entity that gave you the fixed income security does not default, the value of the currency might go down over the years, and as a result the fixed cash flow is now of lower value and this happens because the buying power of the currency comes down over time. In order to. Hedge against this, people have started thinking about tips, which are inflation protected securities. Even if there wasn't very heavy inflation risk in the market, there's also a market risk, meaning these securities might become less or more valuable as time goes by, and if you wanted to sell these securities in the market. The price that you might end up getting is going to fluctuate over time. and as a result you are opening yourself up to market risk. So having said all of that, let's consider some typical fixed income securities, and try to price them using a no-arbitrage condition. So one of them is the perpetuity, which says that it's going to give you a fixed amount a for all times in the future. What is the no arbitrage price for this security? If you assume that you can borrow or lend at the rate r, an unlimited amount, then the no arbitrage price for this security is going to be the sum of k going from 1 to infinity of a divided by 1 plus r to the power k. If you sum this infinite series, you end up getting that the price is nothing but A divided by R. Which is the per period interest rate. Annuity is an instrument, it's a fixed income instrument that pays an amount A for periods K equals one through N. You can write this as a difference between two perpetuities. One perpetuity that starts right now. So it pays from. So here is T equal to zero. You have a perpetuity that pays at an amount A and all these times in the future. And another perpetuity that's time, that's starting at time N plus one. Meaning here is time N. Here is time N plus 1. This is the first time you are going to get a negative amount from this perpetuity so after that, everything will cancel, so all of these will cancel and you end up getting the cash flows associated with that is A. For t equals 1 to up through n. So the difference between these two is exactly the price of the annuity. So therefore the price of the annuity is A over r, this is the price of a perpetuity that starts right now. The price of the perpetuity that starts at time n is going to be A over r, but this is going to be at time t equal to n. You have to discount this back N period, so this is the discount factor. And we discount it back, you get the price for the annuity, and this is going to be A over r, one minus one plus R to the power N. The next fixed income instrument that we are going to be interested in is a bond. A bond is characterized by five different parameters, or. There's a face value. And face value is typically a hundred or a thousand. There's a coupon rate, alpha, which is paid every six months. So every six months a bond pays you alpha times f which is a face value divided by 2. There's the maturity. This is the date of the payment of the face value in the last coupon. There is the price at which is that at which these bonds are going to be selling. In addition to this, there is also a quality rating. S and P rates them as triple A, double A, triple B, double B, triple C, double C, and so on. The quality essentially is trying to get at the default risk. A high quality bond has very low default risk. The chance they could stop paying this coupon, are going to be very low. A lower qualilty bond has a higher default risk, meaning that there's a higher chance that it would not pay the payments. So, here's a story. Every six months, a half, one year, one and a half, two and so on, it pays alpha, which is the coupon rate times F, which is the face value divided by two. And at maturity, capital T, you get the face value back, plus you get alpha F divided by two, which is the last coupon payment. Now, bonds are going to be characterized by at least four numerical quantities. The face value, the coupon rate, the maturity, and the price. And in addition there is this other quantity called quality. And since bonds differ in so many different dimensions, it's hard to compare bonds. So one quantity that has been introduced in order to be able to compare bonds of different maturities, different coupon rates, and face values, is this idea known as the yield to maturity. The yield to maturity is the annual interest rate at which the current price for the bond P is exactly equal to the present value of the coupon payments plus the face value. So you take all the coupons and you discount them at the rate lambda over 2 because that's. The coupons come every 6 months. Lambda is the annual rate of interest and therefore you have it discounted by lambda over 2 and similarly you discount the face value that appears at time capital T which is to say after 2T 6 month periods at the rate lambda would do. What this little maturity does, is that it gives you a single number to start thinking about bonds. It summarizes a face value, coupon, maturity, quality and so on. It's a number that relate, that has understandable movements with respect to quality. Lower quality means lower price, which means higher yield to maturity. Which means, essentially the intuitively to think about about it is that, cash payments in the future are going to be discounted with a higher interest rate. Why with the higher interest rate? Because I'm not certain that those cash payments are going to come, and therefore, I want to discount them very strongly. With lower quality, I am even more uncertain which means that I should have a higher yield to maturity. If the interest rate in the market were to change, then the yield to maturity would change in a similar manner. Yield to maturity, therefore, gives us a way to think about different bonds and compare them. But remember, yield to maturity is a single number. It's a very crude measure. It's trying to summarize four different numbers by a single number, so it's not going to be able to capture everything.

## 003.Basic Fixed Income Instruments

### 004. Floating Rate Bonds and Term Structure of Interest Rates

In this module, we are going to introduce you to the floating rate bonds, how to use the new arbitrage principle, to price floating rate bonds, and also to the term structure of interest rates. In this module, we are going to price a floating rate bond. This is a bond for which the interest rate or the coupon payment rate that you receive is going to be dependent on the prevailing uncertain interest rate in the market. In order to price this instrument correct we have to use this idea called linear pricing. Linear pricing is the result that allows you to combine prices for different cash flows. Here is what this theorem says. Suppose there is no arbitrage in the market and suppose there are two different cash flows CA, which has a price PA and a cash flow CB which has a price BB. Then the arbitrage free price for a cash flow that pays the sum of these two cash flows. So c is a cash flow that pays CA plus CB. The price for such a cash flow must exactly be PA plus PB. The prices add up. And this is exactly what is going to be called a linear pricing result. We like this result, because now what it allows me to do is to take a complicated cash flow, split them up into simpler cash flows. Price each of those simpler cash flows separately. And then using this TRM claim that the price of the total cash flow is just going to be the sum of those prices. I'm going to show you a simple example first and then I'm going to go towards what happens at floating rate bonds. So let P denote the price of the total cash flow C which is CA plus CB. And suppose this price P is actually strictly less then PA plus PB. So cash flow C is cheap, the individual cash flow CA and CB are expensive. We're going to create an arbitrage portfolio, I'm going to create a portfolio that gives you a free lunch. But with no arbitrage, such a portfolio can not exist. And therefore we are going to get some bounds on the prices. So I'm going to purchase the cheap cash flow, C at a price P. And then I'm going to sell the cash flow, CA and CB separately. So I'm going to take a cash flow, split it up into cash flows CA and CB, and individually sell them in the market. What is the price of a such a portfolio? It's going to be P minus PA minus PB, which means it's less than 0, which means that there is a net income at time T equal to 0. The cash flows in the futures exactly cancel out. Therefore, the future cash flows are 0 and have constructed a free lunch. I've constructed for you a portfolio that somebody pays you to hold a time T equal to 0 and you have no obligations in the future. No arbitrage in the market means there is no free lunch and therefore the initial assumption that I had that P is less than equal to PA plus PB is going to be false which means that P must be greater then PA plus PB. We can reverse the argument if P is strictly greater than PA plus PB. What both of these in results together show you is that the price P must be exactly equal to PA plus PB. Note that we have to have a liquid market for buying and selling these cash flows in order to have this no arbitrage result give us a bound of the price. Once we have this no arbitrage result, we are going to see how we can apply that to a very simple example first and then, the floating rate bond next. Suppose that you have a cash flow C which pays C1, C2, C3 up to CT. I want to think of this as a portfolio of capital T different cash flows, so C super T, superscript t pays ct at time t equal, at time t, and 0 everywhere else. So the, total cash flow is now a portfolio, or a collection of cash flows of a simpler kind. So, these cash flows only pay at one time and zero otherwise. So, both the cash flows are annual and the interest, annual interest rate is r. Then, the price of this particular cash flow which is here time t is equal to 0. Here is time t equal to little t. It pays in amount CT here, and it pays 0 everywhere else. The price for this cash flow, which we have already computed before, is given by its net present value, which is going to be CT divided by 1 plus R to the power T. The price of the cash flow C, which is a sum of all these cash flows C super t, is going to be the sum of the prices, just the net present value of all the cash flows from the future. We are going to take this simple idea of taking a cash flow, split, splitting it up into simpler cash flows, pricing the simpler cash flows together, and bringing it back to get the total price for the more complex example of floating-rate bonds. So what are floating-rate bonds? These are bonds that give you, whose coupon rate is equal to the floating interest rates. What are floating interest rates? Floating refers to the fact that interest rates are random quantities, they fluctuate over time. Let RK denote the per period interest rate over the period K to K plus 1. This quantity RK becomes known only at time K. Before time K, this quantity RK is a random quantity. So, if I'm sitting at time t equal to 0, and I have an instrument that depends on this floating rate interest rate RK, I don't exactly know what the payment is going to be. The payment that I receive on that security will become clear only at the beginning of time K. One period loan issued in period K have to be, to be repaid in period K plus 1 are charged this amount RK. The cash flow of a floating rate bond is connected to these floating interest rates. The coupon payment at time K is determined by floating rate at time K minus 1. So it's going to be RK minus 1 times F. Here we are assuming that the coupons are annual coupons. If it's going to be semi-annual coupons, then it's going to be the semi-annual rate rather than the annual rate, RK minus 1. The fees value that you receive at time N is fixed F. Our goal is to compute the arbitrage free price PF for the floating rate bond. So what we are going to do is split up these cash flows into simpler cash flows. I'm going to consider a cash flow that pays RK minus 1 times F at time K. And that's it. It doesn't pay at any other time. I'm going to call that particular cash flow, CK cash flow, and the price of that particular cash flow is going to be denoted by little p sub K. I'm going to have a final cash flow associated with the principal amount at time N, and I'm going to call the price of that particular cash flow as capital P. Capital P is easy to compute, it's just the net present value of the principal capital F paid at time N which is going to be 1 over 1 plus R to the power N times F and just to be clear this R down here is R sub 0 which is the interest rate Right now. Using the linear pricing theorem, we know that the price of floating rate bond, P sub F, is nothing but capital P, which is the price of the principle, plus sum of K going from 1 through N. Little p sub K, which are the prices for the instrument that just pays RK minus 1 at time K. In the rest of the slides, I'm going to try to compute for you what this PK is. Okay. I'm going to do this in two steps. So far, we've only used the no arbitrage argument to price a deterministic cash flow. Here, we are constructing the price of a contract that pays RK minus 1F at time K. RK minus 1 is not known at time T equal to 0. The price has to be computed at T equal to 0. RK minus 1 is a random quantity its exact value or its realization is only known at time K minus 1. So what I'll first do is construction a portfolio whose cash flows are deterministic, all the randomness will be gone. Once I have a deterministic cash flow I know exactly how to price them. I just have to use the net present value. But net present value using R0, which is the interest rate right now. So here's how I construct the portfolio. I buy the contract, and now I enter, I try to look at what is going to happen because of this step. I'm going to have a negative cash flow minus PK at time T equal to 0, because this is the price that I have to pay to buy the contract. At time T equal to K, I receive an amount RK minus 1 times F. Now, this is a random quantity, and I need to somehow remove the randomness from the cash flows. I'm going to borrow an alpha amount. This is unknown right now. Over the period 0 to K minus 1. So, I end up getting alpha inflow at time T equal to 0, and I have to pay out minus alpha 1 plus R0 to the power K minus 1. And notice, the amount that I have to pay out depends on the interest rate at time T equal to 0 because that is where I'm going to borrow. Next, what I'm going to do is I'm going to borrow alpha times 1 plus R0 to the power K minus 1 amount over the period K minus 1 to K. So this is the inflow that happens at time K minus 1. What happens at time K? I have to return an amount that I borrowed. This is just the principle. 1 plus RK minus 1, this is random. The amount of money that I have to return at time K is going to be exactly known only at time K minus 1. At time t equal to 0, where I'm sitting and pricing this instrument, this RK minus 1 is not known. Finally, I'm going to lend alpha for the period 0 through K. I get minus alpha here, and I get alpha times 1 plus R0 to the power K there. Since I'm lending, I have a negative cash flow and a positive cash flow at time capital K. So let, let's now look at what happens to the cash flows at time T equal to K. The net cash flow at that point, CK, is going to be RK minus 1 times F which is the cash flow associated with the contract, minus alpha, plus,1 plus RZ to the power K minus 1 times 1 plus RK minus 1, this is the cash flow associated with borrowing alpha times 1 plus R0 to the power K minus 1, over the period K minus 1 to K. Plus alpha times 1 plus R0 to the power K, which is the cash flow associated with lending alpha amounts from 0 to K. Let's rearrange this and take all the terms that correspond to RK minus 1, and put them all together. You get alpha times 1 plus R0 to power K minus 1 times negative sign, and this is coming from this term over here, and you get F from that term over there. This is random because it's multiplying a random quantity RK minus 1. This quantity here just depends on R0, and therefore it's deterministic, it is known what it's going to be at time T equal to 0. Remember, alpha was unknown. So what I'm going to do is choose my alpha, in such a way, that this particular bracket cancels out. And if you set that equal to 0 you get alpha equal to 1, over 1 plus R0 to the power K minus 1 times F. This makes sure that the random quantity is equal to 0. Now, I want to understand what happens to this cash flow. I have made the cash flow deterministic, and now I am going to use net present value to calculate what happens to the cash flows. So, the cash flows appear only at three times T equal to 0, t equal to K minus 1, T equal to K. What is the cash flow at time equal to 0? This plus alpha and this minus alpha cancel, the cash flow is minus PK, which is basically the price that you pay for the contract. At time T equal to K minus 1, this quantity and that quantity exactly cancel. And what is the net cash flow that I get at time T equal to K? That's going to be alpha R0 times 1 plus R0 to the power K minus 1 which is F times R0. And well how do I end up getting this F times R0? I'm just using the fact that alpha's going to be equal to F divided by 1 plus R0 to the power of K minus 1, it exactly cancels out and you end up getting that CK is nothing but F times R0. What is the price PK now? The price of the portfolio is going to be just CK divided by 1 plus R0 to the power K, which is FR0 divided by 1 plus R0 to the power K. R0 refers to the fact that this is the interest rate at the time T equal to 0. Recall that the price of the floating rate bond PF is going to be the component that comes from the principal payment let's call it P and the sum of all these instruments for K equal to 1 through N. I have just calculated that PK is going to be F times R0 divided by 1 plus R0 to the power of K. I substitute that. I take some terms common. I calculate out the sum of this series going from K equal 1 through N. Cancel out some terms. And lo and behold, the result that you end up getting for the price of a floating rate bond, is exactly equal to the principal or the face value F. The price PF of a floating rate bond is always to its face value. That's great, so, two things I want you to take away from this little calculation. One of them is the fact that the price of a floating rate bond is exactly equal to it's face value. But the second, is how we constructed this price. What we did was, we pushed our idea of no arbitrage one step further. We could, first we used no arbitrage condition to calculate out the price of a deterministic cash flow. Now we pushed a no arbitrage condition to calculate out what happens to the price of a stochastic cash flow, and we did it in two steps. First, we remove the stochasticity, and converted It into a deterministic cash flow, and then we use the no arbitrage condition to calculate the price of this deterministic cash flow. In this slide, we are going to introduce this idea of term structure of interest rates, and it's an idea that will come back again later on in this course. What do I mean by a term structure. What we mean is that the interest rate actually depends on the term or the duration of the loan. So far we've been assuming that today the interest rate that you'll be charged for a loan doesn't depend on whether the loan is for one period, two period, ten period, 100 periods, whatever. But in reality, that is not true. The interest rate depends on the duration. And it's typically greater as the duration increases. Why does this happen? There are many explanations for it. Investors prefer to have their funds liquid, rather than tied up. So if you want to induce them to tie up their funds for a larger period, you have to give them a higher interest rates. There are other explanations such as people have expectations that in the future rates are going to go up or go down and therefore what interest rate they'd be willing to charge for you right now might depend on their direct future expectation. There might, there's also a market segmentation story which says that different people in the market are interested in funds at different terms or at different points in time. And therefore, depending upon how the market segments, the interest rates will be different for different periods and would result in a term structure of interest rates. Let SD define the spot rate. This is the rate available today, for a loan maturing in T years. So an amount A in T years, it's present value is going to be A divided by 1 plus ST, raised to the power of T. Notice here, this S depends on T. So far, when we were doing the net present value calculation. We would have done A divided by 1 plus R to the power T. Regardless of when the time is coming, the interest rate remains the same. But now, you have two things happening. The interest rate changes, and the compounding is always there. So it's going to be 1 plus ST raised to the power T. Sometimes it's more convenient to quote the spot rates in term of the discount rate. The discount rate is nothing but 1 over 1 plus ST to the power T. You can infer spot rates by looking at bond prices. Why? Because bond prices, at least for default, the risk free bonds are going to be simply a linear combination of the coupon payments discounted at the spot rate. And if you know the prices for bonds for different maturities, you could use these prices to compute out what the spot rates are going to be. Another term associated with the term structure of interest rate is something called a forward rate. A forward rate, FUV is the interest rate coded today for lending from year U to year V. We, what, if you know all the spot rates we can compute out what the forwards rates are going to be, and the way to use them is to think about two different ways that you can go from year 0 to year V. One possibility is go, is going to be to lend $1 up to time V. In which case, this $1 lent for V years at time 0 is going to give, going to be worth 1 plus SV to the power V. The other possibility is to lend that dollar for U years and then contract it right away at time T equal to 0 to lend it for another V minus U years. So it's important to remember what we're doing here in the second level option is that we're going to lend the dollar for U years and right at time T equal to 0 I'm going to construct another contract which is going to allow me to lend at whatever amount of money that I have at time U for another V minus U years. So my initial dollar is going to be worth 1 plus SU to the power U. This entire amount is now going to be lent at the forward rate. So if I lend it, I get 1 plus FUV to the power V minus U at time V. No arbitrage condition tells me that whether I go down the blue path or whether I go up the black path, I should end up with the same amount of dollars. Which means that 1 plus SV to the power of E must equal 1 plus SU to the power U times 1 plus FUV to the power of E minus U. Using this expression you can calculate out what FUV is going to be. It's going to be 1 plus SV to the power of E divided by 1 plus SU to the power U. The whole thing raised to the power V minus U minus 1. There is another relationship between spot rates and forward rates. 1 plus ST to the power T is going to be the product of K going from 0 to T minus 1. 1 plus FK, K plus 1. So one periods. And the logic behind that is very simple. You have 0 and V. One possibility is go directly. Not V, but T. And here you get 1 plus ST to the power T, or you could hop one year at a time. Here is F01, F12, FT minus 1T. Again by no arbitrage whether you go down this path or you go down that path you should get the same amount of money which tells me that 1 plus ST to the power T must be equal to the product along the above line which is 1 plus FK, K plus 1 taking the product with K equal to 0 to T minus 1.

### 005. Forward Contracts

In this module, we are going to introduce you to the forward contract and also how to use the no arbitrage principal to price forward contracts. A forward contract gives the buyer the right and also the obligation to purchase a specified amount of an asset. At a specified time capital T, at a specified price capital F, called the forward price, which is set at time T equal to 0. Just to get the mechanics right, here's time T equal to 0. Here's time, the expiration time, capital T. At time T equal to 0, you're specified at price capital F. Which allows you to buy a specified quantity of an asset at that price F, but at time capital T. So you fix the price at time T equal to 0 for a purchase that happens at a later time, capital T. They are many examples of forward contracts. Forward contracts on delivery of a stock with a maturity of six months. Forward contract for sale of gold with a maturity of one year. Forward contract to buy ten million dollars of Euros with a maturity of three months. Forward contract for a delivery of a nine month T bill with a maturity of three months. In all of these cases, you are being quoted a price today to purchase the quantity, which has been specified in the contract at a later time, capital T. For example, in the forward contract for a delivery of a stock with maturity six months, you've been quoted a price today for buying a stock in six months. Our goal in this set of slides is to set the forward price capital F for a forward contract at time T equal to 0 for one unit of an asset with asset price ST at time T and maturity of capital T. Let little fd denote the price or the value at time little t for a long position of forward contract. The value of the forward contract at time capital T is known. F little t at time capital T is going to be the price of the asset at time capital T as sub T. This is the price of the asset minus the forward price. This is the forward price. And why is this exactly the value of the forward contract at time capital T? This is because a long position in the forward, you must purchase the asset at price capital F. You can immediately sell that in the market at a spot price of S capital T, so you make the difference. If the forward price happens to be greater than S capital T, you make a loss. If the forward price happens to be less than S capital T, you make a profit. The forward price capital F is set in such a manner, that at time t equal to 0, the value of the price of the forward contract f sub 0 is exactly equal to 0. F0, this is the price at time t equal to 0, and that must be set equal to 0. Which means that you're indifferent between taking either a long position or buying the contract or taking a short position or selling the contract. The buyers and sellers are indifferent about taking any position. Just to remind you, little f0 is going to relate to the price of the value of the contract. Capital F would relate to the forward price. This is the full price that is set at time t equal to 0. But the purchase is going to happen at time t equal to capital T. We're going to use the no arbitrage principle to set the forward price F. In order to construct this price, I have to get into a concept called short selling. Short selling is the selling of shares in a stock that the seller doesn't own. What happens is that the seller borrows the shares from a broker. The shares come from the brokerage's own inventory. The shares are sold and the proceeds are credited to the seller's account. However, sooner or later, the seller must close the short by buying back the shares. This is also called covering. So you sell the shares in the market by borrowing it from the broker. And then later on, you buy back from the market and give it back to the broker. Why would one be interested in short selling? Because one feels that the price of the asset is going to drop. If the price of the asset drops, then you'd make a profit by short selling. If the price of the asset goes up then a short sale results in a loss. The short positions can be very risky and have to be handled very carefully. The price can only drop to zero, so the potential profit that you can get from a short position is bounded. But the price can increase to arbitrary large values, and therefore the potential loss from a short position is unbounded. So if you're taking short positions, one has to be very careful about how you manage those short positions and the risks associated with those short positions. We are going to use short selling as a technique for pricing formulas. Suppose the asset has no intermediate cash flows. For example, dividends, or storage costs, and so on. Construct the following portfolio. You buy the forward contract, short sell the underlying, and lend S0 up to time capital T. And let's look at one of the cash flows associated with this. If you buy the contract, you can get into the contract by paying nothing because f0 is equal to 0. This is how it's constructed at time capital T. What are the cash flows associated with it? It's equal to the price or the value of the contacted time capital T, which is S capital T minus F. You short sell the asset and buy back at time capital T. What happens when you short sell the asset? You get S0 into your account because you sold it. You immediately, the funds get credited to your account. You buy it back at capital T and therefore you have a cash flow minus S capital T happening at time capital T. Notice as zero is a price today, you know exactly what it's going to be. S capital T is a random quantity. It's some quantity that is going to be there in the future. Why did I construct this particular object in my portfolio? I put that because now this ST and that minus ST cancel each other. Remember what we did for the floating rate bonds. We removed the randomness and that's we are doing here too. We are removing the randomness. You lend S0 up to time capital T, what happens now? Minus S0 is the cash flow at time T equal to 0, S0 divided by d(0, T) is the cash flow at time capital T. This is just a fancy way of writing, S0 times 1 plus r to the power capital T. But because now the interest rate could have a term structure associated with it, instead of writing it as 1 plus r to the capital T, I'm just using the discount. And that allows me to give you a more general result, which doesn't rely on flat interest rates. What is the net cash flow? I paid nothing for this portfolio. What is the cash flow at time capital T? It's S0 divided by d(0, T) minus F. The portfolio has a deterministic cash flow at time capital T and the cost is equal to 0, therefore, discounted, you should get price V equal to 0. So S0 divided by D0 T minus F times D0 T. Discounted back you end up getting equal to 0 and therefore F is nothing but S0 divided by D0 T. Now why is F strictly greater than the stock price? It's because of cost of carry. You are, you're not committing your cash for up to time capital T. The opportunity cost associated with the, that cash is essentially 1 over d(0,T), and that's why the F, which is the forward price, which is the price at which you can purchase an asset sometime in the future, is greater than the spot price. Here's an example. A forward contract on a non-dividend paying stock that matures in six months. The current stock price is $50. The six-month interest rate is 4% per annum. Assuming semi-annual compounding. Why semi-annual? Because the maturity is six months, so I'm taking, sort of, the largest period that is associated with the problem. What is the discount rate? It's going to be 1 plus the annual interest rate divided by 2. The discount rate turns out to be 0.9804 and therefore, F, which is the forward price is going to be the spot price, 50 divided by 0.9804 and turns out to be $51. Now what we want to do is construct the value of the forward at some time T strictly greater than 0. Remember this is the value in the price of a forward contract. We already know that at time T equal to 0, F sub 0 is equal to 0. At time T equal to capital T, F sub t is going to be s capital T minus F. The spot price at the expiration, capital D minus the forward price. Now we want to construct F sub little t, which for time t which is not 0 or capital T. And we could do this using two different forward contracts. So, let f 0 denote the forward price at time 0 for delivery at time capital T. So, here's what is going to happen. Here's my time t. Here's time 0. Here time little t. Here time capital T. So F0 is a forward strike price that is negotiated here for delivery at time capital T. Ft is a forward price negotiation at time little t also for delivery or expiration capital T. Now we are going to again construct a portfolio. We are going to short this contract. I'm going to short the Ft contract. What are the cash flows associated with that? At time t equal to little t, because this contract has been struck at time t equal to little t, I don't have to pay anything to take the short position. At time T equal to capital T, I get F sub little t minus St, notice, this is the worst. Because I take a short position. I long, go long on a contract F0. If I had struck this contract at time 0, I would have paid nothing for it. Because the expiration at time capital T, but the contract was struck at time T equal to 0. However, now I'm buying this contract at time little t. Its value, or its fair price is F sub little t. And therefore, I have to pay that amount in order to get it. So with the cash flow at time little t is going to be minus Ft associated with this contract. The cash flow at time capital T is going to be s capital T minus F0. F0 is the forward price associated with the contract that was written at time 0 for expiration at time capital T. If you take the difference, ST cancels. F little t minus f0 is a deterministic quantity minus Ft is a deterministic quantity, and therefore you end up getting that the price, ft, must be just a discounted value of the cash flow in the future. F capital T minus F0 times the discount rate over the window little t to capital T. Let me review what happened here. We're constructing a portfolio using two different forward contracts. The forward contract that I'm call, calling f sub 0, is a contract that was written at time 0, for delivery at time capital T. If I had gotten into this contract time T equal to 0, I would have not paid anything. However, in my portfolio I'm getting into this contract at time little t. And therefore, I have to pay the value or price of the contract at little t which is F sub little t. I have another forward contract which was constructed at time little t for expiration of capital T. And for this contract, I know that the value is equal to 0 so I can get into this contract or I could sell this contract at price equal to 0. The payoff from this contract is going to be something different. It's going to depend on the forward price constructed at time little t. I take both of these into my portfolio and I do this in order to cancel out the random quantity S capital T. The spot price of the underlying asset on which these forward contracts are written. When you do the net cash flow, you end up getting a deterministic quantity, and I know how to price that. And that's how I end up computing the value of a forward contract at some time T in the future, which is not the time at which it was struck. And it's not the time at which it's expired.

## 004.Swaps and Futures

### 006. Swaps

In this module we're going to introduce you to swap contracts, introduce you to the ideas why these swap contracts are constructed, what is the advantage of swap contracts. And also show you how to price a very simple interest rate swap using a no-arbitrage principle. Swaps are contracts that transform one kind of cash flow into another. A plain vanilla swap transforms a fixed interest rate cash flow into a floating interest rate cash flow. A commodity swap, swaps or exchanges floating price of, for the commodity for a fixed price for the same commodity. Examples include gold swaps, oil swaps, and so on. Currency swaps allows you to swap a cash flow in one currency for a cash flow in another currency. So why do companies construct or entities construct swaps? They do because you want to change the nature of cash flows. The example is fixed interest rate versus floating interest Another possibility is to construct swaps to leverage strengths in different markets. Here's an example. Company A, were it to borrow in the fixed interest rate market would be charged 4% per annum. If it were to borrow in the floating rate market, it would have to pay LIBOR plus 0.3%. LIBOR stands for the London Interbank Offer Rate, and that's the rate which is used as the base for floating, floating interest rates. Company B, were it to borrow in the fixed interest-rate market, would be charged 5.2 percent, and in the floating interest-rate market, it could borrow at LIBOR plus one percent. So company A is clearly superior to company B, both in the fixed interest rate market as well as the floating interest rate market. However, company B is relatively stronger in the floating rate market. The difference between the rate for company A and B is only 0.7% in the floating rate market. Whereas it's one point two percent in the fixed rate market. So these companies, could take advantage of the difference of their relative strengths in the true markets to create an, an instrument which lets them borrow at the better rate than they could have individually borrowed in either of the two markets. Company A, which is stronger in the fixed-rate market, borrows in the fixed-rate market, company B, which is stronger in the floating-rate market, borrows in the floating-rate market, and then they construct a swap in order to make an additional product or a derivative product. Which is going to be better than each of these individual deals that are available to this company. So here's company A, it borrows at 4%, which means that it's going to pay out 4%. Here's company B, which borrows at libor plus 1%. And then we construct a swap, we have company A, B is company B LIBOR and company B pays company A 3.95%. And if you see what the net effect of this swap is to each of these companies. Company A now ends up paying LIBOR plus 0.05%, which is better than what it could have borrowed in the floating rate market, and company B ends up paying 4.95%. Which is better than what it could have gotten in the fixed-rate market. So by constructing this swap, these two companies are able to leverage their relative strength to get a deal which is better than what they could have achieved in, either the fixed-rate market or the floating-rate market. Both of them end up gaining. The details of how to the 3.95% gets set depends on supply and demand. But there is an inplicit assumption that is being made in this particular example, and that's that company A and company B continue to exist. That neither of them is going to default. If one of these companies were to default then this entire superstructure breaks down and company A or company B, depending upon which one has a default, will be exposed to a big risk. So most of the times when swaps are constructed. You don't make a swap with a counterparty directly because you don't want to be exposed to the counterparty default risk. You would rather make it with an intermediary, a financial intermediary, that is able to take on the counterparty risk, and guarantees you, that you will get the swap cash flow that you're expecting to get from the counterparty. So here's how, these swaps get, set up. The same two companies, A and B, and now there's a financial intermediate that contracts the swap. Company A borrows in the fixed market at 4%, swaps with an intermediary and pays LIBOR and receives 3.93%. So, 0.02% less. Company B borrows in the floating rate market at LIBOR plus 1%. Constructors swap with an intermediary, receives LIBOR and pays, 3.97%. So 0.02% more, or this is the same thing as saying two basis points less, two basis points more. The financial intermediary in the middle makes this 0.04%. It receives two basis points from company A, and receives two basis points from company B. Why does it get that? This is the compensation for taking on the counter party risk. If either of these two companies default, the financial intermediary's on the hook, to provide the cash flow necessary for the surviving party. And it also constructs a service in the sense that, typically, in the market, company A and company B don't know that they exist, and their relative strengths are different so, by creating a swap, they would be able to better position themselves. So financial intermediary is able to bring these two parties to the table and construct a swap that is going to mutually beneficial, and ends up getting paid for providing this service. So let's see how an interest rate swap is priced. Let rt denote the floating unknown interest rate of time t. And let's consider a swap whose cash flows at time little t equal to 1 through capital T is given as false. Company A, which takes on the long position in the swap, receives a notional principal n, times the random interest rate prevailing at time t minus 1. So the cash flow that it receives at time t is given by the notional principal n. Times the interest rate at time T minus 1. And it pays the same notion of principal n times a fixed interest rate x. Company B, which nominally takes on a short position on the swap, receives the fixed interest rate payment n times capital X, and pays the floating payment n times rt minus 1. Now what we want to do is compute the value of the swap to company A. So there are two pieces to the cash flow to company A. It receives the cash flow, the principle, n times r 0, r 1, r 2 and so on up to r T minus 1 at times 1, 2, 3, 4 up to capital T minus 1. This is precisely the cash flow associated with the floating weight bond, minus the face value. So in a floating weight bond, at the expiration capital T, in addition to the coupon payment, you have received the notional principle back. This time you do not get the notional principle. And therefore, the value of the swap to company A consists of two elements. This is the value, of the floating rate, payments received, this is the value of fixed rate payments, paid to company B. We know that the value of a floating rate bond is directly equal to the principle. But we don't get the face value back, so I have to subtract from that value n times d, 0, t, which is the discounted value of the principal which was received at time capital T. What happens to the value of the fixed-rate payment? Every period, I get n times x. I have to discount that from time t equal to 1 through capital T. So this is simply the discount values. How is this x set? This is this x set, in a similar manner as we had done for former contracts. We set at, at a value such that the va is exactly equal to 0 at time t equal to 0. If you set it up, p equal to 0 implies that x must be equal to 1 minus d, 0, t divided by the sum of little t going from 1 to capital T to 0 T. This is the interest rate that you would have to set up, so that the value of the swap is exactly equal to company, zero for company A. And it's also equal to zero for company B. So, the two companies going into this swap, are eq, are, indifferent between taking a long position or a short position.

### 007. Futures

>> In this module we're going to introduce you to futures, why futures are needed, how one can hedge using futures, and in later modules we're going to introduce you to the mechanics of the margin account associated with the futures. We call that, we had introduced these contracts called forwards, a couple of modules ago. Forwards are contracts that gave, the buyer, the right and the obligation to purchase a certain amount of an underlying asset at a specified price at a specified time. The problem with these forward contracts were that, they are a multitude of prices here, and as a result of that, they cannot be organized through an exchange. So what do I mean by multitude of prices? So let's say that, there is an expiration time capital T. If you construct, a forward contract at time t equal to 0. Associated with that particular contract would be a forward price F0. If you construct it at some other time t k, t equal k, there would be a different forward price Fk. If you construct something at t equal to u there is be another price, Fu. So all of these contracts are expiring at the same time, capital T. And they have different prices, depending upon when they were construct. So in every other respect, these contracts are similar except for the price. And because of that, it's very difficult to exchi, to set these contracts up, through an exchange. Because they are not set up through an exchange, there is no price transparency. Recall that price transparency is very important, to make sure that supply and demand sets fair prices, or no arbitrage prices. If there is no price transparency, one would not be able to construct arbitrage prices. That is supply and demand would not equilibrate to an arbitrage-free prices. Because there is no, price transparency and these contracts are not organized through an exchange, there is something called double-coincidence-of-wants. When you construct these forward contract, you have to have somebody take the opposite side. In order to find, that counterparty, you have to go look for it. And that might, lead to problems where certain forward contracts cannot get written because their counterparty is not available. There's also default risk of the counterparty. We talked about this in the context of slops. If you take on, a forward contract with a counterparty and the counterparty is not willing, to make the payments when the time comes, or is bankrupt. Then you expose yourself to unnecessary risk. So one needs a contract that works like a forward contract, that's able to fix prices sometime in the future, but is able to solve these other problems associated with a forward contract. That is, it's organized through an exchange. There's price transparency. You can get in and get out of this contract very easily. There is no counterparty with which you are contracting it's, you're contracting through brokers who are organizing in exchange. [SOUND] One such contract, is called the futures contracts. It solves the problem of the multitude of prices for the same maturity by marking to market. It just gives the profits and losses at the end of the day. So, price, there's a single price for, a single maturity. There aren't any more prices, based on when the contract was set. The contracts, because of the fact that these multitude of prices don't exist, they can be organized through an exchange. They can be written on any underlying security which has a settlement price. You can write it on commodities, you can write it on broad-based indices, such as, the S & P 500, the Russel 2000, etc. You can even write it for the volatility of the market, for example, VIX futures. There are a whole number of different assets that are available, and I would encourage you to go to this website at the cmegroup to look at the various kinds of, commodities, indices, and other measurable quantities on which future contracts are written. So here are, how a future contract work. An individual opens a margin account with a broker. It enters into, a certain number of futures contracts with a certain price of 0. So this is the futures prize that is available at time t equals zero. And in order to enter into these futures contracts you have to set up. An initial margin, that depends on, [SOUND] whether you're a hedger, or a speculator, and so on. And it typically is around 5 to 10% of the total contract value. All the profits and losses are settled using a margin account. If there are profits, which means that the futures price goes up, and you are having a long position, then the profit that you make is credited to your margin account. If the price goes down, then the losses are also settle through the margin account. If the margin becomes below, the maintenance margin, than there's a margin call, that is a broker asks you to put more money in. And you have to make it back up to the initial margin. I've given a snapshot of a particular worksheet of a workbook that I'm going to be working through, in a later module, that gives you, how this margin account works, and how the mechanics of the futures work out. In this particular module we'll be looking at some of the more theoretical results associated with futures. In the later module on excel, I'll walk you through how, how the mechanics workout. [SOUND] So what are some pros and cons of futures? Well, the pros are, you can have high leverage. You only put 5 to 10% of the total notional amount of the contract in the margin account. As a result, you can control very large sums of money, by putting a very small amount of money upfront, so you can get yourself very high profit. Futures accounts are very liquid, so you can take exposure to very different, many different kinds of assets very easily. It can be written on a wide variety of underlying assets, so if you want to hedge or speculate, you can speculate on a very wide range of assets. The cons are, quite related to the pros. The high leverages means, that you expose yourself to high risk as well. Futures prices are approximately linear function of the underlying, so only linear payoffs can be hedged. So if you have cash flow that is normally linear function new of some underlying, asset price or some underlying market indicator. Then you cannot hedge them using future prices, because future prices are linear functions of the underlying. Futures may not be completely flexible. Futures are organized through [SOUND] exchanges, which means that they mature at a specified date, they're written for a specified quantity, they're only written for certain commodities, and so on. And so, if you want to hedge something which doesn't quite, fit. The specifications of futures contracts, you might have to construct a one-off forward contract. You might have to go back to the broker, and construct a one-off forward contract. Or take on something called basis risk, which is going to come later on in this module. What about pricing futures? So in order to price futures, we need something called a Martingale Pricing Formalism. And this, comes because in its full generality, the interest rates are random or stochastic, and when you have stochastic interest rates, we cannot use the simple Arbitrage arguments that we have constructed so far, to construct a price for a future. If on the other hand, the interest rates are deterministic, and we know that forward price is equal to the futures price. We know how to construct the forward price using our Arbitrage arguments. And therefore, we know how to price the futures price. One thing that we do know, is that at maturity, the futures price f capital T is equal to the price of the underlying S capital T. And that's, this is what we are going to be using in the next few slides, to make some hedging arguments. [SOUND] So hedging using futures, so long hedge. [SOUND] Suppose today is September 1st, and a baker need 500 bushels of wheat on December 1st. So the baker faces the risk of an uncertain price on December 1st. This baker can use, a futures contract to fix the price that he could be exposed to, on December 1st. Here's the hedging strategy. You buy 100 futures contracts maturing on December 1st, each for 5,000 bushels. So you now have, taken on futures contracts that are for 500,000 bushels. What happens to the cash flow on December 1st? The futures position at maturity is going to be F capital T. Whatever is the futures price at time capital T minus F0. Whatever is the current price for the futures contract. I know that at time capital T, F of T is equal to S of T. Therefore, the futures position at maturity is going to be S capital T minus F0. If you were to buy the bushels of wheat, in the spot market, you have to pay S capital T. So the effective cash flow that you get, that is you buy in the spot market, and you take the profits that you get from the futures position. The effect of cash flow that the baker gets is ST. Which is coming, which is the payment. [SOUND] This piece of the payment is coming from the futures position. [SOUND] And this is, [SOUND] the payment that the baker has to make at the spot market. So S of T cancels, and effectively, [SOUND] the price [SOUND] of the beaker is fixed at F0. Did this cost anything? If you look at the, initial position and the final position, it would appear as if nothing happened. You could get into the futures contract with putting any money upfront. You end up getting the difference between the, the spot price at the future time minus the current price, as the profit from the future's position, if you combine that by the cost in the spot market. It appears that by not putting up any money you were able to fix the price of wheat to be F0. Which is the current futures price. But in reality in order for all of this to workout, you had to put money into a margin account. And you have to keep adding money to the margin account in case there are margin costs. If at any point during the time from 0 to capital T, from September 1st to December 1st, there is a margin call and you're not able to provide the money necessary to keep your position going. The broker is going to cancel your position and all the benefits that you were thinking about getting from the future position are no longer available. So even though it's not transparent, one has to keep in mind that there are costs associated with making sure that there is enough cash there to put up the margin calls when necessary. In the previous example, we had a perfect hedge. We assume that the futures contract matures right at the time that we want the money, but perfect hedges are not always possible. The date capital T at which we have a cash flow may not be a futures expiration date. The cash flows associated with whatever the quantity that we are trying to hedge may not correspond to an integer number of futures contracts. It was very lucky that we were buying 500,000 bushels of wheat because the futures contracts were written on 5,000 bushels of wheat. A futures contract on the underlying may not be available. If I want to hedge kidney beans. I don't have a futures contract on it. The futures contract might not be liquid. I may not be able to get enough quantity of the futures contract that I need. The payoff P of T may be nonlinear in the underlying. And then, the futures contract, which only gives me a linear payoff, will not be sufficient to hedge. The difference between the spot price for the underlying, and the futures price is called the basis. Futures price here refers to whatever futures contracts that we are buying in order to hedge the underlying asset, whose stock price is stochastic or random. When there is a perfect hedge, then the basis is equal to 0. When there is no perfect hedge because one of the reasons listed above, the bases are not equal to 0 at time capital T. The spot price of the underline is not equal to the futures price of the contract that they are using to hedge the underline. This is what is called basis risk. A basis risk as arises because the futures contract is in a related, but different, asset, or expires at a different time. Here's an example, today is September 1st, and a taco company needs 500,000 bushels of kidney beans on December 1st. The story's the same except now instead of wheat this particular company needs to hedge the price of kidney beans. Taco company faces the risk of an uncertain price of kidney beans. The problem is, that there are no kidney beans futures available. So we have to hedge, this particular uncertainty using a futures contract written on some other underlying. And therefore, have to take on basis risk. So, I'm going to buy soybean futures to hedge kidney beans. And the reason I'm going to do this is because I think that the price of kidney beans is correlated with soybeans. And, as a result, because soybean futures price is going to be correlated with soybean spot price, perhaps, I can use soybeans to hedge kidney beans. I'm going to buy, an amount y of the soybean futures. Each of these futures contracts are for 5000 bushels of soybeans. So what are going to be my cash flows? The cash flow associated with the futures position at maturity is going to be F of capital T minus F0 times y. And then, I'm going to buy kidney beans in the spot market, so it's going to be some cash that I have to pay for that, which is P capital T. So the effective cash flow is going to be y of FT minus F0, plus PT, which is the cash flow associated with buying kidney beans in the spot market. PT is not equal to y times FT for any y, and therefore, a perfect hedge is impossible. So what happens? What can we do? So instead of trying to get a perfect hedge where, the effective cash flow is exactly equal to zero, I'm going to try and minimize the variance of the cash flow. Variance of CT, can be written as variance of PT plus the variance of y times Ft minus F0, plus two times the corea, correlation between Y, FT minus F0, and PT. [SOUND] Now F0 is a constant. [SOUND] Because a time, T equal to 0, this is known. So this expression can be written as the variance of PT which is the same term as before. Now I'm ignoring the constant. So I write this as variance of y times FT. I take the y outside, and whenever I pull a constant out of the variance, I get the square of the constant. So it become y squared times the variance of FT. I can ignore the constant here, when I'm calculating the covariance. I'm going to take the y outside. But when I take a y outside of the covariance, just the y comes out. So it's going to be 2 times y plus the covariance of FT and PT. I'm going to take the derivative, of this expression with respect to y. So y is unknown. I don't know how many of these contracts I want to buy. So I take the derivative with respect to y. You end up getting, the expression to be 2 times y variance of FT plus 2 times the corea, covariance of FT and PT must be equal to zero. This is, this is the amount of y that is going to give me the minimum variance hedge. And therefore, the optimal number of futures contract is simply given by the solution of that equation, which is minus the covariance of FTPT divided by the variance of FT. This tells me exactly, how many covar, contracts am I going to buy, in order to hedge the

### 008. Futures Excel

In this module, we're going to introduce you to the mechanics of the margin account associated with futures contracts using an Excel spreadsheet. We're going to use both historical data and simulated data to show you all the various situations that can occur in the margin account. In this module, we're going to walk you through the mechanics of corn futures. I'm going to show you two different worksheets. In the first worksheet, I'm going to show you the mechanics using historical data. In the second worksheet, I'm going to show the same mechanics using simulated data. And, the reason I'm looking at two different worksheet, because it turns out for the historical data that I used, there's no margin call. And it's important for me to show you how the margin calls work. So, you want to consider a situation where an investor is buying one for, future's contract for 5,000 bushels of corn. So, the contract value is 5,000 bushels. The initial margin that this investor is asked to put into the margin account is 1,688, so $1,688. The maintenance margin is going to be 1,250, which is $1,250. And these numbers are going to be scaled by the number of contracts that the investor wants to hold. So, for one contract, it's 1,688 as the initial martin and 1,250 is the maintenance margin. And these numbers are taken from the website coded over here. So, on, this investor has bought the future's contract with an expiration of March 15th. That's the date over here. And he purchases this contract at February 22nd. On that date, the price of the futures contract was 690.25, so $0.690.25 per bushel. On that day, he put in $1,688 into the margin account. On the next trading date, which was found to be February 25th, the future's prize goes up to $693.50. The investor is holding a long position, so makes a profit of $163. And how did that come out? It's going to be, the dollar amounts converted, the cents converted into dollars. So, that's a divide by 100. The number of positions that I hold, 1 times what is the contract value, which is 5,000 bushels, times the difference between the price on February 25th minus the price on February 22nd. It turns out to be $130, $163. That amount gets credited into the margin account. So, instead of $1,688 in the margin account, now it's got $1,851. On the next day, it jumps up to $705. He makes $575 profit, which also gets credited into the margin account, and so on. Another profit, another profit, another profit and now a loss. That loss gets debited from the account, so it, he has $3,388 here. It gets reduced to $3,326. Now, even though there is a loss, the broker does not ask the investor put in more money into the margin account. And, the broker will not ask this person to put in more money until the value drops below the maintenance margin of 1,250. Makes a profit of 450. And now makes a serious loss of $1,200. But still, the margin account is above the 1,250 minimum margin. And therefore, there is no margin call. And so on, it keeps going. And on March 15, it expires. It's cancelled. And the net amount of money that this investor made on this particular investment was $2,013. So, 3,701 minus 1,688 is the profit, $2,013. You made $2,013 profit on just $1,688 worth of investment. It's a huge profit and this is what we were talking about before that by taking leverage, you can make a huge profit. Here, we're talking about what would happen if there's a forward contract instead of a futures contract. The cut in price is corn price, not the futures price, was 690 on February 22nd. So, the forward price is going to be 690 times the interest divided by 100 and I took the interest rate to be 20.25%. Times the difference in the date divided by 250 in order to convert it into an annual number. So the, so the forward price turns out to be $690.36. The spot price on termination turns out to be $730, the difference is what you'll end up getting as a profit. So, it's the number of contracts times the difference in the price divided by 100 times. D27, which is the number of contacts that you had. And that turns out to be the profit that you are going to make. In this worksheet, I am showing you a simulation of the mechanics of the corn futures. And this particular simulated worksheet was created just to show you what happens with margin calls. In order to construct the prices for corn, what I did was I assumed that the price of corn does a random walk. So it takes the mean value as the previous day's price, plus the volatility times a normal random variable. The volatility which is given in cell H4 was computed using the volatility of the historical prices that I'm showing in the previous worksheet. So I use that volatility, I computed a simulation for those of you who want to do this simulation again, you can just use F9 to create another simulation. So, here's, I'm generating several different simulation. In some cases, you have margin calls. In some cases, you don't, and so on. So, let's consider a particular one which has a nice margin call over here, for example. So, what happens in this particular case? It starts off with 690.25 with a margin account. Makes a profit. The margin account increases. It makes a loss, the marginal account decreases. But still, it's above the 1,250 minimum margin that, or the maintenance margin that is required. Next day, it makes a loss further. And now, it drops below the maintenance margin of 1,250. So, there's a margin call. And the investor is asked to make the margin account back to the initial margin. And, the amount of money that they are to put in is $633. It makes a loss. But now, the amount is still above the 1,250. It's 1,258, so there is no margin call. Then imakes a huge profit. And the margin account goes up. Several losses. And in the very end, there's a huge loss. It drops below and it has to make up back again, so you get $503 as the loss. And in this particular simulation run, the total profit and loss turns out to be minus $1,000. So, you put in a margin account of 1,688 plus 633. Another margin call plus 503, this was a total investment that you put into the margin account. And, the net loss that you get was minus 1,000. So, in this particular case, you did not make a profit but you made a loss.

## 005.Options and Options Pricing

### 009. Options

In this module, we are going to introduce you to options, and also introduce you to the idea of how simple no-arbitrage conditions can be used to provide some bounds on option prices, and using these bounds we'll show you that it's never optimal to execute an American-type call option before expiration. In this module, we're going to be talking about derivative securities called Options. They come in two varieties, a European option and an American option. If an Option is written to buy the underlying asset, it's called a call option. If the option is written to sell the underlying asset, it's called a put option. A European call option gives the buyer the right, but not the obligation to purchase one unit of the underlying asset at a specified price K, called the strike price at a specified time, D called expiration. An American type call option gives the right, but not the obligation to purchase one unit of the underlying at a specified price K, called the strike price, at any time until a specified time T, called expiration. The difference between a European Option and an American Option is that a European Option is written at time t equal to 0, let's say, and it can only be exercised at time T. So here is where you can exercise a European Option. An American Option can be exercised at any time here [NOISE]. And any time between time 0 to time T. A European put option gives the buyer the right but not the obligation to sell one unit of the underlined at a specified price K called the strike price, at a specified time T, called expiration. An American put option gives the buyer the right, but not the obligation to sell one unit of the underlying at a specified price K, called the strike price, at any time until a specified time T, called the expiration. Again, the difference between the European Put and American Put is the same as the difference between a European Call and an American Call. A Call gives the buyer the right at, but not the obligation to buy. A Put gives the buyer the right, but not the obligation to sell. So let's work through the payoff and the intrinsic value of a call option. The payoff of a European call option at expiration T depends on the spot price of the underlying at time T. If the spot price, S capital T, is less than K, you don't exercise the Option, because it's just cheaper for you to buy in the spot market. And the payoff from the Option is going to be 0, you're not obligated to buy, if you do not buy. If the price at time capital DST is strictly greater than K then you exercise the Option, and the option allows you to buy the underlying asset at price K which is cheap, and you immediately sell that in the spot market to get S T. So the the payoff is going to be S T minus K. Putting both of these cases together, the payoff from a European call option, at expiration T is going to be the maximum of the spite, spot price minus K and 0. It's important to note, but the payoff is non-linear in the spot price ST. This is the first time we have seen an instrument whose payoff is non-linear in the underlying asset and this is going to be important when we talk about hedging. The intrinsic value of a call option at some time little t, less than expiration D, is simply defined as the maximum of the spot price St minus k and zero. We say that the call option is in the money, if the spot price is greater than the exercise price K, it's at the money if the spot price is equal to K, and it's out of the money if the spot price is less than K. All of this works the other way for put options. So for a put option, you exercise when the price ST is less than K, because it allows you to sell at a higher price. And the payoff that you get is the difference between the exercise price K and ST. If the price and the spot market is greater than K, then you don't exercise the Option. It's better for you to just sell in the spot market and the payoff that you get is 0. The payoff from the put option therefore is the maximum of K minus ST and 0. Again, it's non-linear, and than the price ST. But it's a different non-linear function than that associated with the call option. The intrinsic value of a put option at some point t less than or equal to the expiration time is defined as maximum of K minus St, the exercise price minus the spot price and 0. It's in the money if the stock price is lower than the exercised price. It's at the money if the spot price is equal to the exercised price and its out of the money if the spot price is greater than the exercise price. So now, we want to see what can we do about pricing options. The payoff from the Options are nonlinear, and therefore we cannot price it without using some model for the underlying asset, and this model is going to come later on in this course. The model that we're going to first introduce is going to be the binomial model, which then we'll take it as a limit and go to a geometric Brownian motion model. In this particular module, we just want to see how much mileage can we get out of simple no arbitrage arguments. So let's put in some notation. A European put option with strike price K and expiration T, the price of such an option we'll call as pE, t K T. So, pE stands for a European put. Time is time. This is the strike price [NOISE] and that is the exercise time. [NOISE] cE t, K, T would stand for the price of a European call option, with strike K and expiration T. Now, when it becomes American style, we put a subscript A. So the price of an American put option with strike K and expiration T will be called p sub A. The price of an American call with strike K and expiration T would be called c sub A. Using the no-arbitrage argument, we can construct something called a put call parity. And here is the expression. It says that the price, of a, put option and the price of a European call option on a non-dividend paying stock are related using this expression. PE plus the stock price, the spot price of the asset, must equal cE plus K times the discount from time t to T. This is an expression I don't want you to pay too much attention to it. I will show you how this expression is constructed. But in a couple of slides, we are going to use this put-call parity, put-call parity stands for the fact that the put price and the call price for a European option have to be related to each other. We're going to use this put-call parity to show one important result, which has to do with American-style put options. Okay. So construct the following trading strategy. At time t, buy a European call with strike K and expiration T. Sell a European put with strike K and expiration T, short sell one unit of the underline, and buy it back at time T. Lend K times d t, T dollars up to time T. What happens to the cash flow at time T? Because I have bought a European call, I get its cash flow, which is going to be the maximum of ST minus K and 0. Because I have sold a European put, I have to pay out its cash flow, which is going to be maximum K minus ST and 0, but the negative sign in front says that I am responsible for paying, because I have sold it. I have to buy back the asset at time T, therefore minus ST is a cash flow associated with that. Whatever I had lent comes back to me. So ed, end up getting K dollars. And if you work out these different cases you will see that the cash flow at the time T is exactly equal to 0. The no-arbitrage argument tells me then the price that I paid for this particular deterministic cash flow should be exactly 0 at time little T. The cash that I get, the price that I paid for this particular portfolio at time t is going to be minus cE t, plus pE. The, this is the cash flow associated with buying the European call. This is the cash flow associated with selling the European put. This is the cash flow associated with short selling the asset. And this is the cash flow associated with lending money up to time T. The negative of this cash flow is the price. That should be equal to 0, which is equal and is saying that the cash flow at time t must also be equal to 0. If you rearrange these terms, you end up getting the put-call parity. So what we are going to do in this particular slide is connect, prices of European and American style options using put-call parity. The first thing we know is, the price of an American option has to be greater than equal to the price of a European option. Why does that happen? The American option gives me more choices on when to exercise, and therefore, I should be paying more for this freedom. So cA is going to be greater than or equal to cE. PA is going to be greater than or equal to pE. We can construct some lower bounds on European options using the put-call parity. So cE is going to be greater than equal to 0. Why? Because, you have the option of doing nothing. And therefore, the cost of such an option must be greater than or equal to 0. Using put-call parity, we end up getting that cE is equal ST plus pE minus Key a times D t, capital T. So, putting that together. Taking the maximum of that quantity and 0 gives me that cE must be equal to this quantity. Now, pE is a quantity greater than equal to 0. So if I drop that out, I end up getting that this is greater than equal to the maximum of ST minus K times the discount from t to T and 0. For the European put you end up getting the same story. You get one term from the put call parity, you get another term from the fact that the price of the European put is greater than equal to 0. Take the maximum [UNKNOWN] quantities and pE is equal to that. CE is greater than equal to 0. So if I drop that, I end up getting that pE which is the price of a European put has to be greater than equal to the maximum, of K times the discount minus ST and 0. You can get upper bounds of the European options using the stock price, since the maximum of ST minus K and 0 is less than or equal to ST, it means that the call price has to be less than the spot price of the underline. Since the payoff from the European put is less than or equal to K, it immediately implies that the price of the European put has to be less than or equal to K discounted backwards up to time t. If you have dividends and the put-call parity changes a little bit, it becomes pE plus St minus D, which is the present value of all dividends up to maturity, must equal cE plus K times the discount from t to T. These bounds by itself are not going to be very interesting. the only idea that I want you to take away from this slide is that using very simple ideas of freedom associated with American options versus European options, the put-call parity and very simple bounds on the fact that the cost of a call option or a put option has to be great, has to be, greater than equal to 0, the fact that, if I want to buy a stock, I could either get the option or buy the stock alright, outright and, therefore the price of the option must be less than equal to ST, and so on, gives me some nice bounds. In the next slide, I'm going to show you that these bounds can be used to compute an optimal strategy of execution for a American type call option, which gives you a very interesting result. So let's construct the bound on the price of an American type option, using the strab, stock price ST. Now I know that the price of an American call is greater than equal to the price of a European call, which using the bounds in the previous slide we know that its greater than equal to ST minus K, D t, T the discount N 0. Now, this discount d t, T is less than equal to 1. Therefore, if I replace that by 1, I get something smaller. So you end up getting that this quantity, is actually strictly greater than that quantity. But the last quantity there is the intrinsic value of an American call. This is equal to the intrinsic value [NOISE]. So this sequence of inequalities what it does mean, is that the price of an American call is strictly greater than its intrinsic value. It's strictly greater than whatever value that you could get, but exercising the American call immediately. And what that tells me is that it's never optimal to exercise the American call on a non-dividend paying stock early, which means that the price of an American call is exactly equal to the price of a European call. In order to construct this argument we did not need any model for the underline stock price process. Just by using put-call parity which came out of constructing a no other arbitrage argument, we were about to show you that an American call option is the same as a European call option. The prices are exactly the same. What is important though, is that the underlying asset is non-dividend paying. Let's try to do the same thing for the price of an American put. PA is greater than equal to pE, which is greater than equal to K times the discount from t to T minus S T and] 0. But the exercise value of an American put option is the maximum of K minus ST. These 2 are not related in the right direction, therefore these bonds, bounds don't tell us much about what is going to happen to an America put option. Using these bounds we cannot tell whether its optimal to exercise the put early or not. It turns out that if you use some model for the underlying stock price, there are situations in which it's optimal for you to exercise a put option earlier. In this last slide, I'm showing you what happens to the price of the put option as a function of the intrinsic value and the underline. So on the x axis is the price of the underlying. On the y axis I'm putting the price of the put option. The blue line here is the intrinsic value [NOISE]. So what this graph shows you, is at a price let's say a 120, the intrinsic value is 0, but the price of the put option is higher, which means it's clearly not optimal for you to exercise. Even at price 80, the intrinsic value is below the price or the value of the put option, which means again, it's not optimal for you to exercise. At the price 40, the intrinsic value is equal to the price or the value of the option which means that it's optimal for you to exercise. So the optimal exercise boundary is somewhere here. For all prices below here, optimal to exercise [NOISE]. For all prices larger than that, it's optimal to hold. [BLANK_AUDIO]

### 010. Options Pricing

In this part of the course, we're going to see how to price options in the binomial model. Before getting into the details of pricing options, however, I want to have an introductory module where we will raise some of the questions that we're going to consider. In the next series of modules, we'll actually study the 1-period binomial model. We'll follow that with the multi-period binomial model. We'll also discuss replicating strategies. In fact, that's how we're going to price options within the binomial model. We'll construct a replicating strategy that replicates the payoff of an option. And we'll use no-arbitrage pricing then to compute the fair value of the option. After that we'll discuss European and American options in the context of the, of the binomial model. We'll also discuss the Black-Scholes formula, and mention how it can be obtained by a convergence argument using the binomial model. Okay, but first of all in this module, I want to do an overview of some of the questions that we'll be considering. So here's an example of a binomial model, we're going to be working with the binomial quite a lot in this unit, and in the unit we cover next week. We're going to assume that the stock price starts off at the s of 0 equal to $100. And then in each period the stock price either goes up, so in this example it goes up to 107, or it goes down, it falls down to 93.46. And a factor, in fact in any period what happens is that the stock price either goes up by a factor of u, or it falls by a factor of d. And in fact we're going to be using the fact that d equals 1 over u in these, in these modules. And what this means, however, is that an up move followed by a down move, so this would be the security price at time 1. What it means, though, is that an up move, followed by a down move, gives you a price of ST plus 2 equals ST times u times d. But that, of course, is equal to ST times d times u, which is a down move followed by an up move. In other words, the stock price at time T plus 2 is the same if it had an up move followed by a down move, as if had a down move followed by an up move. Okay, and so it's recombining, an up move followed by a down move gives you the same price as a down move followed by an up move. And that's why we often call this a recombining tree, or lattice. Okay, so this is the binomial for the stock price, and in any period it goes up or it goes down, we've got a three period model here. So if the stock price goes up in every period, it ends up with a value of 122.5. If it goes down in every period, it ends up at a value of 81.63. We haven't discussed the probabilities of these moves. For now we'll assume that the probability of an up move is p in any one period. And so the probability of a down move is 1 minus p. And that these probabilities are the same at every node in the tree. So for example, down here the probability of going up to 100 is p. And the probability of going down to 87.34 is 1 minus p. Okay, and of course, we'd be assuming that 0 is less than p is less than 1. Okay, so that's the stock price, that's the security price, the risky security price. We're going to be figuring out how to price options on this stock. We also have another security in our model that's going to be called the risk free asset, or the cash account. Okay, we will assume that's available. And we'll assume the following. That $1 invested in the cash account at t equal 0 will be worth r to the power of t dollars at time t. So in other words, we're assuming a growth risk free rate of r per period, okay. And it's risk free because after t periods, we know exactly how much we'll have. We'll have r to the t dollars if we invested $1 in the cash account at T equals 0. So this is our binomial model. We've got the, the stock price, which is described by these dynamics here, a three period model of the stock price, and we also have our cash account over here. So now, we have some questions. One question that we'd like to answer is, how much is an option that pays the maximum of zero, and s3 minus 100 at t equals 3, worth? Well, let's go back and take a look. So, what is the maximum? So we have a maximum of 0 and S3 minus 100. Okay, so on each of these nodes, the maximum 0 and S3 minus 100, well that would be 0 there, it will be 0 here, it will be 7 here and it will be 22.5 here. So this our option payoff. And what we want to know is how much is this security worth? So the security is the security that pays 0 at this point. 0 at this point, 7 at this point, and 22.5 at this point. Okay, now, do we have enough information to answer this question? That's not clear. Another question is, should the price of the option depend on the utility functions of the buyer and seller? I'll discuss what, what I mean by utility function in a moment. But loosely speaking, I'm referring to how much value a buyer and seller might get from that security. Will the price depend on the true probability p of an up move on each period? Perhaps the price should be equal to this quantity here. So if you look at this, this is just the expected value of the option. So we're taking expectation of maximum 0, S3 minus 100. So that's the expected value. And this guy here is just the discount factor. So in fact this total quantity here could be called the actuarial fair value. Actuarial discounted fair value of the option. But is this how much the option should actually trade for in practice? I don't know, or at least, we don't know yet. We'll answer that question pretty soon. So here's another question, suppose you stand to lose a lot at date t equals 3, if the stock is worth 81.63. In other words, if you find yourself down here at date t equals 3, you're going to lose a lot of money. Similarly, maybe you start to earn a lot at date t equals 3 if the stock is worth 122.49. In other words if you're up here. So I've rounded the 0.49 to one decimal place, but if we're up here, we stand to make a lot of money, and if we're down here, we stand to lose a lot of money. So suppose you're in that situation, the question is, could you do something to eliminate this risk exposure? Is there some way to mitigate your risk, maybe even eliminate it? And we'll actually see that the answering this question is effectively the same as answering this question. And we'll be coming to that in later modules as well. Okay, so, just to address this particular question here where we say, should the price be equal to this amount? Let me give you some evidence for saying why the answer is no. The option price should not be equal to this quantity. All right, to do that we're going to come to a very famous example called the St. Petersburg Paradox, and the St. Petersburg Paradox considers the following game. A fair coin is tossed repeatedly until the first head appears. If the first head appears on the nth toss, then you receive 2 to the power of n dollars. The question is, how much would you be willing to pay in order to play this game? Now, you might want to pause the video at this moment and think about this for a couple of seconds and ask yourself, how much would you be willing to pay to play this game, if a friend came up to you and gave you this opportunity? Okay, I'm not sure how much I would be willing to pay to play this game, but it certainly wouldn't be very much. And yet, look at the following calculations. Let's compute the expected payoff of this game. So the expected payoff is the sum of the possible payoffs times the probability of those payoffs. So the probability of receiving a head on the nth toss, well, to get your first head rather on the nth toss, that means you must get n minus 1, tails, and then you get one head. And the probability of this event occurring is, well you, you get a tail with probability half, so you must get n minus 1 of them. So that's 1 over 2 to the n minus 1. And then you get your head with probability a half as well. And that's equal to 1 over 2 to the n. So the probability of getting your first head on the nth toss is equal to 1 over 2 to the n, which is that. Now remember, you get a payoff of 2 to the n dollars on the nth toss if that's where the first head appears. So your payoff at that point is 2 to the power of n. Well of course, the 2 to the n counts is with the 2 to the n here, and you're left computing a sum. I equals or n equals 1 to infinity of 1, and of course that's an infinite number. Okay, so we, we have calculated that the expected payoff of this game is infinity, but pretty clearly nobody would be willing to pay an infinite amount of money to play this game. Even assuming they had an infinite amount of money to begin with. So how much would you be willing to, to pay to play this game? Just to give you an idea, let me ask you this, would you pay $1,000 to play this game? In order to break even, or at least to show a profit, you would have to get, let's see. So, 2 to the power of 10 is equal to 1024, if I am correct. So, this means that in order to break even or to show a profit, if you paid $1,000 to play this game, you would have to get nine tails on your first nine tosses, and only after that point would you actually be assured of showing a profit. So I personally don't think I'd be willing to play, to pay $1,000 to play this game. I don't even pay, actually, a much smaller amount to play this game. So the point of this is to, is to, is to emphasize that the fair value of a security should not necessarily be its expected payoff. And in fact, Daniel Bernoulli, a famous mathematician, resolved this paradox by introducing a so-called utility function. The utility function has the following properties. It measures how much utility or benefit you're paying from x units of wealth. So u of x measures how much utility or benefit you obtain from x units of wealth. Different people of course, have different utility functions. The utility function should be increasing and concave. It should be increasing to reflect the fact that people prefer more money to less money. And concavity is there to model the fact that getting an extra dollar when your wealth is say, $1,000, gives you less additional benefit than getting $1 when your wealth is $0. In other words, going from $0 to $1 has more benefit than going from $1,000 to $1,001. And this idea is captured by using a concave utility function. So, Bernoulli suggested using log utility function, the log function is increasing and it's concave. So, this is an example of a concave function. It's like an inverted saucer. Look, it's increasing and it's concave. So the log utility function is what Bernoulli suggested. And if we did that with the St. Petersburg game, we find the following. The expected utility of the payoff is now the sum of the utility of the payoff. So it's now log of 2 to the n if the first heads occurs on the nth toss, times the probability of the first head occurring on the nth toss, which is 1 over 2 to the power of n. And if you recall, the log of 2 to the n, this is a property of logs, equals n times the log of 2, well, we get this quantity over here. And it's quite straightforward to show that this is, in fact, a finite number. So this is how Bernoulli resolved the St. Petersburg Paradox. He said that people don't compute values of gains by computing their fair value or their expected value, but instead everyone has a utility function and what they would compute is the expected utility of the payoff. And from there you can determine how much an individual would be willing to pay to play the game. Okay. So given this, you might think that all you need to do is to figure out the appropriate utility function of an individual and use it to compute the option price. Well, maybe, but whose utility function? The buyer's utility function, the seller's utility function, or maybe some other utility function in the, in the marketplace? We're going to come back to that question later. We'll talk about it very briefly later, but in fact, we're going to actually price the options using a much simpler method, which won't use utility functions at all.

## 006.The 1-Period Binomial Model

### 011. The 1-Period Binomial Model

We're not going to discuss option pricing in the 1-period binomial model. We'll see that option pricing in this model amounts to no more then of solving a series of two linear equations and two unknowns. The great advantage of working with the 1-period binomial model is that we will see it easily extends to pricing options in the multiperiod binomial model. So this is the one period binomial model, we are assuming that the stock price starts off at S0 equals $100. The stock price at time, t equals 1, will either have grown to uS 0, which is $107 in this case, so here I am assuming u equals 1.07. R will have fallen to $93.46, which is d times S0 and d is equal to 1 over u. Okay. So this is the 1-period binomial model. Stock price goes up by a factor of u or it falls by a factor of d. We have a probability p, which is the probability of an up move and we have a probability 1 minus p, which is the probability of a down move. Okay. So we also assume that we have a cash account available, which enables us to borrow or lend at a gross risk free rate of R. So, if we invest $1 in the cash account at time t equals 0. It would be worth R dollars at time t equals 1. Similarly, if we were to borrow $1 at time t equals 0, we would have to pay back R dollars at t equals 1. We've also seen that short sales are allowed. What that means is, if I want to short sell a stock, what I can do is I can borrow the stock. I assume I can borrow the stock at no cost and sell it in the marketplace. Then later on I can buy the stock back and return to the person who lent it to me. So that's how short sales work. If I want to short sell a stock. I borrow it, I sell it in the marketplace, later on, I buy it back, and then return it to the person who lent it to me in the first place. We're also implicitly going to be assuming that there are no transactions costs. Okay, so basically, I can buy and sell and borrow and lend with no transactions costs. Okay. So two questions, two simple questions to begin with. The first question is, how much is a call option that pays the maximum of S1 minus 107 and 0 at t equals 1, 1 worth? So in this case, 107 is the strike, and this is a call option. And the second question is, how much is a call option that pays the maximum of S1 minus 92 and 0 at t equals 1 worth? So in this case, 92 is the strike. Well, in fact, here, we'll see that we can answer these questions very easily. In the case of question one, well, if we go back to our 1-period model, we see the maximum security price at time one is 107. So therefore, in fact, the maximum of S1 minus 107, 0 is always going to actually be zero at t equals 1, because in our binomial model, the stock price is never greater than 107. So the call price at time 0, we'll call it C0, must be zero. Okay, for question two, it's actually also quite straight-forward. Again, with the, the strike here is $92, if I go back to my binomial model here, I see that the smallest possible at time t equals 1 is 93.46. So no matter what, in fact, I can write the maximum of S1 minus 92 and 0. Well, that is going to be S1 minus 92. And that is because the stock price at time 1 is always greater than or equal to 92. So the max will always occur at S2 minus 92. So if I'm going to get S1 minus, minus 92 at time t equals 1, how much is this payoff worth today at time 0? Well, linear pricing tells me it must be worth S0 minus 92 over R. Okay. That's because what I'm getting is, I'm getting S1 dollars at t equals 1. Well, S1 dollars at t equals 1 must be worth S0 dollars today. I'm also getting minus $92 at t equal 1. Well, 92 is just a fixed determinant to cash growth, so I just discount its value back to t equals 0 to see if this is a total value of the option price at time 0. Okay. So that was two simple questions that we could answer. But what happens if the strike lies in between 107 and 93.46? Okay, in order to answer that, I actually need to introduce, first of all, some ideas of arbitrage, Type A and Type B arbitrage. And we're going to need these more general definitions, these are more general than the earlier definitions of weak and strong arbitrage that we used in the deterministic world. We're going to need them because we're introducing randomness Into our models. So, we have the two following definitions. A Type A arbitrage is a security or portfolio that produces immediate positive reward at t equals 0 and it has a nonnegative value at t equals 1. So, that is a security with initial cost V0 less than 0. So if its cost is negative, that means, if we buy, it we actually receive money. Okay, it's a little bit confusing. But when you have a negative initial cost, you actually receive money when you buy something. So a Type A arbitrage is a security with initial cost V0 less than 0 and time t equals 1 value V1 greater than or equal to 0. So an example of this type of arbitrage would be maybe finding $10 in the street. So if you find $10 in the street right now, well, you're going to receive a positive amount, it's like having a negative cost of $10 and at time 1 you'd have V1 equals 0. So you find the money right now, you get $10, and you have no liability at time t equals 1. Okay. A type B arbitrage, is a security or portfolio that has a non-positive initial cost, has positive probability of yielding a positive payoff at t equals 1 and zero probability of producing a negative payoff then. So let's translate them. The type B Arbitrage is a security with initial cost less than or equal to 0. So in other words, if you enter or you purchase this security, you're not going to pay anything for it and indeed you might receive something. You receive something if this is strictly negative and its terminal value times t equals 1 is nonnegative and it's not equal to 0. So , an example of such a security would be maybe someone coming up to you in the street and handing you a free lottery ticket. A free lottery ticket means you pay nothing at times 0. Okay, so we pay nothing for the free lottery ticket. And a time one, maybe you'll win something. Okay. But you definitely won't lose anything. So V1 is greater than or equal to 0, because only the lottery ticket means you're never going to have to actually pay out. And there'll be a chance, maybe a small chance, but there will be a chance that you'll actually receive something, so it's not equal to zero. So, over here, you can think of this as being the different states of the lottery. Maybe there's one state where you win. Maybe this is a positive payoff for you. And all the other states are zero. So this is an example of a security which is greater than or equal to 0, but it's not strictly equal to 0. Okay, so that's a Type B arbitrage. Now, let's return to our 1-period binomial model and discuss what conditions must hold in order to have no arbitrage in the model. Recall that we can borrow or lend at gross risk free rate, R per period. We're also assuming that short sales are allowed. So we have the following theorem. The theorem states that there is no arbitrage if and only if d, which is this quantity here, is less than the gross risk free rate, which in turn is less than u. So let's see how we might prove this. So consider the first situation here. Suppose R is less than d is less than u, then we can construct the following portfolio. Let's borrow S0 dollars and invest in the stock. This will actually gives us a Type B arbitrage. How do I know that? Well, let's see. Let's look at the cash flows. So, our cash flows R, so this is under condition one, so we have R less than d less than u, and we're going to follow this portfolio here. So, at t equals 0, we borrow S0 dollars, so that gives us plus S0 dollars, but we invested in the stock. So we're going to buy one unit of stock, so that means we're going to spend the S0 dollars we got from borrowing it and we're going to spend it on the stock, so the net cash flow times 0 is 0. What happens at t equals 1? At t equals 1, so this is from our borrow, and this is our position in the stock, and at t equals 1, we have to pay back our borrowing. So we have to pay back S0, but we have to pay it with interest. So we're going to be paying back S0 times R, okay? But we own one unit of stock, okay? Remember, we invested SS0 dollars into stock at time t equals zero. That's going to be worth us 0 or dS0 at time t equals 1. And the fact we're going to use these proceeds to pay back the borrowings at t equals 1. The net cash flow here then is u minus RS0 if the stock price went up or it's d minus RS0 if the stock price went down. But by assumption, d is greater than R and u is greater than R so this component is positive and this component is positive. So regardless of whether the stock went up or not, we're going to have made money at time t equals 1 and that is an example of a Type B arbitrage. Okay, so that's case one. How about case two? Well, we could do something very similar. In this case, if R is too large, then it suggests that it might be a good idea to short sell the stock, take S0 dollar, dollars in from short selling the stock, invested in the cash account and earn R. And then the time t equals 1, you can buy back the stock for either d times S0 or u times S0, but in either case, you're going to have less than S0 times R. So in fact, you can do the same sort of argument that I did up here to show that you would also get a type B arbitrage in case two. Okay, so we're always going to assume, later on, that d is less than R is less than u. And, that's because we don't want arbitrage to exist in our models. It's a standard economic assumption that we assume there's no arbitrage and the reason is if there was an arbitrage then market forces would act very quickly to dispel that arbitrage. Supply and demand would drive the arbitrage away. So we're always going to be assuming there's no arbirtrage.

### 012. Option Pricing in the 1-Period Binomial Model

In the last module we introduced the 1-Period binomial model. And we discussed no arbitrage conditions in that model. In this module, we're actually going to continue working with the 1-Period binomial model. But now we're going to price options in that model. We're going to assume the same 1-period model that we've been assuming up till now. Stock price begins at a 100. It goes up to 107, which is u times S 0, or it falls to d times S 0, which in this case is 93.46. We're going to assume that the gross risk free rate is 1.01. So if I invest $100 in the cash account at time zero, it will be worth $101 at time t equals 1. So now what I want to do is, I want to figure out how much is a call option that pays this quantity here worth at t equals 1. So, the strike is $102. Okay? In this case the $102 falls somewhere in between the 93.46 and the 107. And we need to figure out how much the security is worth. We'll also be interested in answering the question how does the price of the option vary as p varies? Remember p is the true probability of the stock price going up and 1 minus p is the true probability of the stock price going down. So to answer these questions, we're going to construct what's called a replicating portfolio. The idea of a replicating portfolio is extremely important in finance and derivatives pricing. So we'll see what that means in the next slide when we actually price the option. Okay. So what we're going to do is, we're going to consider the following strategy. We're going to consider buying x shares or x units of the stock. And investing y dollars in cash or in the cash account, at time t equals 0. We don't know what x and y are yet. We're going to figure out what they will be, soon. At t equals 1, this portfolio will be worth 107x plus 1.01y, when S equals 107. And it will be worth 93.46x plus 1.01y when S equals 93.46. So, this is where we had an up move in the stock price at time t equals 1, and this where we had a down move. Okay. So we buy x units of stock. So in a up move, our stock position's worth 107x. In a down move, the stock position will be worth 93.46x. And our position in the cash account will be worth 1.01y regardless of whether you had an up move or down move because the cash account is riskless. Its value at time t equals 1 does not depend on whether the stock went up or down. Okay, so what we're going to try and do is choose x and y so that this portfolio is equal to the option payoff at t equals 1. What is the option payoff at t equals 1? Well, remember it's a strike of 102, so therefore the option payoff at t equals 1 will be 0 down here, okay? The stock prices were at 93.46, the strike is 102, so you would not exercise the option and the maximum is 0. However, if the stock prices were at 107 at t equals 1 then you're in the money. You would exercise the option and receive 107 minus 102, which is $5. So if you like, that's the value of the option c1 at time t equals 1. So what we're going to try and do is choose x and y so that this portfolio we've built here in the stock and cash account at time t equals 0. We're going to choose x and y so that they equal the option value at t equals 1. The option value at t equals 1 is 5 in an up move and 0 in a down move. So 5 in the up move. We've already seen what the portfolio's worth in an move. It's 107x plus 1.01y, which is exactly what we have here. And in a down move, the portfolio is worth 93.46x plus 1.01y. Now, if you look at this, this, of course, is just two equations, two linear equations, and two unknowns. It's easy to solve it. If you do, you'll find out that x equals 0.3693, and y equals minus 34.1708. So, what we've actually done, at this point, very simple. We've constructed a replicating portfolio. We've constructed a portfolio which invests at time zero, in the stock and in the cash account. And we've chosen the quantities x and y in such a way that the value of this portfolio at time t equals 1 is exactly equal to the payoff of the option at t equals 1. So, we have succeeded in replicating the portfolio. Okay. What does a negative value of y means? Well a negative value of y just means that we're borrowing. We saw on the previous slide that y equals minus 34.1708. So y equals minus 34.1708. This is our position in the cash account. If y was positive, we would have invested in the cash account. In other words we would have lent money at an interest rate of r, but because it's negative what we're actually doing is we're borrowing money. And we're going to pay interest on that borrowings at an interest rate of r. We found the value of x of 0.3693. And this means that at time t equals 0, we purchased 0.3693 shares, or units of the stock. If x was negative, we would have, we would have actually been short-selling the stock. We would have been borrowing it and selling it in the marketplace. How much does this replicating portfolio cost at t equals 0? Well, the stock costs a $100. You can think of the cash account as costing $1. Okay? When we said we borrow $34.1708, that's like short selling the cash account. Okay. So the position is worth .3693 times 100 minus 34.1708 times 1 and that's equal to 2.76 modulo some rounding here. I didn't want to show any more than two decimal places. Okay. So the value of this replicating portfolio is $2.76. This is how much it costs to actually put on the position. Okay. So I borrow $31.1708, and I purchase 0.3693 units of share, of of the shares. And that comes to a total of 2.76. So that, I argue, is the arbitrage free value of the option. Now let's pause for a second here and think about this. I'm claiming 2.76 is the fair value of the option in this model. In fact, I'm saying it's the arbitrage free value of the option in this model. To see this suppose for example, that I tell you, suppose the option price in the marketplace is $2 not 2.76, then. There is an arbitrage. How do I know this? Well, here's what I can do. I can buy the option, so I can do two things. I can buy. The option. For $2. And the second thing I can do is I can sell the replicating portfolio. So I can do the exact opposite of this replicating portfolio. I could short sell 0.3693 units of the stock. And I could invest $34.1708 in the cash account. That will bring me in $2.76. This will cost me minus $2, so I will get a net profit of 76 cents at t equals 0. What happens if t equals 1? Well, if t equals 1, the two positions offset. Remember, this portfolio replicates the value of the option. Okay, so I've replicated the option but I also own the option, which I've purchased for $2, so the two will offset each other and I will have 0 at t equals 1 and so this is an example of a type A arbitrage. Similarly if the option price was selling for a quantity greater than 2.76, maybe the option price was selling for $4. Then what I would do is I would do the opposite. I would sell the option for $4, and I would buy the replicating portfolio for $2.76. So that will give me a net of 4 minus 2.76 which would be $1.24. I would take that in a t equal 0 and at t equals 1, the two positions would offset each other because the portfolio replicates the payoff of the option. So again, I would have an overcharge. So in fact, this value of 2.76 is the arbitrage free value. Of the option. Okay, so we've just succeeded in pricing a call option and that example with a strike of 102. We can do the same thing more generally. Okay, so we can actually price any derivative security in our one period binomial model. So how do we go about doing this? Well, again. We're going to do this now without any actual dollar numbers here. We start off with a stock price of S0. Probability of p of an up move, 1 minus p of a down move. If it goes up, the stock price ends at u times S0. And if it goes down, it ends up at d times S0 at time t equals 1. Assume we want to compute the fair value, or the arbitrage-free price of a derivative security whose payoff will cost C1 of S1, and this is the following payoffs. It pays off C subscript u up here, and it pays off C subscript d down here, if the stock price fell. So this is the payoff of the derivative security at t equals 1. Well, we want to compute the fair value of that security. And we can do it in the exact same way as before. What we do is we construct at time t equals 0 a replicating portfolio. How do we do that? Well, we purchase x units of the stock. And we invest y dollars in the cash account. Or if you like, we purchase y units of the cash account, assuming the cash account is worth $1 at t equals 0. So what we do is we set up our two equations and two unknowns. This is the payoff of the derivative security in the event of an up move, here on the right hand side. And this is the payoff of the derivative security in the case of a down move. And these are at t equaqls 1. And on the left hand side, we have the value of our portfolio at time one. If we purchased x shares at time 0. Then those x shares would be worth u times s 0 x at time 1, if the stock price went up. And then it would be worth d times S 0 times x at time 1 if the stock price fell. Of course, our y dollars that we invest in the cash account will be worth 4 times y regardless of whether the stock price went up. Or down. So, now you can solve these two linear equations and two unknowns. It's very straightforward, it only takes a few minutes to do so, so I'll leave that to you. When you solve those two equations, you will have a particular value for X and a particular value for Y. We can actually combine them together to get the fair value of the derivative security at times 0. Remember the replicating portfolio purchased x units of the stock at time 0. So x units of the stock cost this, this much. And it invested y dollars in the cash account. Or if you like, it purchased y units of the cash account with a unit costing $1. And that cost y. So the total replicating portfolio costs x times S0 plus y, and that must be the fair value of the derivative security at time 0, for the exact same argument we gave a moment ago. If it was, if the price of the derivative security was less than this quantity, we could purchase, or we could construct an arbitrage. If it was greater than the value of the replicating portfolio, we could again construct an arbitrage. Okay. So, if you actually go ahead and you solve these two equations and two unknowns, what you will find is the following. It's just two or three lines of algebra, but you can check that you will find that C0, the fair value. Of the derivative security can be written as 1 over R times R minus d, u, over u minus d times cu, plus u minus R divided by u minus d times cd. Okay. What we do is we call this guy q. This then, you can check is actually 1 minus q. Okay. If I take 1 minus this quantity here, you'll see I'm left with this here. So this is 1 minus Q. And because of the no arbitrage assumption, we have d is less than R is less than u. So in fact, R is greater than d. And u is greater than d, but because R is less than u, we see that 0 is less than q is less than 1, which of course also means that 0 is less than 1 minus q is less than 1. So in particular, I can write the derivative price, C0 as being 1 over R times q Cu. Plus 1 minus qCd. And I can actually, in fact, this is what I do, these are what are called the risk-neutral probabilities. They're risk-neutral probabilities, they are probabilities because they both sum to 1. q plus 1 minus q. Equals 1, and each probability is strictly greater than 0. These are called risk mutual probabilities. And so I can write my derivative security price as 1 over R, which is the discount factor, times the expected value of the payoff of the derivative which is C1. Under the probability mass function q, okay so what I've done is I've computed the price of the derivative payoff and its price can be expressed as the expected value of the payoff at time 1, discounted under the risk neutral probabilities. And this then is called risk-neutral pricing. So this is a really important concept in finance. We've developed the [INAUDIBLE] context of a 1-period binomial model. We'll develop it soon in the context of multi period binomial models. But we'll also see later in the course that it generalizes very easily to more complicated models. And it is, it is how derivative securities. Are priced and practiced. Okay. We can also answer our earlier question. A question we asked earlier was, how does the option price depend on p? Remember, p was the probability. The true probability of an up move. And 1 minus p was the true probability of a down move. And if we look at what we've done here, we're seeing that the fair value of the derivative security is equal to this quantity here. Well, all that's appearing here is R, capital R, and the payoff of the derivative security. These risk-neutral probabilities are expressed in terms of R, d, and u. I don't see p appearing anywhere here. So, it looks like the value of the option does not depend on p. And this seems to be a crazy situation. So just to see how crazy it is, consider the following situation. Consider two different securities. We've got stock ABC. And we've got stock XYZ. And we're going to assume that each stock follows a one period binomial model. Both stocks start off with the same initial price, $100. And at time t equals 1, the first stock can either climb to $110 or fall to $90. And it's the exact same for stock XYZ. It climbs to $110 or it falls to $90. The only difference between the two is that the probability of stock ABC going up, the true probability, is 0.99. Whereas for stock XYZ the true probability of the stock price going up is 0.01. So these are clearly two very, very different securities. They have the same values. Okay, at time t equals 0 and possible values of time t equals 1, but the probabilities are clearly very, very different. I'm sure most of you would think well you'd far prefer to own this stock than this stock. Likewise if I ask you how much is a call option Which strike $100 worth. Many of you would assume that the call option price, in this case, should be much higher than the call option price in this case. After all, the probability of going up is much higher. So remember the payoff of a call option will be $10.00 and $0 in each case. But with probability 0.99, I'm going to get the $10.00 here, but with probability 0.01, I am going to get $10.00 here. So it looks like owning a call option here should be a lot more valuable than owning a call option on stock XYZ, okay? But, that is not the case. If you believe the assumptions of the model, that there is no transactions cost and that you can borrow and lend at the risk-free rate of R, and that you can buy or short sell the stock, then our previous analysis shows us That the true value of the derivative security depends only on R and u and d. It does not depend on the true probability's p. And in fact, if my calculations are correct, in both cases the option is worth approximately $4.80. So C0 equals $4.80 here, and C0 equals $4.80 here. Now, at this point, a lot of people get upset. They go, there's no way this could be the case. There's something wrong here. The theory that we've developed is wrong, you're, you're doing something incorrect. But in fact, nothing I've done is incorrect. What I've said here is correct. The fair price of the option in both cases is $4.80. So what I want you to do now is to think about this for a while. And ask yourself what's going on. Why is the fair option price $4.80 in both cases. And to think about this. I'll return to this in a couple of modules' time, and we'll discuss this again, and hopefully we'll, we'll clarify what's going on and explain why this apparent contradiction actually is not a contradiction at all.

## 007.The Multi-Period Binomial Model

### 013. The Multi-Period Binomial Model

>> We're now going to extend our results from the one-period binomial model to the multi-period binomial model. We'll see that our results from the one-period binomial model actually extend very easily to the multi-period model, we'll see that our results from the one-period binomial model, actually extend very easily to the multi-period model. So, let's get started. Here's a 3-period binomial model, it's actually the same 3-period binomial model that we saw a while ago when we had our overview of option pricing. We start off with a stock price of S zero equals $100, we have a gross risk-free rate of r equals 1.01 per period. We assume that in each period, the stock price goes up by a factor of u, or it falls by a factor of d. So, u is equal to 1.07, so stock price goes up by a factor of u to 1.07, or it falls down to 93.46. Now the true probability of an up-move is p, and the true probability of a down-move is 1 minus p, but we also saw in the last module That P, and 1 minus P, don't matter when it comes to pricing an option. As long as in fact, and this is a subtle point, as long as P, and 1 minus P, are greater than 0, and there's no arbitrage, we determined that they were Q, and 1 minus Q, also greater than 0. These guys are called the risk mutual probabilities, and we saw that we can use these probabilities, to compute option price. For example, in a one-period model, we saw that we can compute the price of a derivative as being equal to 1 over R times the expected value using these risk mutual probabilities of the pay-off of the derivative at time 1. Okay. So, we're now in our 3-period binomial model. We want to be able to price options in the 3-period binomial model, and we can easily do in-, do that using our results from the one-period case. Because the central observation we want to make, is this multi-period, or in this case, 3-period binomial model is really just a series of one-period models spliced together. So for example, here is a one-period model, here is another one-period model and here is another one-period model. So, in fact from t equals 2 to t equals 3, there are three different one-period models, only one of which will actually occur, but there are three possible one-period models. Likewise, at t equals 1, there are two possible one-period models, there's this model and there's this one-period model. And at t equals 0, there's only one one-period model, and it's this one. So in fact, we see, we've got six different one-period models in this 3-period binomial model. And what we can do is, we can use our results for the one-period model that we developed in the last module, on each of these six one-period models, so in fact, that's what we will do. Okay, so what we have is we saw that if there's no arbitrage, in the one-period model, we know there are probabilities q and 1 minus q, these are the risk mutual probabilities that we can use to price an option in this one-period model. Well the same risk neutral probabilities will occur, or can be used here and here, and likewise there, and there. Remember each of these one-period models is essentially identical, the stock price goes up by a factor of u, or it falls by a factor of d, it's the same u and d in each of these one period models. It's also the same gross risk free rate r in each of these models. So in fact, they'll have the same risk mutual probabilities. Q is equal to r minus d over u minus d. So in fact, since r, d and u are the same for all of the one-period models, all of the one-period models have the same risk mutual probabilities, q1 minus q, q1 minus q, q1 minus q, and indeed, it's true also at time t equals 1. Q1 minus q and of course these are the true probabilities. Let's erase them, and let's replace them with the risk neutral probabilities q and 1 minus q. So in fact, this 3-period binomial model, can be thought of as being six separate one-period models, if each of these one period models are arbitrage free and we recall that will occur if d is less than r is less than u. Then we can compute risk neutral probabilities for each of the one-period probabilities and then we can construct probabilities for the multi-period model, by multiplying these one period probabilities appropriately. Suppose for example, I want to compute some risk neutral probabilities in this 3-period Binomial Model. How can I do that? Well, let's create some space here and let's get rid of this stuff. Okay. Let's compute the probability, the risk mutual probabilities, let's call them Q, of arriving at each of these terminal security prices. So, how about this point here, what is the risk mutual probability, of the stock price being equal to 122.5? Well the only way the stock price can equal 122.5 is if the stock price goes up in each period. It has to go up in every period. The probability of it going up in every period is q times q times q and that's, q cubed. How about at this point here? What is the risk mutual probability of the stock price being equal to 107 at time t equals 3? Well in this case, it's actually going to be 3 times q squared times 1 minus q. Now how do I know that? Well let's think about it. There are actually 3 ways to get to 107, one way is to, for the stock price to fall initially, and then to have two periods where it grows, goes up. A second way is for the stock price to have two periods up, followed by one period down. And a third way is for the stock price to go up, then to go down and then to go up again. So there's three such paths through the model, where the security price at time, t equals 3 can end up at 107. Each of those paths requires two up-moves, which occurs at probability q squared and one down-move which occurs at probability 1 minus q. So we get q squared times 1 minus q and there are three such paths, so we get 3q squared one minus Q. Okay, it's the same for 93.46, there are three ways for the security price to get to 93.46, It can go up and then have two down-moves. It can have two down-moves and then one up-move, or it can have a down-move, an up-move, and then a down-move. So in fact, this occurs with probability 3q times 1 minus q squared. We have 1 minus q squared, now because we need two down-moves and the down-move occurs with probability 1 minus q. Finally, the stock price can be 81.63 only if we have three down-moves in a row and that occurs with probability 1 minus q cubed. Okay? You might recognize these probabilities as being the binomial probabilities, okay, so the binomial probabilities we'll say that the probability will be n choose r times q to the r 1 minus q to the n minus r. In this case n is equal to 3. And r is the number of up-moves required. So if r equals 3, then we must have 3 up-moves and we get q cubed. If r equals 1, then it's 3 choose 1 equals 3 and we get this number here, and so on. So now suppose, we want to price a European call option in our 3-period binomial model. We're going to assume the strike is $100 and therefore, the pay-off of the option at time T equals 3 is given to us, here, it's 0 and 0 in the bottom two nodes this is because the, the strike is a $100, which is greater then the stock price of these nodes, so you wouldn't exercise and you would receive 0. If the stock price ends up at 107 you would exercise, you'd get 107 minus 100 which is $7. Likewise up here you would receive $22.5. And now what we want to do is figure out how much, is this option worth at time t equal 0. In other words, what's the fair value or arbitrage free value of this option. Well we can do this simply, by working backwards using what we know about the one-period model. So, we know how to price options in a one-period model, we saw this in the last module, we're going to do this here as well. So what we can do is, we can start at time t equals 3, okay, and we're going to work backwards from T equals 3. So what we can do is, we can actually start with this one-period model here, so let's take a look at this one-period model and just figure out how much is this derivative security worth at this node here. This is a one-period model, which pays off 7 at this node, 22.5 at this node, w e can compute the fairer value of the security, at this node. We can do that using our one-period nodes. We can do the exact same, for this node, okay, we can come treat this as a one-period model, compute the fair value at this node and also compute the fair value at this node. Okay, so by working backwards now we can assume we know the option price at this node, at this node, and this node, and now we can do the exact same thing. We can now go from t equals 2 back to t equals 1. In this case we've got two, one-period models, here is one of them. We know how much the option price is worth there, we know how much it's worth here, so we can figure out how much it's worth here again using our results from the one-period theory. Likewise, in the one-period model here we can do the same thing, we know how much the option is worth at this node, we know how much it's worth at this node, it's already calculated, and we can use our one-period knowledge to figure out its value at this node. Finally, we can go from t equals 1 to t equals 0, and again, we want to compute the value of a derivative security with a pay-off of this quantity at this node and this quantity at this node. And we can actually compute the fair value of this, again using the risk-mutual probabilities, to compute its fair value here, which we would call C0. So that's all you have to do. Right, we can splice our one-period models together, they're all arbitrage free as we've said, because D is less than r is less than u, so there are risk mutual probabilities in each of these one-period models. So what we can do is just work backwards, starting off with the final value of the option at t equals 3. Figure out how much it's worth at the nodes at t equals 2, using our one-period theory. Going from t equals 2, back to t equals 1, again using our one-period knowledge, and from t equals 1 back to t equals 0. And here are the calculations. So, I haven't actually done the calculations here, but there is a spread sheet that you can download with this module and in the spread sheet there'll be a particular work sheet which will actually have these calculations as well as the formulas inside the cells which will do these calculations for you. So, what you'll see is we're actually calculating these quantities, according to the one-period model. So for example, let's take a look at this one-period model here. I know that the 15.48 over here, is equal to 1 over r times q, of 22.5, So q times 22.5, plus 1 minus q times 7. This comes from our one-period theory and of course q is the risk neutral probability of an up-move, it's equal to r minus d over u minus d. And of course, in this case, u is equal to 1.07, d is one over u, and r was equal to 1.01. So, you can actually check these calculations in the spreadsheet, if you like, you can have the spreadsheet open while you're going through this module, and you'll see the formulas in each of the cells showing these calculations. So what we're doing, is we're working backwards, so. The cell, here, at this point in the spreadsheet, will have exactly this formula here. Likewise, except it wont have, 22.5 and 7, it will just refer to the cells, containing 22.5 and 7, and it will be the same formula repeated throughout, throughout the, the spreadsheet. So that's how we compute the value of the option and it's fair value at time 06.57. And it's important to keep in mind that this is the arbitrage free value of the option. The way we calculated this value is by using our one-period knowledge and working backwards one period at a time, but in fact there is a faster way to do it. We can use what we did in the previous slide, where we calculated these risk neutral probabilities. Okay, so these are risk-mutual probabilities. You can easily check, that doing this backwards calculation, working backwards one period at a time, is actually the same thing as doing it all in one shot. So instead of doing a calculation coming back from t equals 3, to t equals 2, to t equals 1, to t equals 0, I can do it as just one calculation, okay? Where the call price at time 0 c0 equals 1 over r cubed, so this is our discount factor, it's cubed because it's 3-period, and it's the expected pay-off of the option, which is ST minus 100, and the maximum of that in 0 under these risk mutual probabilities here. So, I can do it in one shot! So, basically working backwards one period at a time you can check is it the exact same thing as doing it all as just one calculation like this. Okay. This is risk mutual pricing of the binomial model, it avoids having to calculate the price at every node. And by the way, you can compute any derivative security in this model this way. You can compute the pay-offs here at t equals 3, and use risk mutual pricing in one shot like this. So for example, let's create some space here. So. Okay. Suppose I want to compute a derivative security, which has pay-offs C, let's call this, okay so let's call it c of 122.5. So this is the underlying security price at this node, c of 1 of 7, c of 93.46, and c of 81.63. Okay, so, this could be the derivative payoff c3, there's some value at time T equals 3, and, its value depends on the security price at T equal 3, so it could be a call option a put option or some other funky security. Then I can calculate this price, As 1 over r cubed times the expected value, using these risks neutral probabilities of c. Okay, and it's exactly the same margin we used for the one-period model. I could work backwards one step at a time to compute the value at each of these three nodes. Once I have those three nodes, I can work backwards to these two nodes. And once I've divided these tee-, two nodes, I can work backwards and get the value here, or I can do all of that in one shot, via this calculation here. The spreadsheet does it by working backwards one period at a time and you can see the formulas in there and I'm confirmed that all we're using are the one-period risk neutral pricing formulas, okay. Another question, that arises, is down here. How would you find a replicating strategy? We'll address this question, as well as defining, what a replicating strategy means, in another module that we'll see very shortly.

### 014. What   s Going On

>> We're now going to return to a question that I raised in an earlier module, that question concerned the following situation. We had a one period binomial model and we had two securities that were absolutely identical except they had different probabilities of an up move. The first security had a probability of 0.99 of an up move The second security had a probability of .01 of an up move. We ar-, argued however that both of these securities had the same option prices and we found that to be somewhat surprising. Well, we're going to address that issue in this module, as well as some other questions that are also of interest. So if you recall, we had the following situation. We had two securities, stock ABC and stock XYZ. The two stocks are identical in every way except they had different probabilities of going up and going down. Stock ABC had a probability of going up of 0.99 and a probability of going down of 0.01. Whereas stock XYZ had these probabilities flipped. The probability of going up was 0.01, the probability of going down was 0.99. And then we talked about an call option with payoff equal to the maximum of S1 minus 100, and 0. Okay, and we wanted to know how much a call option was worth on each of these two stocks. Well, the strike is 100, so the payoff here would be 10 or 0, in each case. So this is the payoff of the call option, C1. Probability of a payoff here, is 0.99. And down here, it's 0.01. So it stands to reason that the value of a call option on this security with a payoff of 10 with probability 0.99 should be worth a hell of a lot more than the payoff of 10 with probability 0.01. Well, if you believe the theory that we've developed so far, then that is simply not true. Assuming you can invest or borrow in the cash account at a gross risk-free rate of R, and that you can buy or short sell the stock, then in that case the call option in both cases must be identical. And it turns out to be approximately $4.80. So C0's approximately $4.80 here. C0 being the fair value of, the option price at time 1. And C0 down here is also equal to $4.80. And so this seems very strange indeed. And a lot of people get upset with this idea. They feel something is wrong with the theory, when you can have a situation where 10 with probability 0.99 is worth $4.80. But also, 10 with probability 0.01 is also worth $4.80. And so, it seems like there's some sort of contradiction, or something strange going on here. And we're going to resolve that issue by reminding ourselves, first of all, of our one period theory. In our one period theory we saw that the fair value of the option C0 is equal to 1 over R times the risk-neutral expected value of the payoff. So that's this quantity here. Where the risk-neutral probabilities are given to us by that quantity and this quantity u minus R over u minus d equals 1 minus q. And of course we see that the true probability p, well it just doesn't seem to appear everywhere. The only assumptions we made about p was that p is greater than 0, and 1 minus p is greater than 0. Likewise, with no arbitrage we know that d is less than R is less than u. So that q is greater than 0, and 1 minus q is greater than 0. Okay, so it appears that p does not matter, and this is the source of confusion for a lot of people. But in fact it only appears surprising because we are asking the wrong question. So the question we were asking is, why is an option in this model worth $4.80, and it's also worth $4.80 here? That's not the right question to ask. The right questions to ask is, why would you find a situation like this in an economy? Where it is the stock with probability of 0.99 growing by 10%. And in the same economy that you would find another stock which would have a probability of only 0.01 of going up by 10%. These stocks are incredibly different. You would never expect to see two securities like this in the same economy. So your problem shouldn't be with the option pricing theory and why you get these two option prices being equal to one another. Your question should be, why would you ever expect to see two securities like this in the same economy? This is the source of the problem. Assuming that you could find two stocks like this in the same economy. I've never seen this situation myself. I've never seen any situation like this, and I can't imagine a situation like it happening. But if you did find yourself in an economy where you had two stocks, ABC with this characteristic, or these characteristics. And stock XYZ with these characteristics, then, indeed, you will see that the option prices in the two, on the two securities will be the same. And, so the source of confusion is resolved by focusing on why you would see these two securities and not by focusing on the option pricing theory. The option pricing theory simply states that if you do have two securities like this in the economy then they will have the same option price. Okay. On this slide I want to discuss another interesting example. Consider the following three period binomial model, which we have here. The stock price starts off at S0 equal to 100 and it goes up by a factor of u equals 1.06, or it decreases by a factor of d in every period. The gross risk-free rate is 1.02, and we want to price a European call option, with strike K equals 95. So, the way we do that, as usual, is we determine the payoff of the option at maturity. So the maturity is at t equals 3. And this is the payoff of the option. It's 24.10 if the stock price is 119.1, 11 if the stock price is 106, and 0 in the other two states. Okay so note that this cash flow is non-negative and it's strictly positive in these two states up here. Okay, and we can price this option using our knowledge learned to date, and we can find out that the option price is equal to 11.04. Okay, let's price the same option again, but this time we're actually going to change the risk-free rate. We're going to change it from 1.02 to 1.04. Everything else about the option is identical. We've got the same set of cash flows at maturity at t equals 3. We can work backwards in the lattice computer's price and if we do so we find the price is equal to 15.64. So in the first case when R equals 1.02, we find the option price is 11.04. In the second case when R equals 1.04, we find the option price equals 15.64. Now, this is a little bit surprising because what we've done here is we've computed the value of this cash flow. By computing its value today, t equals 0. And we've discovered that when we increased the interest rate, the option prices increased. That is totally against what you would see in a deterministic world. In a deterministic world, when you increase the interest rate, what you do is you decrease the present value of the cash flow. But here the cash flow hasn't changed, but we haven't decreased its present value. It's fair value is 15.64, which is an increase on 11.04. So this should tell you that option pricing can produce and throw up some interesting and surprising results. It is very different from the deterministic world which you are probably more familiar with. Before we end this module, I want to spend a couple of minutes discussing the existence of risk-neutral probabilities, and their implications for no-arbitrage. First of all, recall our analysis of the binomial model. We saw there that no-arbitrage is equivalent to d being less than R being less than u. We also saw that any derivative security with a time capital T payoff, Ct can be priced using risk-neutral pricing as follows. For q and 1 minus q are the risk-neutral probabilities and n is the number of periods. Just to relate n and T to you as follows, if you assume that delta t is the length of a period, then capital T equals n times delta t. So that's the link between T here, and n over here. Okay, so this is what we saw in the binomial model. When there's no-arbitrage, there are risk-neutral probabilities that are strictly positive, such that all cash flows and derivative securities can be priced using this representation here. This representation is actually more general. In fact, you can show that if there exists a risk-neutral probability or risk-neutral distribution Q, such that four holds in any model, then arbitrage cannot exist. Okay, why is this the case? Just to see a simple example, consider the following situation. Suppose we've got a model with, m states, omega 1, omega i, down to omega m. Okay. And suppose we want to consider some security which has a payoff in each of these states. And we'll assume that payoff, is non-negative in all of these states. And let's suppose that there's actually one state, where the payoff is strictly positive. Okay. Now if we have risk-neutral probabilities, strictly positive risk-neutral probabilities q1, so on down to qi, down to qm, such that this situation is satisfied. Then notice that the expected value of Ct, so this is Ct here. Then the expected value of Ct, must be greater than 0. Why is that? Well all of these probabilities are strictly positive. You're multiplying them by a cash flow that's non-negative, and at least in one state, strictly positive. Therefore, the expected value of Ct is strictly positive. What that means is that you can't get a type B arbitrage. That's not possible. Okay. Similarly, you could show that you can't get a type A arbitrage. Okay? You would just replace this with a greater than or equal to sign. And show then that the price of this, according to the representation four, is greater than or equal to 0. Which means it can't have a negative cost, which means there can't be a type A arbitrage. So in fact, any model which has this representation, in other words where you can compute the value of Ct using a set of risk-neutral probabilities, then in such a model there cannot be an arbitrage . Okay, the reverse, actually, is also true. If there is no arbitrage, then a risk-neutral distribution exists. We've shown that in the binomial model, but it's actually true more generally. And together, these two last statements, are often called the first fundamental theorem of asset pricing. That is, the existence of risk-neutral probabilities and no-arbitrage are equivalent.

## 008.Pricing American Options and Replicating Strategies

### 015. Pricing American Options

>> Up until this point we've only seen how to price European options in the binomial model. We are now going to consider the case where the holder of the option has the ability to exercise early, such an option is actually called an American option and we'll see that we can also easily price these securities in our binomial model. So the only difference is that, we must now also check if it's optimal to early exercise at each node. So if you recall the way we priced European options, we actually started at the end. At t equals 3. Here, we've got a three period binomial model. We began at the end, computed the payoff of the European option at t equals 3. And then we worked backwards one period at, at a time, figuring out how much the option was worth at each period. And working way backwards, using our one period results to get the option price at times zero. That's how we computed the European option prices. Well, we can do the exact same thing with American options. We're going to start at the end and we're going to work backwards one period at a time using the risk mutual probabilities in each period to compute the value of the option. The only difference is, now we have to check at each period if it's optimal to exercise early. So when we're working backwards, we're going to compute the value of the option but also check to see if that value is greater than the value of exercising at that point. If it is, we don't exercise. If it's not, we do exercise and we continue backwards. Okay, and we're going to see how this, how this works in practice. There's also a spread sheet that you can use to see the calculations, and to see how we price the American options. So if you like you can go through that spreadsheet or have it open, while we're doing these calculations. Okay, first of all recall that it is never optimal to early exercise an American call option on a non-dividend paying stock. So we saw that in an earlier module, so we're actually going to consider pricing American put options here. So the put option is going to as-, as-, assume an expiration or a maturity of t equals 3. A strike of $100. And we'll assume the risk-free rate, the gross risk-free rate per period is 1.01. Okay, so this is our binomial model that we've been using a lot until now. It starts off at $100 the stock price starts, at $100. It goes up by a factor of u. It goes down by a factor of d in each period. So the payoff of the put option. So remember the payoff of the put option will be the maximum of zero and the strike minus the stock price at time three. The stock price at time three is 81.63, 93.46, 107 and 122.5. The strike is 100. So we will only exercise if the security price is less than 100. So that's why we're going to get zero up here. And we're going to get 100 minus 93.46 down here, and 100 minus 81.63, which is 18.37. So this is the payoff of the American option if we exercise at a time t equals 3. And all we're going to do to price this American option is we're going to work backwards in the same manner as we did with European options, but this time at each node we'll also have to check if it is optimal to exercise at that point or not. Okay so here's an example of how we do these calculations. So we know the value of the American option at t equals 3. It's 0, 0, 6.54, 18.37. So we're going to work backwards one node at a time. So let's actually consider this piece here. And suppose we're down at this node here and we want to figure out how much is the option worth. Well, if it was a European option, we would say the fair value of the option is 1 over r times q times 6.54 plus 1 minus q times 18.37. That's how we computed the fair value of a European option in the one period model. We discount it and use the risk mutual probabilities to compute the expected payoff one period ahead. We do the exact same thing here. Except, we have the ability to early exercise the option. In other words, when we're at this node we have two choices. We can choose to continue. Or we can exercise. The choice is ours. If we choose to continue, the fair value of the option is this guy here, whatever this turns out to be. Let's just call it x. So we'll get x. If we exercise, we'll get 100 minus 87.34. And that's equal to 12.66. However the, the choice is ours. So we will choose to exercise if 12.66 is greater than x. And we will choose to continue if x is greater than 12.66. In this case it turns out that 12.66 is the greater of the two so x is less than 12.66. So at this node we choose to exercise and we get 12.66. So the fair value of the American option at this node is $12.66. And we do the exact same thing at this node and at this node. And as I said earlier, you can see these calculations in the spreadsheet that we've, we've uploaded onto Coursera. Okay. So we can work backwards in each period and we actually find that the fair value of the American option is 3.82. Okay. Not only that, you will see that the only point at which it is optimal to exercise early is down here at this node. And at each of the other nodes the fair value of the option turns out to be the continuation choice. It's only at this node that exercising was optimal, and that's why we've highlight it in a different color here. So that's how we price American options. We just work backwards in the lattice, in the binomial tree as we did with the European options, but with the added complication of having to check at each node whether it was optimal to exercise or not. To give ourselves a flavor of optimal stopping problems, we're going to consider one more example. And this is a simple die throwing game. So consider, for example, the following game. We've got a fair six-sided die. So let's try and draw, a six-sided die. Okay. So you've got the numbers one to six on the six sides of this die. We'll now throw the die up to a maximum of three times. After any throw you can choose to stop. And when you stop you obtain an amount of money equal to the value you threw. So the value you threw is whatever is showing here with you throw the die. So for example if you throw a four on your second throw and you chose to stop, then you'll obtain $4. So if you are risk neutral how much would you pay to play this game? By risk neutral I mean that you just want to compute the fair value of this game using the true probabilities. The amounts of money concerned are so small the risk doesn't enter into the situation. Okay. So how much is this game worth playing? I always like this game because it gives you an example of another optimal stopping problem. It's also a game or a question that many interviewers over the years have liked to ask our students when they were interviewing for jobs in the, in the financial industry. So let's think about this. So the solution is going to be to work backwards starting with the last possible throw. So if we've just got one throw remaining, then the fair value of the game must be 3.5. And the reason is, on that last throw you can get 1, 2, 3, 4, 5 or 6. Each with probability 1 6th. And so the fair value of this game is 1 6th times 1, 1 6th times 2, and so on, and it's equal to 3.5. Now, suppose you've got two throws remaining. What we must do is figure out a strategy which determines what to do after the first throw of these two throws, okay? So that first throw refers to the first of the two throws remaining, so it's throw two in the overall game. Okay, so let's think about this. So, we've got, throw number two. We can get a 1, a 2, a 3, a 4, a 5, or a 6 on that throw. Each of these occurs with probability 1 6th. So if we get a 1, 2, or 3, if you think about it, it would make sense to continue. Why? Well if we continue, we will expect to get 3.5 on our last throw. So why would you stop and get a 1, a 2, or a 3 when you expect to get a 3.5 on your last throw? So in each of these, you would continue, and expect to get 3.5. On the other hand, if you get a 4, 5, or a 6, then why would you continue? Why would you continue and expect to get a 3.5 when you can stop and get a bigger number. So in fact, for each of these numbers, you will stop. And get 4, 5, or 6. So the fair value of the game with two throws remaining, is, 1 6th, times 3.5, plus 1 6th times 3.5., plus 1 6th times 4, plus 1 6th times 5. And so on. So the fair value of the game is 1 6th times 4, plus 5, plus 6, plus 1 half times 3.5 which is 4.25. So that's the fair value of the game if the, if there's two throws remaining. If there's three throws remaining, the exact same idea works. You now consider the first throw. Okay, so there's not much room here, but the first throw, we could start with here. And we would figure out what to do in each of these scenarios. Well, If we throw a 1, 2, 3, or 4, we would actually choose to continue. Why? Because the fair value of continuing with two throws remaining would be 4.25 which is greater than 4. Otherwise, if we get a 5 or 6, we would stop. So you can actually compute the fair value of this game is going to be 2 3rds times 4.5 plus 1 6th times 5 plus 1 6th time 6. And that's the fair value of this die-throwing game. If you could throw the die 1,000 times. What do you think will happen to the fair value of the game then? It should be pretty clear. And I'll let you think about that. The reason I like this game, though, is, it emphasizes the idea of a strategy, or a stopping time. You have to figure out the optimal strategy, what you must do at each point in time. Do you continue or do you stop. With the American option problem you have to figure out do you exercise or do you continue. In the binomial example over here we did it automatically by working backwards. And at each point, at each node we figured out the optimal strategy. Do we exercise or we, do we, do we continue? And we got the fair value of the option, 3.82.

### 016. Replicating Strategies

In this module we're going to discuss replicating strategies in the Binomial Model. We've already seen replicating strategies in the one period binomial model, but we're actually going to see as well that you can construct replicating strategies that replicate the pay off of an option in the multi-period binomial model. And we'll see in fact that we can price options by constructing a replicating portfolio. In fact, that's what we were doing all along when we were computing option prices by working with the one period risk mutual probabilities, and working backwards in the binomial lattice. They're actually the same thing, but we're gonna make that clear in this module. We're going to as usual, let St denote the stock price at time t. We're now going to let Bt denote the value of the cash account at time t. We haven't spoken about Bt before, but it's always been in there background where we spoke about the gross risk fee rate or. So what we're going to do now is formally recognize that as a security. We're gonna start off at time 0 with B0 equals $1. So this is the value of the cash account. At time 0, and then the values of the cash account at time t is simply R to the power of t. So it's just a deterministic security that grows by a factor of R in each period. Okay, so now we're explicitly viewing the cash account as a security. We're going to let xt denote the number of shares held between times t minus 1 and t for each t equals 1 up to n. We're also going to let yt denote the number of units of the cash account that we hold between times t minus 1 and t, for t equals 1 up to n. And then we're going to define theta t to be xt, yt, and this is the portfolio that is held at time t. So it is the portfolio that's going to be held immediately after trading at time t minus 1, and immediately before trading at time t. So, theta t is the portfolio that's held between times t minus 1 and t. Theta t is also a random process, and in particular, we call this a trading strategy. So, here's an example of a three period binomial model. And in this we have theta 0 applying from this time to this time. Of course, we can have another theta 0 from this node down to this node. And of course theta 0's identical in both cases because it has been chosen at this time, here in account look into the future when it's making its trading decisions. For another example theta 2 will be chosen at this node, theta 2 will be chosen at this node, theta 2 will be chosen in this node, and in each case the theta 2 will be actually different. We'll have a different theta 2 here. A different theta 2 here, and a different theta 2 here, and of course, theta 2 then applies at time t equals 3. Okay, so these are examples. So, this theta here is an example of a trading strategy. And of course, you'd also have a theta 1 chosen there, and a theta 1 chosen there, and the predictor's amounts of securities of the security and the cash account that you purchase at time 1 will depend on whether your down here or your up here. Now I want to discuss the concept of self financing, and in particular self financing trading strategies. Before we do that, we just need to define what we mean by the value process, Vt of theta, that is associated with the trading strategy theta t equals xt, yt. We define Vt to be equal to xtSt plus ytBt for t greater than or equal to 1, and of course, this is just the value of the portfolio time t. Xt, xt's the number of units of the stock that we hold, so xtSt is our stock position, and ytBt is our position in the cash account, our value of our cash account position, so this is the total value of the portfolio. We need a slightly different def, definition of t equal to 0 and that's because we don't have an x0, y0. If you recall, xt is the number of units of shares that we purchased at time t minus 1. So, if we had an x0, we would be referring to time minus 1, but we don't have a time minus 1. So we have a slightly different definition for t equal to 0, but we still end up with the value of the strategy times 0. So when t equal 0, we get Vt equals x1 times s0 plus y1 times b0. But of course x1 has chosen at times 0, and y1 has chosen at times 0. So if you like, this is the value of the portfolio immediately after trading at times 0. Okay, so that's the value process. We now want to define what we mean by a self-financing trading strategy. A self-financing trading strategy is a trading strategy where changes in Vt are due entirely to trading gains or losses, rather than the addition or withdrawal of cash funds. In particular, a self-financing trading strategy satisfies Vt equals xt plus 1 st plus yt plus 1 Bt. And if you notice, Vt is therefore the value of the portfolio immediately after trading at time t, because xt plus 1 is the number of units of shared help between times t and t plus 1 and yt plus 1 is the number of the units of the cash account held between times t and t plus 1. So this is the value of the portfolio immediately after trading at time t. Up here, this is the value of the portfolio immediately before trading at time t. We now have the following proposition. If a trading strategy, theta t is self-financing then the corresponding value process Vt satisfies this relationship here. So what's going on on this relationship here? Well the left hand side is just the change in value of the portfolio, and on the right hand side we have xt plus 1 which is the number of units of the share held between times t and t plus 1 times the gain on the stock. Plus yt plus 1 times the gain on the cash account. So, all this is saying is that if the strategy theta t is self-financing, then the gain in the portfolio is equal to the number of stocks held times the gain on the stock, plus number of units of the cash account times the gain on the cash account. So in particular, changes in the value of the portfolio can only be due to capital gains, so a gain in the stock or a gain in the cash account, or capital losses, and not the injection or withdrawal of funds. In other words, nobody is injecting funds into the portfolio at time t or t plus 1, and nobody is withdrawing funds from the port, portfolio times t at plus 1. So all the changes in the value of the portfolio are coming from capital gains, or losses on the stock on cash account. And it's actually easy to check this result. So, we just go through it for the case t is greater than or equal to 1. In that case, Vt plus 1 minus Vt is as follows. Well, Vt plus 1 is actually equal to, we can see it here it is equal to, we're gonna use this definition at t plus 1. So it's xt plus 1 st plus 1, plus yt plus 1 Bt plus 1. So that's what this term is here, and when we subtract Vt we're going to use the self-financing condition and use this over here, and thus this term here, you put them together and you get the desired quantity. We get a similar simple proof for the case where t equals 0. So that's what a self-financing con, trading strategy is, it's a very intuitive idea. It's simply what you would get from a trading strategy where all the trades are funded by the gains or losses in the portfolio through time. They're not funded by injecting fresh capital into the portfolio or taking capital out of the portfolio. Okay, in this slide, I want to talk about Risk-Neutral Prices of securities and emphasize them in fact, they're the same thing. Those prices are the same prices you get from constructing replicating strategies. Okay. So we have seen how to price derivative securities in the binomial model. And the key we saw to this was the use of one period risk mutual probabilities. But actually we first pressed options in the one period models using a replicating portfolio argument. And we did this without ever needing to define risk-neutral probabilities. If you go back to that earlier module you'll see, we actually priced the 1-period option construct by constructing a replicating portfolio. We only constructed risk-neutral probabilities afterwards and we used these risk-neutral probabilities that defines all securities. But the first thing we did was we constructed a replicating portfolio in the 1-period model. Well, in the multi-period model, we can do the same. We can construct a self-financing trading strategy that replicates the payoff of the option. This is called dynamic replication. And the initial cost of this replicating strategy must equal the value of the option. Otherwise, there's an arbitrage opportunity. And the way to see this is, is as follows. So, as before let theta t be our self-financing trading strategy. Let V0 be the initial value of the strategy. And let V capital T be the terminal value. Of the strategy or Vn. We've been using n for number of periods so we can stick with n. Now because this is self-financing strategy, there are no cash flows between time 0, which I'll highlight here. There are no cash flows between time 0 and tie n, and time n. There's no cash flow coming out. There's no cash flow going in. The strategy self-finances itself. So, the only time there's a cash flow is at time 0, which is when the portfolio's constructed, and the time n has some value. So Vn, if Vn is equal to the value of an option say at time n, Cn then the fair value of the optional time 0 must be V0, otherwise there would be an albatross strategy. For example, a V0 was less than C0 you could buy V0, buy the self-financing trading strategy at times 0, sell the option at times 0, so you would make money for nothing. You would get C0 minus V0 which is greater than 0, and then at maturity at time n, Vn would be equal to Cn, so the cash flows would cancel each other out at time n, and that would be an arbitrage. Okay. So, the initial cost of this replicating strategy must equal the value of the option. This dynamic replication price is, of course equal to the price obtained from using the risk-neutral probabilities and working backwards in the binomial lattice. And in any node, the value of the option is equal to the value of the replicating portfolio at that node. So for example, this is our earlier European option. So, in black here we have the stock price, in blue we have the option price, and in red xt, yt, we have the replicating strategy. So the way we price this option initially whilst we determine the payoff at time t equals 3, remember the strike here was $100. So it was a call option, with strike equals $100. So these are the payoffs of the options 22.5, 7, 0, 0. And the way we priced this option originally was we computed its price at time t equal to 2 by looking at each of the one period models at time t equals 2, so this is one, one period model. This is another one period model, and this up here is another one period model. I'm gonna use their one period knowledge, in particular the one period risk-neutral probabilities, to compute the prices of the option at these points. Okay. Then given these prices of time, t equals 2, we work backwards to t equals 1 to compute the price of the option at t equals 1, again using our knowledge of one period binomial models in the 1 period risk future probabilities. So for example, here we found that the price was 10.23, and in fact, 10.23 was calculated as the price of a derivative security that paid 15.48 this node, and 3.86 at this node, i.e., the value of the option at this node and the value of the option at this node. But in fact, when we're doing that, all we're really doing implicitly is constructing the strategy at this point, which replicates 15.48 and 3.86. So, when we were working backwards in the lattice, what we were really doing is constructing a replicating self-financing trading strategy. Okay. So, we can see here in the next slide, we can see the replicating strategy. Modular rounding errors is not enough decimal, if I put in additional decimal points the slide would look to cluttered. So modular rounding errors these, these numbers are correct so xt, yt, xt, yt. And what you can actually see for example, down here we have it, so 0.8, so now I'm referring to this node here. Okay, so at this node here, what we are saying is that 0.802 x 107, 107 is the value of the stock at that time minus 74.84 times 1.01. Well this is the value of the cash account. Time 1, and at this node. Well that's equal to 10.23, which is the value of the option at that node. And you can check that this strategy actually at time 2 will replicate 15.48 if the stock price goes up. If we go up this way or the strategy will be worth 3.86 if the stock price falls. Another check you can do here is you can actually check the self-financing condition. So here's how we can do that. So, the self-financing condition at this node should say that the value of the portfolio just before trading at this node equals the value of the portfolio just after trading at this node. So, just before. What is the value of the portfolio? Well just before trading we're holding 0.598. Units of stock and the stock is worth 107, and we are short minus 53.25. Times the cash account which is worth 1.01 at that node. So this is the value of the portfolio just before trading at this node, just after trading at that node we are holding 0.802 units of the stock. And minus 74.84 units of the cash account, and as I said, modular rounding errors these two numbers must be the same. That is the self-financing condition. So, when you look at option pricing in this binomial model, you can think of it as using the risk-neutral probabilities, working backwards one period at a time to compute the price. But what you're all implicitly doing when you do that is you're constructing the self-financing trading strategy that replicates the payoff of the option, and the value of the self-financing trading strategy times 0 is 6.57, and this is called dynamic replication. What you're doing is you're using a trading strategy which adjusts the holding in the stock and the cash account at each time, so that at time t equals 3, at maturity, we replicate the payoff of the option.

## 009.Dividends, Pricing in the Binomial Model, and the Black-Scholes Model

### 017. Including Dividends

>> So far we've discussed option pricing and derivatives pricing in the binomial model, but we've made no mention of dividends. In this module we're going to discuss dividends and point out that it's actually include, easy to include dividends, in the binomial model. So here's our one period binomial model again. We start off with t equals 0, the security price of S0. We have a probability of p, a true probability of p, and a true probability of 1 minus p of an up move and down move respectively. We're going to assume that if the security goes up, the value of the stock goes to uS0 and if it goes down it goes to dS0. But we're also going to assume that the security pays a proportional dividend of C times S0. And at C times S0's what get pays out, paid out as a dividend at time t equals 1, regardless of whether the stock has gone up or down. So you'll see that CS0's here and CS0's down here as well. So this is the dividend that gets paid out, to the shareholders. Okay, as before we have a cash account which pays out a gross risk-free rate of four, we assume the cash account is worth one dollar or one euro or one whatever at time t equals 0 and its worth R at time t equals 1. So it's easy to check again that there are no-arbitrage conditions for this one period binomial model and in particular the no-arbitrage conditions are given to us by here. And this is the direct analog of the no-arbitrage conditions we saw when there were no dividends. So d plus c is the total return of the stock if the stock falls from S0 to dS0. And u plus c is the total return of the stock, if the stock raises, or rises, from S0 to uS0. So, clearly, R cannot be less than d plus c, otherwise there would be an arbitrage. You could buy the stock and sell the cash account. Likewise, if R was greater than u plus c, then you could short sell the stock and buy the cash account and again create an arbitrage. Okay. So what we can do is that suppose we want to price the derivative security with value C1 of S1 at time 1. It pays off Cu in this upper state here, and it pays off Cd in this lower state over here. So what we can do is we can again construct our one period replicating strategy to replicate the payoff of this option. So, in particular, we're going to let x be the number of units of the stock that we purchase at time 0, and y be the number of units of the cash account that we purchase at time 0. Well then the replicating aspect of this portfolio means that we must have these two linear equations. In particular, the value of the portfolio here on the left-hand side if the stock goes up is uS0 times x plus cS0 times x. So this is the dividend piece, this is the value of the stock. Plus R times y, this is the position of the cash account. And that must be equal to C0, if the stock price goes up. If the stock price goes down, then we have dS0x plus cS0x plus Ry equals Cd. So these are the two equations that we have. If we can find x and y so that these two equations are satisfied, then the portfolio xy, which is purchased at time 0, replicates the payoff C0 and Cd. So therefore the value of this portfolio at time 0 must be the arbitrage-free value of this derivative security. So we can solve these two equations and two unknowns. If we do that, we'll find that C0 can be written as follows. The fair value C0 is equal to xS0 plus y, and we can write it like this. Again, we can write it in the form of having risk-neutral probabilities and now Q is equal to this quantity here. Which is the same as our original one period risk-neutral probability, except now, we have this additional minus c. 1 minus q is equal to u plus c minus R divided by u minus d, and that's that term there. So, again, when the security pays a proportional dividend, we can still construct a replicating strategy. And we can compute the price of a derivative security as the discounted expected term or payoff of the derivative security using these risk-neutral probabilities. Okay. In the multi-period binomial model we can assume a proportional dividend is paid in each period. In particular we would assume a proportinal dividend of cSi is paid at t equals i plus 1. Then each embedded one period model has identical risk-neutral probabilities. They're given to us by these quantities here, and derivative securities are priced as before. We can work backwards in the binomial lattice using these risk-neutral probabilities, to calculate the va-, fair value, or arbitrage-free value, of the derivative at each time period. Until we get back to t equals 0, which gives us the initial price, arbitrage-free price, of the security. In practice dividends are not paid in every di-, period. They're often paid every six months or every year, and so they're a little more awkward to handle in practice. We might discuss that later in the course, but for now we'll, we'll, we'll leave it at that point. Another point to keep in mind is, is the following. Suppose the underlying security does not pay dividends. Then it's easy to check that this is true. The initial value of the stock is equal to the expected value, using the risk-neutral probabilities of the terminal value of the stock discounted. And of course, that follows easily from our risk-neutral pricing, because we know the stock price Is equal to Sn minus 0, 0. Take the max of these two. So in fact this is just a call option with K equal to 0. So the stock price is equal to a call option on this stock with its strike K equal to 0, and so this just follows from the pricing of call options. But of course, every security must be priced like this. Okay. Suppose now that the underlying security pays dividends in each time period. Then you can check that eight no longer holds. Instead what holds actually is the following, the initial value of the stock, S0 is equal to the expected value at time 0 using the risk-neutral probabilities of Sn divided by R to the n, which is what we have here, plus the sum of the dividends, which we'll call Di, discounted appropriately. Okay. We're assuming Sn is the x dividend security price at time n. So Sn is the price at time n immediately after the dividend at time n is paid. And you don't need any new theory to prove this. We can just use what we've seen already. It follows from this mutual pricing, and observing the dividends and Sn may be viewed as a portfolio of securities. So, to see this we can view the ith dividend as a separate security with value equal to this quantity here. So if we view the ith dividend which is paid at time i as a security that pays at cash flow only at time i, then our risk-neutral pricing tells us that the value of this dividend is Pi. And it's equal to this quantity here. Now we can view the owner of the underlying security as owning a portfolio of securities at times 0. The value of this portfolio is the value of the securities within the portfolio. Those securities are each of the n dividends. Okay, and each of those n dividends is value Pi for i equals 1 to n, plus the terminal value of the stock, or if you like, the, the value at time n. And that's Sn discounted by R to the n taking its expectation with respect to the risk-neutral probabilities. But of course we also note the value of the underlying security is S0, so S0 must be equal to this quantity here. Okay. And so we get S0 equals to the sum of the Pi's plus this quantity and that is just equation nine.

### 018. Pricing Forwards and Futures in the Binomial Model

>> We're now going to see how to price forwards and futures in the binomial model. We'll see that they're very straightforward to price even though the mechanics of these securities are different. We'll also ask the question, how do the prices of forwards compare with the prices of futures? We'll see that in the binomial model, they're actually identical, although we will make the point that this is not true in general. We're going to start with an n-period binomial model. Although, in this case, we see n is just equal to 3, u equals 1 over d as usual. And, of course, we also have our usual cash account which pays a gross risk-free rate of r in each period. Okay. So, consider now a forward contract on the stock that expires after n periods. And we're going to let G0, denote the t, the date t equals 0 price of the contract. Now, I have price, and in, in quotes here because there's often a lot of confusion over the word price. Because people sometimes think that if something is a price, then that is what you must pay to purchase the contract but, of course, that is not true. G0 is chosen so that the contract is initially worth zero. So therefore, when you buy a forward contract, no money changes hands, in fact, the initial value of the forward contract is zero. The so-called forward price, here, G0, is just used to determine the payoff at the maturity of the forward contract. There's also a similar situation with futures, which we'll discuss when we come to the pricing of futures in the binomial model, in a few moments time. Okay. So, back to the forward contract. G0 is the price of the contract, but actually, the value of the contract, when we enter into it, is 0. So, using risk-neutral pricing, the initial value of the contract is zero. That's how much we must if we buy this forward contract. We get nothing until time n, and at that point, we get Sn minus G0, this is the payoff of the forward contract. So therefore, risk-neutral pricing says that 0 is equal to the expected value using the risk mutual probabilities of the payoff discounted and the discount factors are to the power of n. So, this is simply, risk-neutral pricing. Okay. Now, what we must do, is we need to figure out, what is G0. That's the goal here, to figure out the fair value of G0. We will do this by just looking at this equation. We notice, first of all that Rn, is a constant, okay, the gross risk-free rate is a constant so it comes outside the expectation. And so, we actually just get 0 equals the expected value of Sn minus G0. Remember G0 is also a constant, it's chosen at time 0. So, it is not a random quantity, so we don't have an expectation around it. So, of course, this implies G0 is equal to this. And this is the forward price of the contract. Okay. And 10 holds whether or not the underlying security pays dividends. We've now discussed dividends in the context of the binomial model. We didn't mention dividends at all here. But, in fact, dividends can be president, present in the model and this is still the correct price. The only point where dividends will enter is in G, okay? If you remember, the risk-neutral probability is Q, alright, given to us by, it's going to be R minus d minus c divided by u minus d, okay? And so, if the security, if the underlying security pays dividends, well, this is going to enter into the risk-neutral probability. It will lower the probability, the risk-neutral probability of up moves, and make the forward contract a little cheaper than, would otherwise be the case, okay? And we'll make the forward contract a little cheaper than would be the case if dividends were not present. Okay. Futures. Consider now a futures contract on the stock that expires after n periods, okay? Let Ft denote the date t price of the futures contract, and again, I put price in quotes because Ft isn't the value of the futures contract, alright? If we enter into a futures contract at any time, it actually costs nothing. The fair value of a futures contract at any time is actually zero, okay? So, as was the case with the forward contract, this futures price is really used to determine the payoffs of owning the futures contract. So, we'll come to that in a moment when we actually price the futures contract. Okay. So, the futures contract expires after n periods. So therefore, we know Fn equals Sn. This is almost by definition. These would be the terms of the futures contract. It expires at time n and according to the rules of the contract, Fn is equal to Sn. So, this must be the case. Okay. So, as I mentioned earlier, a common misconception is that Ft is how much you must pay at time t to buy one contract or how much you receive if you sell one contract. This is false. A futures contract always costs nothing. The price Ft is only used to determine the cash flow associated with holding the contract. So, that plus or minus Ft minus Ft minus 1 is the payoff received at time t from a long or short position of one contract held between times t minus 1 and t. So, it will be plus Ft minus Ft minus 1, if we were long or we owned one futures contract. And it would be minus if we were short or we had sold one futures contract between times t minus 1 and t. So, in fact, some people will often characterize a futures contract as follows. They will say that a futures contract is a security that is always worth 0, but that pays a dividend, I should put quotes here, it's not a dividend like the dividend you get from a stock. So, it pays a dividend of Ft minus Ft minus 1 at each time t. And, of course, this quantity here can be greater than or equal to 0 like the regular dividend, but it can also be less than 0, okay? So, you can think of a futures contract, as being a security that's always worth 0. After all, it never costs you anything to purchase or sell a futures contract, but it does create a stream of payoffs afterwards, and these payoffs can be thought as dividends, or generalized dividends, and these dividends are given to us by this quantity here. Okay. How do we price a futures contract in the binomial model? Well, we're going to work backwards from, from time n, the maturity of the futures contract. So, we know it costs nothing to enter into a futures contract at time n minus 1. So, 0 is the initial value of the futures contract. As I said in the previous slide, the futures contract is always worth zero. So, using the one period risk-neutral pricing, that's all we're using here, one period risk-neutral pricing says, 0 is equal to the payoff of the futures contract at maturity, which is time n. And that payoff is Fn minus Fn minus 1. We discount by R, and we see 0 equals this using the risk-neutral probabilities. Okay. From this, we get Fn minus 1 is equal to the expected value of Fn using the risk-neutral probabilities and conditioning and time and minus one information. This follows because R is a constant so it comes outside and it disappears and Fn minus 1 is known to us at time n minus 1. So, in fact, Fn minus 1 doesn't need an expectation around it at all. So therefore, we have Fn minus 1, equals the expected value of the futures price, one period ahead, using the risk mutual probabilities. We can generalize this to any time t and t plus 1, and get the exact same relationship, using the exact same argument to get this relationship here. Okay. So, this is the relationship for general t, okay? Now, we can also recognize the fact that Ft plus 1, is equal to the expected value at time t plus 1 of Ft plus 2. That's just using this relationship, but taking t equal to t plus 1 inside here, we get this. So, we can substitute this in for t, Ft plus 1, to get this quantity here, and we can keep doing the same thing. We know Ft plus 2 is equal to the expected value at time t plus 2 of Ft plus 3, we can substitute that in for Ft plus 2 and so on and we get to this point up here. Then, we can use what's called the law of iterated expectations and the law of iterated expectations just tells us that we can collapse all of these expectations just into the expected value of time t under Q of Fn, okay? So, that's what the law of iterated expectations tells us. You should be familiar from this from some of your probability courses. If not, you don't have to worry about it. We're not going to be using it too much during this course and it certainly won't appear in any of the assignments. Okay. So, the law of iterated expectations tell us that Ft equals the expected value of Fn condition in time t information using the risk-neutral probabilities Q. So, in fact, Ft is what's called a Q-martingale. And indeed, we've recorded an additional module, which introduces us to martingales, and that module can be found on the course website, as well, if you're not familiar with the idea of a martingale. Okay. So, we can take t equal to 0, recognize the fact that Fn equals Sn by the definition of the futures contract. So therefore, we find F0 equals the expected value of Sn at time 0, using the risk-neutral probabilities. And again, this holds, irrespective of whether or not the security pays dividends, the dividends would only enter into the calculation of the risk-neutral probabilities, Q, as I mentioned a few moments ago. What's interesting to ask this point is, are the forwards and futures prices equal? And yes, they are. You can see this expression in 11 is identical to the expression we have in 10 as well. So, even though they're different contracts, the futures marks to market everyday, there's a payoff everyday, that, that dividend payoff we spoke about, whereas, the forward contract pays nothing everyday until the maturity, they we actually have the same price. F0 equals E0 of Sn, using the risk-neutral probabilities, Q. This is not true in general. It's only true in the binomial model and other certain types of models. The reason it holds true here, in fact, is if you were to go back and look at these slides, you'll see one of the reasons it's true is when interests rates are deterministic. So, interest rates are deterministic, so we have to take this R outside and go through the rest of the analysis and see that we got the futures price equal to the forward price. In general, interest rates are actually random. They move about through time and as a result, you wouldn't be able to take this Rn outside and so in models of models that have random interest rates, you would find the futures prices and forward prices are not identical. They would be very similar, but they wouldn't be identical.

### 019. The Black-Scholes Model

>> In this module we're going to briefly discuss the Black-Scholes formula. The Black-Scholes formula is of great significance. Its used awful lot in industry, and indeed we can view the binomial model as an approximation to the Black-Scholes formula. Black and Scholes assumed a continuously compounded interest rate of R, so that $1 invested in the cash account at time 0 would be worth E to the R-T dollars at time T. They also assumed Geometric Brownian motion dynamics for the stock price, so that the stock price at time little t, is equal to the initial stock price times the exponential at this quantity here where wt is a standard Brownian motion. And for those of you who are interested we have recorded separate modules on both Brownian motion and Geometric Brownian motion; These modules are available on the course website. They also assumed that the stock pays a dividend yield of c. They assumed continuous trading with no transactions cost. And they also assumed that short selling was allowed. So here are some sample paths of Geometric Brownian motion. They look quite similar to sample paths of Brownian Motion actually. You can see that the stock price never jumps here. So at no point you see the stock price, say jumping from here down to here. So that's a property of Brownian Motion and Geometric Brownian Motion. The sample paths are actually continues. Given the assumptions that Black and Scholes made and that we listed two slides ago, they succeeded in deriving the price for European coal option, with strike k and maturity t. It is given to us by this quantity here. It's a somewhat complicated looking formula, but it's easy to code up, and it is used everywhere in industry today. The interesting thing to note about this formula is that, mu, which was the drift of the Geometric Brownian motion two slides ago. So recall, we assumed a drift of mu here. Well, if you notice, over in the Black-Scholes formula, mu does not appear anywhere. And this is similar to the fact that p, did not appear in the option pricing formulas we derived in the context of the binomial model. We'll return to that in a moment. So European put option prices, p zero, can then be calculated from put call parity. So once we have the call option price up here, we can price put options. In other words, we can derive P0 using put call parity here. And this is the version of put call parity that applies when we have a dividend yield. Black and Scholes obtained their formula using a similar replicating strategy argument to the one that we used for the binomial model. In fact you can show that under the Black-Scholes Geometric Brownian motion model, that we can write the price of the option C0, as being the expected discounted pay off of the option using risk-neutral probabilities Q. This is exactly the same formula we have for the binomial model. In this case however, in the continuous time model of Geometric Brownian motion, under Q we assume that the stock price is given to us by this here and the only difference between this expression for St and the expression we have for St at couple of slides ago. Which was mu minus sigma squared over 2 times T, plus sigma Wt is that we now have a factor r minus c appearing here, which we don't have down here. And the true drift of the Geometric Brownian motion mu, no longer appears in the option pricing formula. This is exactly analogous to the fact that we use the risk mutual probabilities Q and not the true probabilities P when we are pricing options in the binomial model. So in fact, if you evaluate this rate this expectation, assuming St is equal to this, you'll get the Black-Scholes formula. And for those of you who are interested, it's actually not very difficult to do this, it involves an integral of a log normal distribution. St here will have a log normal distribution, so one can actually evaluate this, do some integration and actually get the Black-Scholes formula that we showed on the previous slide. The Black-Scholes formula is used a great deal in industry, in fact it is the way in which option prices are actually quoted by industry practitioners. The binomial model is often used as an approximation to the Black-Scholes model, in which case one needs to translate the Black-Scholes parameters R sigma and so on, into R familiar binomial model parameters. This is often referred to as the calibration of a Binomial Model, so suppose we are given some Black Scholes parameters we have R and we have Sigma, and if you notice over here that's all we need, we have R we have Sigma, we also have c of course. I'm going to see how to calibrate these and rewrite these parameters in our binomial model. So what we will do is, we will write rn and now we're going to have subscript n here to denote the fact that these parameters in the binomial model, will depend on the number of periods that we're using in the binomial model. So recall, if t is the maturity, of the option, then t is equal to n times delta-t where delta-t is the length of a period, In the binomial model. Okay, so we're going to assume that rn is equal to e to the rt over n, Where n is the number of periods, as we said. We'll assume that rn minus cn. So this is rn minus c in the binomial model will be equal to e to the r minus c times t over n. And a simple first order taylor expansion will tell you that this is approximately equal to 1 plus r t over n minus c t over n. So this of course, Is like our R factor, and this is our C factor, in the binomial model. We'll set U-n equal to this, and D n equal to 1 over u-n. And now we can price European and American options, and futures, and so on, as before, in the binomial model using these parameters. The risk mutual para-, probabilities, will be calculated as, q subscript n. Again, recognize the dependence of our paremeters on n, the number of periods. So q subscript n will be equal to this here. And using this approximation, we can see that this is approximately equal to our rn minus cn minus dn, divided by un minus dn. So this the representation of the risk mutual probabilities that we saw before in the binomial model. We're actually going to use this in our binomial model now, when we're deriving our parameters from a Geometric Brownian motion and the Black-Scholes Formula. So our spreadsheet, will actually calculate binomial parameters, in this way. I mentioned at the beginning of the module, that the binomial model can be viewed as an approximation to geometric Brownian motion, This is true, as delta t, the length of a period Goes to zero. I'm just going to spend a couple of moments describing how you might go about showing this. We certainly won't go through all the calculations, but I'll do the first couple of steps of these calculations. Recall that we can calculate European option prices with strike k, according to this expression here. So this is the expression we had in our binomial model. C0 equals the discount factor times the expected pay-off of the option, using the risk neutral probabilities Q. Well, if you recall, we also saw that we can write this expression, as we have written here, so these are the binomial probabilities. Okay, so this here, is equal to the probability inner binomial model of j upmoves, and n minus j down-moves. And this then is St, the terminal stock price, after the j up-moves and n minus j down-moves. So therefore this here, is the expected value of the pay-off of the option. So what you can do is, we can actually replace the summation which runs from j equals zero, to run from j equals let's call it etta, say. Where etta is the minimum j, such that the stock price again this is St, after j up moves and n minus j down-moves. So 8 is the minimum number of up-moves required to ensure that the stock price, is greater than or equal to k. In that case, this maximum will always occur in the first argument here. So we can remove the max, remove the 0 And just substitute this expression in here, inside the summation, and then we can split the summation up into two components as we've done here. So, what you have is, we can rewrite, in the binomial model, we can write c0, the initial value of the option, as being equal to s0 times some quantity minus k times some quantity. And if you recall, that's exactly what you had in our expression for the black Black-Scholes we, we had s0 times some quantity, minus K times some quantity. What you can do, and we won't do it, but you can show that if n goes to infinity, or equivalently, if delta-t goes to 0, remember capital T is fixed, so if in goes to infinity, delta-t goes to 0. You can show that if n goes to infinite, Then c0, as we have here, will actually converge to the Black-Sholes formula. Very briefly there is some great history associated with the modeling of Brownian motion and Geometric Brownian motion, Stochastic calculus and finance in the pricing of options. There are many famous names, both mathematicians and economists, who are associated with this history, you might want to take a look at some of these names in your spare time. I'll just throw out a couple of very interesting people. Bachelier, back in 1900, was perhaps the first to model Brownian motion, he was attempting to do so, with a view to pricing options on the Paris stock exchange. Another fascinating person, is Doeblin, another French mathematician, whose work was only recently Discovered. He was actually very involved in the development of Stochastic calculus, but his work wasn't discovered until very recently, as he died in World War 2 before his work could be read. Another very influential person or fascinating person is Ed Thorp! Ed Thorp is famous for card counting and showing that you can actually card count and beat the system in Las Vegas. After he was thrown out of Vegas, apparently he started trading options and may well have been the first person to actually discover and use the Black-Scholes formula. He didn't actually prove it was true, he didn't have a model which derived the Black-Scholes formula, but it seems like he somehow intuited that, that might have been the correct formula for pricing options. And there's a host of other interesting names here, that are well worth exploring.

## 010.An Example  Pricing a European Put on a Futures Contract

### 020. An Example  Pricing a European Put on a Futures Contract

>> In this module we're going to go through an example very quickly where we price a European put on a futures contract. Up until now we've seen how to price European and American options on the underlying security. Very often in fact though we want to price options on futures contracts, which are written on the underlying security. So in fact many of the most liquid options are options on futures contracts. They include for example the S & P 500 index in the US, the Eurostoxx 50 index in the Euro zone, the FTSE 100 from the UK and the Nikei 225 from Japan. In these cases, the underlying security is not actually traded, that is because if you wanted to actually trade the S & P 500 we would need to trade 500 different stocks. Now it would be very expensive and time consuming. So generally we don't trade these indices, we trade futures on these indices. So what we're going to do is we're going to price a European put on a futures contract. So consider the following parameters, we're going to assume the initial stock price or in this case the initial index price is 100. We'll assume n equals 10 periods. We will assume a risk free rate of 2%, a dividend yield of 1% and a sigma of 20%. We're going to assume that the futures expiration and the option expiration coincide and are equal to 0.5 years. In practice this is what typically happens. But of course, for more theory, we could if we like, still price options where the futures expiration was greater than the option expiration. We'll be able to obtain the futures price lattice on our spreadsheet, by using the fact that s n equals f n, and then using the fact for t less than n, f t is equal to the expected value of f t plus 1, using the risk mutual probabilities. When we do that, we'll see that we get a put option value of 5.21. So let's go to the spreadsheet and see what we get. So here are our initial parameters. We've an initial price of 100, t equals 0.5 years or 6 months. Sigma equals 20%. We're assuming 10 periods and or, we have our r and dividend yield as well. So u, d and q are calculated as we showed in an earlier module where we used the binomial model to approximate geometric boundary in motion and the Black Shoals Model. So our futures parameters, we're assuming an expiration of t equals 10. So 10 time periods corresponding with 6 months, or half a year. Over here we can choose what sort of option we want to price. 1 for a call, minus 1 for a put. We're assuming a strike of 100, and the expiration, again, is going to be 10 periods. So the option expiration coincides with the futures expiration. It's going to be a European option. So here we have our lattice, or stock-price lattice. In each time period, the stock price grows by a factor of u, or it falls by a factor of d. If we scroll down, we have the futures lattice. And in this case, we can see, well, by definition, f n equals s n at time n. So we see that the futures prices in here are time t equals 10, agree with the stock prices up here, at time t equals 10. We then work backwards in this lattice, calculating the futures prices using that formula we showed on this last slide. Okay. So now, we have our futures price lattice. We can now price our options, by simply calculating the payoff of the option at time t equals 10, the expiration. So in this case it's a put option with strike 100. So when the stock price is greater than 100, the payoff is 0. When it is less than 100, we get a payoff of 100 minus the stock price. So that gives us these values here, and then we can calculate the option by working backwards in the binomial lattice as we've seen before. In this case, we find the put option value is equal to $5.212. It's worth making a point about how these models are used in practice. In practice, we don't need a model to price liquid options. Market forces, i.e., supply and demand, actually determines the price of options. In this case, this amounts to determining , or the implied volatility. And that is because, if you recall, so the price of a call options c 0 is equal to the expected value at time 0, using our risk-neutral probabilities of e to the minus r t times s t minus k, the positive part, or if you like this is, equal to, the maximum, of s t minus k and 0. Where under the BlackScholes Model s t equals s 0 e to the r minus sigma squared over 2 times t. Plus sigma, w t. W t here is your standard Brownian motion. So w T is a random variable that's got a normal distribution between 0 and variance t. Anyway, given all of this we recognize that c 0 is equal to some function of the initial stock price, the risk free rate, the dividend yield, and I should have included the dividend yield up there. Sigma, the time to maturity, and k. And in fact we actually know all of these quantities. We can see them all in the market place. We know what s 0 is, we know what r is we know what the dividend yield is, we know what the maturity of the option is and we know what the strike of the option is. The only thing we don't know is sigma. However in the case of liquid options, we can actually observe c 0 the price of the option in the market place. As I said supply and demand is what really sets the price of the liquid options in the market place. So we can see c 0 and then we can use this equation to back out the one unknown, which is sigma. And then this is often called the implied volatility. And we'll be returning to this later in the course as well. So at this point you might ask if that's the case, if supply and demand sets the price of options, why do we need a model? Well we need models for two reasons. One is to help us price what are called exotic or more illiquid derivative securities whose prices are not available in the marketplace. We can also use models to hedge options. And I'll return to hedging later in the course as well.

## 011.Introduction to Term Structure Lattice Models and the Cash Account

### 021. Introduction to Term Structure Lattice Models

In this section and the next sequence of modules we are going to discuss fix income derivative pricing in the context of term structure lattice models. We are going to see how the philosophy behind fix income derivative pricing is different to the philosophy behind the binomial model and pricing equity derivative. Fix income markets are enormous and in fact they are bigger than equity markets. According to SIFMA, in Q3 2012, the total outstanding amount of US bonds was $35.3 trillion. In comparison, the size of the US equity markets was only approximately $26 trillion in comparison. Fixed income derivatives markets are also enormous, they include interest-rate and bond derivatives. Credit derivatives, mortgage backed securities. And asset back securities, more generally in this section, we're going to be focusing mainly on interest rate and bond derivatives. And we're going to use binomial lattice models to understand these securities. The mechanics of these securities, and also how to price them using risk neutral pricing. The slides and excel spreadsheets should be sufficient. But chapter 14 of the Lunberger text is also an excellent reference for the material in this section. We're going to use binomial lattice models as a vehicle for introducing both the mechanics of fixed income derivative securities as well as the philosophy behind fixed income derivatives pricing. We'll talk more about the philosophy soon. But let's look at some of the most important derivative fixed income securities. We're going to talk about bond futures and also forwards. We'll also talk about caplets and cap, floorlets and floors, and swaps and swaptions. Now I should mention at this point that Lipor rates are the interest rates, that underlie these securities here. Whereas, these securities typically have government rates underlying them. And so these are different interest rates, but we're not going to make that distinction here in these modules. We're going to assume that it's the same underlying rates. And the reasons for doing this are two-fold. We want to focus mainly on the mechanics of these securities, how they work and how they're priced. We're going to price them using risk neutral pricing. And it would only distract us if we had to focus on different interest rates when we were pricing different securities. Now fixed-income models are inherently more complex than security models. The problem with fixed-income models is that we need to model the evolution of the entire term structure of interest rates. So, for example, let's come down here and let's see a little plot of the term structure of interest rates. So we have time, t, here and we have st here. St is going to stand for the spot rate, spot interest rate at time T. And maybe you've got some function like this. So this tells us what the time structure of interest rates look like. So for example, if this is t1, then we have, over there, and that's St1. And St1 is then the spot interest rate that applies to borrowing or lending at the time t one. So when we want to build a fixed income model or term, term structure model. We need a model which will, which will model how this entire curves moves through time, note the distinction. When we have a model for stock prices, we just need to model the evolution of a single stock. A scale of random variable, here we need to model the entire evolution of this term structure. And so term structure models are inherently more complicated. But actually we're going to see there's some easy ways to get around this problem. One of the classical ways to get around this problem is to focus on what's called the short-rate. The short-rate, r little t, is the variable of interests and many fixed income models, including binomial lattice models. It is the risk-free rate that applies between periods t, and t plus 1. So r of t is going to be the risk-free rate that applies from period t out to period t plus 1. It's a random process, R is random. Remember, interest rates in the real world are random, and so this short rate will also be random. However, rt is known to us by time t. So at time t, we know. What we're going to get at time t plus 1 if we deposit $1 in the bank account at time t. What about the philosophy of fixed income derivatives pricing? Well, what we're going to do here is as follows. We will simply specify risk mutual probabilities for the short rate r of t, and we will do this without any reference whatsoever to the true probabilities of the short rate. This is in contrast to the binomial model for stocks where we specified p and 1 minus p and then used replication arguments to get q and 1 minus q, the risk neutral probabilities. What we're going to do is we're going to price securities, fixed income derivatives, in such a way that guarantees no arbitrage. We're going to match the market prices of liquid securities via a calibration procedure. This is often the most challenging part of the entire exercise. And we will see that derivatives pricing in practice is really about extrapolating from liquid security prices to illiquid security prices. So just summarizing here the philosophy of fixed income derivatives pricing is not to focus on the true probabilities but to go directly to risk neutral probabilities. Do your pricing in such a way that guarantees no arbitrage. Once you do that we'll then pick the unknown parameters in the model, so that the model prices will match market prices. That's the calibration exercise, and that is how we would price fixed income derivatives in practice. So here's an example of a binomial model for the short rate. We're actually going to be using binomial models throughout these modules on term structure modeling, and fixed income derivatives pricing. We have time as usual, down here t equals 0, t equals 1, and so on. We're going to use the notation rij to specify the short rate at node Nij. So, for example, this point here is node N22. So rij, i refers to time, and j refers to the state. So we're going to number the states from 0, 1, 2 and so on. So what we have here is the binomial model for the short rate. We're going to take 0 coupon bond prizes and we're going to use zcb as a shorthand for 0 coupon bond, throughout. We'll take 0 coupon bond prices to be our basic securities. We will use the notation Z subscript i,j superscript k to denote the time i state j price of a zero coupon bonds that matures at time k. Now its important to get comfortable and familiar with this notation. So again Zijk, its the time i state j price of a zero coupon bond that matures at time k. So for example, if met this point here. Then this z213 is the price, at time 2 state 1 up here of a zero coupon bond that matures at time 3 which is here. What we would like to do is we would like to specify binomial model by specifying all the Zijks at all nodes. Now this is possible, but it's actually very awkward if you want to insure no arbitrage. Moving on more generally, we're going to let Zij be the date i, state, j, price of some non-coupon paying security. And what we're going to do, is we're going to use risk neutral pricing to price every security, every sub security. So for example, let qu and qd be the probability of an up move and a down move. Of course here a down move more, looks more like an across move, but we'll still stick with qu and qd. So we're going to assume that qu and qd are given to us, and we know them at every node. So at every node, qu is the same, qd is the same at every node and of course qu plus qd equals 1 and they're both strictly greater than 0. So what we'll do is we will use risk mutual processing to price every security. So for example, Zij this is the price of the security at time i state j, is going to be 1 over the discount factor times the probability, risk [inaudible] probability of an up move, in which case we have the price at times i plus 1 and state j plus 1 plus the risk neutral probability with down move times the price of the security its in time i plus 1 state j. So if we price every non-coupon paying security like this there can be arbitrage when we priced using 1 and very loosely when we're trying to this in the next slide but very loosely the reason is as follows. If you recall it's not possible for example for this to be greater than or equal to 0, and this to be greater than or equal to 0 and yet have this be less than 0, why? Well qu and qd are both strictly positive. So if qu and qd are strictly positive and the interest rate is strictly positive, the short rate which would always be the case, then you cannot have this being the case. And this being less than zero, so it's not possible to construct arbitrages when we price like this. More generally, if the security pays the coupon, c i plus 1 comma j, at date i plus 1 and state j, then we have the following from risk neutral pricing again: zed i j is equal to this quantity on the right hand side, where Zi plus 1 dot. So this dot here means it can take on the value j plus 1, or j as we see here. So, if we price our coupon paying security according to this, then again we'll see that there can not be any arbitrage. And the reason is as follows. If you recall the definition of our type a arbitrage. So, a type A arbitrage goes as follows. So, we have some security or portfolio whose initial value was less than 0 and whose final value v1 is greater than or equal to 0. Well, we see that this is not possible here. So, for the same reason i gave in the previous slide, this would be our v1, so these are the two possible values of v1. So v1 in this state j plus 1 is greater than or equal to 0. And v1 in this state of j is greater than or equal to 0. Then Zi plus Zij must also be greater than or equal to 0. So this is not possible. Similarly, what we have for type b arbitrage, if you recall. So a type b arbitrage was one where v0 was less that or equal to zero. And v1 was greater than or equal to zero, But v1 was not equal to zero. So in this case what would we have? We would have the following. Let's just erase some of this here. So for type B arbitrage we would have say that v1 is greater than or equal to zero. And say v1 over in this state j is strictly greater than zero. And that this must actually be less than or equal to zero. Well again this isn't possible, qu and qd are both strictly positive. So if all of this is greater than or equal to zero, then qu times this is greater than or equal to zero, and qd times this is strictly greater than zero. So Zij must be strictly greater than zero. This situation's not possible. So again, we see that a type B arbitrage is not possible when we price like this. Now, before continuing I just want to mention one other item. That is I'm losing, I'm using the word coupon very loosely. Obviously it, it denotes the idea of a bond, and the coupon one gets more bond. But it could be the cash flow from a swap. The fixed rate minus the floating rate cash flow for example. So I'm going to use the word coupon to denote any intermediate cash flow throughout these modules.

### 022. The Cash Account and Pricing Zero-Coupon Bonds

In this module we're going to discuss the cash account and the pricing of zero coupon bonds in the context of the binomial model for the short rate. The cash account and zero coupon bonds are extremely important securities and derivatives pricing in general and so we're going to spend some time now figuring out how to price them and understand the mechanics of these securities. >> So let's get started. If you recall this is our binomial lattice model for the short rate. Ri is the Short- Rate that applies for lending between times i out to i plus 1. In general it's a random variable because it can take on any of these values for example at time 2. So time t equals 2 the short rate or 2 could take on this value at state 0, this value at state 1 or this value at state 2. We also have our risk-neutral probabilities q u and q d, and of course, q u plus q d must sum to 1. These are our risk-neutral probabilities, so they're strictly positive, and what we will do is we price everything with these risk-neutral probabilities. In particular, for example, if we want to price a non coupon paying security, and I use the term, non coupon here loosely. So, a coupon could refer to any cash flow. So if we want to price in non coupon paying security at time i, state j. Well, we just do our usual discounted risk-neutral pricing. So Zij, the value of the security at time i state j, is one over one plus the short-rated time i state j, times the expected value of the security one period ahead, where we take that expected value with respect to the risk-neutral probabilities qu and qd. Now as we said as well before, there can be no arbitrage when we price using three. And the reason for that is as follows; If you recall our definition of a type a arbitrage, for example. So a type a arbitrage was a security of the form v 0 being less than 0, and its value at time 1, v 1 must be greater than or equal to 0. So we said any security like this in the one period model constituted type a arbitrage. Well this is not possible over here if we price everything according to 3. And the reason is, so Z will take the place or r v here. We see that it is not possible for this to be greater than or equal to 0, and this to be greater than or equal to 0, and yet, have this being less than or equal to 0. This is not possible, because the q's and r are all strictly positive. And if the zeds are greater than or equal to 0, then this must be greater than or equal to 0 as well. So we actually cannot get a type a arbitrage. That's not possible. It's the same for a type b. If you recall, a type b arbitrage assumed a security of the following form, V0 less than or equal to 0, V1 greater than or equal to 0, but V1 not equal to 0. Which means that V1 is greater than or equal to 0 in all states and is at least one state where it's actually strictly greater than 0. Well, again, the exact same argument over here would show that, that is not possible as well. So there can be no arbitrage when we price according to 3. I now want to talk a little bit about The Cash-Account. The Cash-Account is a particular security that in each period earns interest at the short rate. We're going to use bt to denote the value of the cash account at time t and we would be assuming without loss of generality that it starts off with a value of 1, so b 0 is equal to 1. The Cash Account is not risk free. And the reason it's not risk free is because interest rates are uncertain, they're stochastic. In particular the value of the Cash Account at the time t plus s say, is not known at time t for any value that's greater than 1. However, it is locally risk-free because I do know the value of B t plus 1 at time t. In fact, B t plus 1 will always be equal to B t times 1 plus the short rate. And I'm going to know the short rate at time t and therefore I will know B t plus 1 at time t. So again think of your bank account analogy. If I deposit money today for one month, I know what rate will apply for that one month period and so I will know how much I will get at the end of the month. But I will not know what interest rate will prevail in one months' time and therefore will not know future values of The Cash-Account beyond one month. So a quick thing to notice here, so Bt therefore has this expression here, based on the argument I just gave you, I can look at Bt plus 1 Bt and divide 1 by the other and see that I get one over 1 plus rt. And the reason I want that expression is down here, I want to derive equation four here. So how do I derive equation four? Well, again, for a non-coupon paying security, zt times z at time t, state j is equal to 1 over 1 plus rtj times the expected value of the security one period from now. So this is our familiar risk neutral pricing expression from the previous slide. I can actually rewrite this expression as the expected value under q, remember q is equal to q u and q d, the risk-neutral probabilities. And I can replace my 1 over 1 plus rtj, with this expression here bt over bt plus 1. So therefore I can write the value of the non-coupon paying security at time t as being the expected value at time t under q. On Z t plus one, multiplied by B t over B t plus one. So rewriting equation four, I can just bring the B t over to the left hand side and I get this expression here. This is an important expression but I can go a little bit further. I can actually iterate it to get the following. So for example, I can write Zt over Bt is equal to Et. Under q of, well we know it's zed t plus 1 over bt plus 1, but I can actually use this equation 5 again to write zed t plus 1 over bt plus 1 as the expected value under q. Condition on time t plus 1 information of Zt plus 2 over Bt plus 2. And using the law of iterated expectations, this is equal to the expected value condition on time t information of Zt plus 2 over Bt plus 2. And I could repeat the same trick again and again. And so, it's easy to see that this condition is hold. So this is our risk neutral pricing condition, for a non-coupon or non-dividend paying security. In particular, it's the pricing equation that we use for any security that does not pay any intermediate cash flows between times t and t plus s. When we're doing risk-neutral pricing for a coupon paying security, we use the exact same idea, so Ztj equals 1 over 1 plus Rtj times the expected value under q of the value of the security plus the cash flow at time t plus 1 that just gives us this expression here. And for the same reason as before, we can see as long as we price any coupon-paying security this way that cannot be an arbitrage. There is now way that this quantity can be greater than or equal to 0 and yet to have Ztj being less than 0. So you couldn't have a type A arbitrage because if this is greater than or equal to 0 there is neutral probabilities we know are strictly greater than 0, this is greater than 0 and so all of this expectation must be greater than or equal to 0. So in particular this is not possible. So you couldn't get a type A arbitrage, and for the same reason, you couldn't get a type B arbitrage as well. Alright, so we have seven. Well, it's easy to rewrite seven using the same ideas we used in the previous slide. I can replace 1 over 1 plus RTJ with Bt over Bt plus 1, bring the Bt over to the other side, and I get Expression eight. Now I can iterate, I can substitute in for example, if I substitute in the following; I know that Zt plus Bt plus 1 is equal to the expected value under q conditional on time t plus one information. Ct plus 2 over Bt plus 2. Plus Zt plus 2 over Bt plus 2. So if I substitute that in down here, I'm going to get this expression here when s equals 2. Now it's easy to see that this expression holds more generally for general values of s, or for integer values of s greater than t. So this is an extremely important condition. We're going to use this throughout this section on term-structure models and pricing fixed-income derivatives that tells us how to price fixed-income derivatives using risk-neutral pricing and this ensures that there's no arbitrage. In other words, it ensures that we're pricing fixed-income derivatives in a manner which is consistent with no arbitrage. Note also that equation six is actually a special case of nine, because we get equation six From nine by just taking all of these cjs equal to 0. So this is an extremely important result, it guarantees that we can price everything with no arbitrage. Here is a sample short-rate lattice. It starts off with the short rate r00 being equal to 6%. And then the short rate will grow by a factor of u equals 1.25 or fall by a factor of d equals 0.9 in each period. It's not very realistic. These interest rates, as you can see, grow quite large here. And given the current economy, global economy, where interest rates are very low. This example wouldn't be very realistic. But it is more than sufficient for our purposes. In fact, it's good to have such a wide range of possible interest rates. As it makes it easier to distinguish them in the examples that we'll see in the future. At this point I should also mention. That you should look at the spreadsheet that is associated with these modules. The spreadsheet you'll see this particular example there. And we're going to be using this example throughout this section to price various types of fixed income derivatives. We're going to be looking at caps, floors, swaptions. Options on zero coupon bonds and so on. So we're going to use this particular short rate example as our model in all of these pricing examples. So the first thing we're going to do is we're going to see how to price a zero coupon bond that matures a time t equal to 4. So if we want to do that we're going to use our risk neutral pricing, our risk neutral pricing result If you recall, states that Zt over Bt is equal to the expected value conditional on time t information of Zt plus 1 over BT plus 1, and this is a risk-neutral pricing identity for securities that do not pay coupons or do not have intermediate cash flows. And certainly that is true of a zero coupon bond. If you recall, a zero coupon bond does not have any intermediate cash flows. It only pays off its face value at maturity. And this example matures at t equal to 4. This face value is 100 and this indeed is if you like using our notation for 0 zero coupon bonds Z44. So what we're going to do is we're going to bond rate the price to zero coupon bond is to use this expression here by just working backwards in the lattice 1 period at a time. We know Z44, it's 100. At maturity the, the bond is worth 100, so let's work back and compute its value at time t equals 3. Well, to do that, we can just use this expression. Another way of saying this, and we saw this as well before, this is equivalent to saying that Zt Is equal to the expected value time t of Zt plus 1 over 1 plus or t. And so in fact it's this version that we're going to use. We're going to work backwards computing the values t at every node by discounting and computing the expected value one period ahead so that's all we're doing here. So, for example, the 83.08 that we've highlighted here is equal to 1 over 1 plus the short rate value at that node, and if we go back one slide we'll see the short rate value at that node was 9.38%. So that's where the 0.0938 comes from here. And then it's the expected value under q of the value of the zero coupon bond one period ahead. There are two possible values, 89.51, 92.22 and that's what we have here. So we just work backwards in the lattice, one period at a time, until we get its value here at time 0 and this is Z04. The time 0 value of the zero coupon bond that matures the time 4. Having calculated the zero coupon bond price at time0, we can now infer from that the actual interest rate that corresponds to, to t equals 4. In particular if we assume part period compounding and we let S4 denote the, the interest rate that applies to borrowing or lending for four periods then we know that 77.22 times 1 plus S moved to the power of 4 must be equal to 100. So of course we can invert that to get that S4. Is equal to 100 over 77.22, all to the power of 1 quarter minus 1 and so that's how we get S4. So there's always a one to one correspondence between seeing the zero coupon bond prices, and seeing the corresponding interest rate. Therefore it means that we can actually compute all of the zero coupon bond prices for the four different maturities. So we can compute the zero coupon bond price for maturity t equals 1, t equals 2, 3, and 4. And from this we can actually back out, back out the actual interest rates that apply to these periods. So, for example, we will get a term structure of interest rates that looks like the following; We have t down here and we've got the spot rate St here and maybe we'll see something like the following or maybe it's an inverted curve but this point here, so for example t1, that point corresponds to there and it corresponds to some spot rate st1 there. So we can actually use this model to price all the zero coupon bonds. And from all of these zero coupon bond prices, we can invert the message in the previous slide to get the term structure. The term structure is the term structure of interest rates. We can see what interest rate applies to each time t. At time t equals 1, for example, we will then compute a new set of zero coupon bond prices, and obtain a new term structure. So for example at time t equals 0 were down here. But at time equals 1 may be I'm up in this state of the world. So if I'm up in this state of the world I could recompute the time structure of interest rates, I could do that by a pricing all of the zero coupon bonds at this point. I'm going to get a different set of prices at the set of prices ahead at time t equals 0 and I can invert this new set of prices to get the new time structure and may be that new time structure will look different, may be will look something like this. So I will get a new term structure times t equals 1, moreover the term structure I see will depend on whether I'm up here or down here. So what we've actually succeeded in doing is defining a stochastic model or a random model for the term structure of interest rates by just focusing on the short rate. So the short-rate or t is just a scalar random variable or scalar process by focusing on modeling this short rate, as we've done, we've actually succeeded in defining a stochastic or random model for the entire term structure. And that's actually a very significant point to keep in mind when working with these short-rate models.

## 012.Fixed Income Derivatives I

### 023. Fixed Income Derivatives  Options on Bonds

In the last module we saw how to price zero coupon bonds. In this module we're now going to go a step further and see how to price options on zero coupon bonds and options on bonds in general. We're going to discuss European and American column put options on zero coupon bonds and see that you can price these securities by just using risk- neutral pricing and working backwards in a binomial lattice model. So here is our sample Short Rate Lattice again. We introduced this in the last module and I mentioned that we're going to see this lattice throughout these examples. So, just to remind ourselves, we start off with r 0, 0 equals 6%. And then the interest rate grows by factor of 1.25, or it falls by a factor of 0.9 in each period. So this is a Short Rate Lattice. Remember, the short rate is the risk free interest rate that applies for borrowing or lending for the next period. What we're going to do is we're going to price an option on a zero coupon bond. The zero coupon bond we consider will be a zero coupon bond that matures at time t equals 4. And we actually considered this bond as well in the last module. So, in the last module, we saw how to price this zero coupon bond. If you recall, the way we priced it was, we said that at any time t, zt was equal to the expected value using the risk-neutral probabilities of zt plus 1 over 1 plus rt. And this is our risk-neutral pricing. So we started off at time t equals 4. Where we know the value of the zero coupon bond at this period, z subscript 4 superscript 4, it's equal to the maturity of the bond. So you got a face value of 100 dollars back at that period. And then you just work backwards in the lattice using this expression here to compute the value in the previous period. So we start off here with 100. We come back here and we work backwards. We said for example, the value of 83.08 at this node is given to us by 1 over 1 plus the short rate to the product of this node which is 9.38%. Times the expected value of the zero coupon bond one period ahead. And one period ahead was either 89.51 or 92.22. So we work backwards and we get a price of 77.22. And that's equal to the zero coupon bond price at time 0 for maturity t equals 4. More generally, of course, we could have priced this bond as follows. We could have said, we know from our risk-neutral pricing, we could have said Z, Z0 over B0 equals the expected value times 0 using the risk-neutral probabilities of Z4, 4 over B4. So if we recall, this is our risk-neutral pricing expression for any security that did not have intermediate cash flows. And certainly a zero coupon bond is such a security. We know that B0 equals 1. So in fact we would just get that Z04 is equal to the expected value at time 0 of Z 4, 4 over B4. So this translates to Z04 equals the expected value of 100 divided by B4. And so we could have actually calculated the zero coupon bond price at time 0 just using this expression and just ca, doing one single calculation instead of working backwards period by period, we could've done it all in one step by evaluating this and figuring out the probabilities of the various values before and summing these quantities appropriately weighted by those probabilities. So let's get to pricing a European Call Option on this zero coupon bond. The maturity, the expiration of the option, would be t equals 2. We're going to assume a strike of $84. So therefore the option payoff would be the maximum 0 and Z24 minus 84. This little dot here I've used just to denote the fact that actually this is a random variable, it will depend on what state we're in, so for example the state at time 2 will either be 0, 1, or 2. So the underlying zero coupon bond matures at time t equals 4. So what we need to do is to figure out the value of this at time 2. But we've already done that in the previous slide. We know the option value at time equals 2 is given to us by these numbers here. The strike is 84, so in that case, if the strike is 84 we would not exercise here but we would exercise here and get $3.35 and we'd exercise here and get $6.64. And that's where these value come from here. So 0, 3.35 and 6.64 are the value of the option at expiration. So all we're going to do now is use our usual risk-neutral pricing. Risk-neutral pricing tells us how to evaluate this, so we can simply work backwards in the lattice one period of time to get the initial value of the option. So for example the 1.56 we see here is equal to 1 over 1 plus the interest rate that prevails at this node. That interest rate is given to us here at 7.5%. So we get 1 over 1 plus 0.75 times a half times 0 plus a half times 3.35 and that equals 1.56. And then after calculating that number and 4.74 down at this node, we go back to time t equals 0, and get the initial value of the option. We can see it's going to be 2.97. If we want to price an American option on the same zero coupon bond, we can do the exact same thing. The only difference being that at each node we stop to see whether or not it was optimal to early exercise at that note or not. So here's an example, this time the expiration is t equal to 3, it's going to be an American put option on the same zero coupon bond and it has the strike of $88. So if we go back to the zero coupon bond, price at t equals 3, well these are the prices at t equals 3. Now you can see that $88 is actually less than all of these prices. So in fact, at t equals 3 it would never be optimal to exercise because $88 is less, as I said, than all of these prices. So therefore, in fact, the payoff of the put option at maturity at t equals 3 is indeed 0. And that's why we have zeros all along here. So now we just work backwards in the ladders using our risk-neutral pricing as usual, but also checking in each period whether or not it is optimal to early exercise in that period. So for example, the 4.92 here is equal to the maximum of the value of exercising at that period 88 minus 83.04. Where does that 83.04 come from? Well, that's the value of the zero coupon bond, at that node at time 2. Here it is 83.08. So that's the value we get if we exercise then and then we alter to compare it to 1, with 1 over 1 plus 9.38%, the expected value under q, the value of the option one period ahead. Well the value of the option one period ahead, as we said, is 0, so therefore at this point the value of the option is 4.92. And in fact, we just worked backwards, doing that in every note. It turns out that in this example, it's optimal to early exercise everywhere, so it's a very realistic example, but that's fine. We just want to see the mechanism of how the American put option works and how we can use risk-neutral pricing to, to price it. So, here is the Excel spreadsheet. I hope you have this open with you when you're going through these, these video modules. Because you can see how to price all of the securities that we will discuss in the spreadsheet. So up here, we have the parameters of a binomial lattice model. And it begins at 6%, the short rate does, it grows by a fact of u equals 1.25 or falls by factor t equals 0.9, and the risk-neutral probabilities of 0.5 and 0.5. So what you can see here is the first lattice we've built is the short rate. It starts off at 6%, and then it grows by a certain amount, or falls by a certain amount. This cell is in bold because by getting the correct formula into this cell, I can actually copy this cell forward and across throughout the lattice to populate the rest of the cells. So this is our short rate. If I want to price the zero-coupon bond, I come over here. I know the value of the bond is 100 at maturity, which is why I have 100 in all of these cells. And then I want to apply risk-neutral pricing backwards in the, in the lattice. So here I've highlighted in bold this cell, because this is the cell where I entered the formula. And then I can drag and copy this formula back through the rest of the lattice to get the zero coupon bond prices every note. So I get the value of 77.2, which 77.22 we have seen before. Over here, down here I compute the price of the American zero, of the American option on the zero coupon bond. Over here, I compute the value of the European call option on the zero coupon bond. So you can see again, we've highlighted and bold the cells, the important cells we should input the Excel formula. Once you've got that in there, you can drag and copy that formula to the other cells. So this is the spreadsheet. We can see how to both construct the short rate lattice, price zero coupon bonds, and compute European and American option values on those zero coupon bonds.

### 024. Fixed Income Derivatives  Bond Forwards

In this module we're going to discuss how to pass forwards on bonds. We saw when we were discussing the binomial model for equities how to pass forward in that case. We'll now we're going to extend that case to passing forwards in bonds. In the next module will be after this one will discuss passing futures, and then will be able to see an example of where forward prices do not equal to futures prices. So here is our familiar short rate lattice, we've seen this now a few times. Short rate begins at 6%, grows by a factor of 1.25 or falls by a factor of 0.9 in each period. This is the short rate that we're using for pricing examples in these modules. So now we want to price the forward contract on a coupon bearing bond. We're going to assume delivery takes place at t equal to 4, and that the bond that's been delivered is a two year 10% coupon bearing bond. We assume delivery takes place just after a coupon has been paid. So how we going to price this? How we going to compute the forward value? Well, we're going to use risk neutral pricing and we're going to use what we know about risk neutral pricing. So, we know the following. For a generic security, let's say it's got price s at time t. We know the following. We know that S 0 over B 0 is equal to E 0 undercue of Sn over Bn, and this is risk neutral pricing, for any security that does not pay coupons or have an intermediate cash flow between times zero and n. So this is what we want to use to price our forward. How we going to go from here down to here? That's the question. Well, it's actually very simple. First of all remember we assume the B 0 is equal to $1.00. If it wasn't, if B 0 was $100.00 then B n would be B n times 100 and we could divide across by the 100 and get back to the case where B 0 equals $1.00. So there's no difficulty seeing that B 0 equals $1.00, assuming B 0 equals $1.00. Sn, this is the value of the forward contracted time n. Well what is the value of the forward contracted time n? Well it's this quantity here, it's Z 4 6 minus G 0. This if the payoff of the forward contract; it's the underlying security, which we're calling Z 4 6, minus the forward price, G 0. So this is assuming that somebody is long the forward contract. They're buying the security, they're buying it for G $0, and they're getting a security that's worth Z 4 6. So this is our Sn, B 4 is this quantity here, what about S 0 over B 0? Well we know B 0 is equal to one, what is S 0? Well if you recall how our forward contract works, it works as follows. We choose the forward price G 0, so that the initial value of the contract is zero. So actually S 0 is going to be equal to 0, and so we get this expression here. And now the goal here is to figure out, what the value of G 0 is that makes this true. Well, that's straight-forward. This equation implies that, the expected value, at times 0, of G 0 over B 4, is equal to the expected value at time 0 of Z 4 6 over B 4. As a brief aside, I'll mention, I know I've mentioned this notation a couple of modules ago where I said, we'd always use this notation to denote 0 coupon bond prices, but here we're going to use it to denote an actual coupon bearing bond price. So we get this expression here, but G 0 is a constant at time 0. I know it's value at time 0, so I can take this outside the Expecation, and I can then bring everything else over to the other side, and I get equation ten here. So this is the forward price. G 0 equals the expected value of Z 4 6 over B 4, all divided by the expected value of 1 over B 4. Now if you recall the expected value of 1 over B 4, this is simply, this quantity down here, simply the time zero price of a zero coupon bond that matures at time 4 and that has face value of $1. This comes from this neutral pricing again. So this is Z 0 4, and we actually calculated this in the last module. It's actually 77.22 dollars if the face value is 100 dollars, if the face value is 1 dollar as we have here, then its price is 0.722. So we actually know the denominator of this expression here. So that means we only need to focus on evaluating the numerator, this. And this is actually very easy to do using our backwards induction or working backwards in the lattice. Let's see how we do that. So to compute Z 4 6, what we will do is we'll work backwards in the lattice from time t equal to 6. So at time t equal to 6, we know that the value Z 6, 6 is 110. And it's 110 because that maturity, you get the face value of 100 back, where you also get the 10% coupon, which corresponds to $10. So the total payoff at t equals 6 at maturity of the underlying bond is 110. And now we just work backwards at each period, to try and find out the value at t equals 4. So, for example, the 98.44 here is equal to 1 over 1 plus 0.1055, that is the short rate that prevailed the time t equals 4, so we can see this if we drove back to this period here, so 10.55 times the expected value of the bond one period ahead. The bond one period ahead will either be 107.19[UNKNOWN] or 110.46[UNKNOWN], so that's how we get 98.44. Note that we did not include the $10 coupon at this time, because we said that the forward contract delivers the bond just after the coupon at this period has been paid. So that's why we don't include the $10 coupon at this period. In contrast, when we're computing the value of t equals 5, we actually would include the $10 that's paid in this period, because that actually is a payment to the bond. So we would say that the 102.98 equals $10 plus one over one plus the interest rate of this notde times the expected value of the bond one period ahead which is 110. So doing that, we find the value of the bond that t equals 4, and it's given to us here. This is the underlying security of the forward contract. So remember our goal is to compute the value of this, this is the numerator in the expression for the fair value of the forward price, so I need to compute this expectation here. So we know this is the value at time t equals 4. And I can just work backwards in the lattice and compute its value time t equals 0, I get 79.83. So therefore, using the expression we have for the fair value of the forward contract, which we see, it should have been ten. So we see we're going to get 79.83 divided by 0.722, which gives us a fair forward price, or an arbitrage-free forward price of 103.38. We can go to the spreadsheet that you have, and we can see how these prices were calculated. So as before, these are the parameters for our short rate, so we have initial value 6% for the short rate and we see that over the next five periods it can grow up as large as 18.31% or be as low as 3.54%. Given the short rate lattice, this enable us to compute the 4 year 0 coupon bond price which we saw earlier at 77.22. Remember we needed this in the denominator when we were calculating the fair value of the forward price. So, the next step to do is to compute the value of the 10% six years coupon bond. So recall, it pays off at maturity of $110. This is the principle plus coupon of $10. And then we work backwards to find its value at time t equals 5, including the coupon, which is 10%. Work backwards all the way. In fact, we can actually find that the value of the six year 10% coupon bond at time zero is 24.14. So we do that here although we didn't need to do this to compute the forward price. To compute the forward price we just needed the x coupon price of the bond. So this is the price of the bond at time t equals 4 but these prices include the $10 coupon that's paid at that period. To get the x coupon price we just subtract $10. And that's what we do down here. So we subtract the coupon, $10 in these cells, and now we can actually work backwards in the lattice to compute that quantity, 79.83 that we saw. And finally, we get our value of the forward price which is 103.38.

### 025. Fixed Income Derivatives  Bond Futures

In the last module, we saw to price forwards on bonds. In this module we're going to see how to price futures in bonds. You might recall that the mechanism behind a forward contract is very different that the mechanism behind a futures contract. So we're going to see in this module how we actually get a different price when we price Bond Futures to the price that we get when we price bond forwards. We are now going to price futures contracts on bonds. In particular, we are going to price a futures contact, contract on the same coupon bearing bond that we considered in the last module. In that module, we priced a forward contract on a coupon bearing bond. Here we're going to price a futures contract on that same bond. And I'm also going to compare the forward price with the futures price. In fact this example is interesting because we will see that the forward price is not equal to the futures price. So we're going to have to remind ourselves first about how futures prices are constructed. So let Fk be the date k price of a futures contract expires after n periods. Let Sk denote the time k price of the security underlying the futures contract, then Fn must be equal to Sn. After all, at maturity, the futures price and the underlying price must coincide. So we want to compute the futures price at t equals n minus 1, and we can do this by recalling that any time we enter a futures contract the initial value of the contract is 0. Now, what does that mean? Well, if you recall our risk mutual pricing, our risk mutual pricing states, that for any security, let's say security with price t, St over Bt Is equal to the expected value at time t using the risk neutral probabilities of St plus 1 over B t plus 1. This is our familiar risk neutral pricing for a security that does not pay dividends or coupons, or anti-intermediate cash flow between times t and t plus 1. We're going to use this as follows. So we're going to actually take t equal to n minus 1, and we're going to take s t to be the payoff of the futures contract, or the value of the futures contract. So we know St is equal to 0, because any time you enter into a futures contract you get 0. So therefore, we get 0 here, and then st plus 1, well, the value of the futures contract at that point is going to be Fn minus Fn minus 1. We could also actually interpret this using the more general form of this neutral pricing where we included a coupon plus the value of the security, divide the security would then be zero and the coupon would be this quantity here. So risk neutral pricing gives this to us, what does that mean? Well it means the following. It means that the expected value 1 to q at time n minus 1 of Fn over Bn. Well, that's Fn minus 1 over Bn is equal to the expected value at time n minus 1, with respect to q of Fn over Bn. Now, Fn minus 1 is known to us at time n. It's the futures price at time n minus 1. So that comes outside, this is also a very important characteristic of the cash account. It is known to us one period earlier. So the value of the cash account to time n is also known to us at time n minus 1. So therefore, this Bn can come outside as well, it will come outside here. This Bn will also come out, and they will cancel. And what we're left with Is that Fn minus 1 equals the expected value under q at time n minus 1 of Fn. And in fact, we've seen this before when we were discussing the binomial model for stocks and pricing futures in that binomial model. So we get this expression here, I can iterate this and actually I can get this expression more generally for any time k, I can get Fk equals the expected value of Fk plus 1, conditional time k information. And we can use law of iterated expectations to get this expression here or equivalently this expression here. Now, this holds regardless of whether or not the underlying security pays coupons. If you look at how we derived this, whether or not I paid coupons does not matter. In contrast, the corresponding forward price that we saw in the last module is given to us by this expression here. So this is the value of the forward price, this is the value of the futures price, both at time zero. If by the way, and you can see this immediately, if interest rates were deterministic In that case Bn would be a constant, so the 1 over Bn would come out over here, 1 over Bn would come out over here, they would cancel, and I would be just left with G equals E0 the value of Sn which is exactly what I have here. So certainly when interest are rates are deterministic G0 equals F0. In general, interest rates are not deterministic. I cannot take the one over Bn outside the expectation here, and in fact these two expressions then do not agree. So now let's compute the fair value of the futures contract on the same coupon-bearing bond that we considered in the last period. We know that F0 Is equal to E0 under q of Sn, where s n is the security underlying the futures contract. Well in this case, the security underlying the futures contract is that 10% coupon bearing bond. That is delivered at time t equals 4, just after the coupon has been paid at t equals 4. We saw in the last module that this vector here, vector here of prices, are the prices of that 10% coupon baring bond of t equals 4, so therefore we want to compute f0, which is the expected value of this pay off here. Well, we can do that easily by just working backwards in the lattice. Note, however, that when we work backwards in the lattice we do not discount by 1 over 1 plus the interest rate, because there is no discounting going on up here. This is a fair value of the futures contract at zero, and there is no discounting here, we're not dividing by Bn. So in particular, for example, you should see the 98.09 is equal to a half times 95.05 plus a half times 101.14. No discounting taking place when it work backwards in the lattice here. What do we see? We see a value of the futures contract be 103.22. This is different to the fair forward price that we computed in the last module, that was 1 or 3.38. Now, the numbers are close as you would expect them to be but in fact they are not the same. So here's an example where the forward price and the future's price are actually different. Let's go back and see why? So, if you stop and think about it you can see that F0 is a weighted average of s n at time n. And G0 is also a weighted average of Sn at time n, and if you think of how the rates work, the interest rates work It shouldn't be surprising that g 0 103.38 turns out to be a little bit larger then the futures prize 103.22. And that is because of the manner in which these quantities are computed. If we go to the spreadsheet again and you've seen this already, I hope you have the spreadsheet in front of you. You see here we have the short rate lattice. We have the four-year zero coupon bond lattice. We use that to compute the 77.22, which we used in turn to compute the forward price of the bond. These are all the calculations for the forward price. Over here we've the calculations for the futures price, so over here we've 91.66 down to 111.16. These are the same prices we used for the maturity of the forward and they're equal to actually the value of the coupon-bearing bond time four, but ignoring the coupon that's paid at that time. So we get these values, now they can be the future's price. We just work backwards in the lattice computing the price at each note. Note that there's no discounting going back, when we work backwards here and that's because Fk equals the expected value of Fk plus 1 under q. Not the expected value of Fk plus 1 discounted under q. So, you see we have our 103.22 here and we have our 103.38. So the forward price and the futures price are different. They're very close, but they are different. And this is an example showing you that forward prices and futures prices are not the same, theoretically, in an arbitrage free model.

## 013.Fixed Income Derivatives II

### 026. Fixed Income Derivatives  Caplets and Floorlets

In this module we're going to see how to price caplets and floorlets, and particularly we'll focus on caplets but floorlets are priced the same way. Caplets and floorlets in more generally caps and floors are very liquidly traded fixed income derivatives securities that are found in the market place. So it's important that we understand how to price these securities and understand the mechanics behind these securities. A caplet is similar to a European call option on the short-rate r t. It is usually settled in arrears, but a caplet may also be settled in advance. If the maturity is time tau and the strike is c, then the payoff of a caplet is r tau minus 1 minus e the positive part, or if you like, this is the maximum of 0, and or, tau minus 1 minus c. This payment occurs at time tau, so this is what we mean by being settled in arrears. So, you can think of the caplet as being a call option on the short rate prevailing at time tau minus 1, but settled at time tau. A floorlet is the same as a caplet, except the payoff is c minus r tau minus 1 positive part, or as we've been writing, the maximum of zero and c minus or tau minus 1. But again, this payoff would typically take place at time tau. A cap consists of a sequence of caplets, all of which are the same strike, so these caplets would all have different maturities but all have the same strike. And a floor consists of a series of floorlets, again all of them having the same strike, but different materials. So here's our familiar short rate lattice. This is the lattice that we have been working with throughout this section on fixing[UNKNOWN] derivitive securities. We start off with 6% for the short rate, and it grows by a factor of u equals 1.25, or falls by a factor of d equals 0.9 in each period. What we're going to do is we're going to price a caplet with this model. So we're going to assume the expiration of the caplet is t equals six. In other words, the payment actually takes place at t equals six. We'll assume a strike of 2% for the caplet, and now we're going to go ahead and price it. But there's one thing to keep in mind here, the caplet, the pay off of the caplet takes place in arrears. So for example, suppose we're at this node down here 0.28, now in reality, the payment that is determined at, at that node will take place at time t equals 6. But it is somewhat awkward to record the payment here or here, because if we were to record the payment at this point, well, we're not sure, actually, which node is responsible for this payment. Is it this node, 0.28, or is it this node, 0.045? So, that makes the accounting just a little bit awkward. So instead what will do is we will actually record the cash flow, the final cash flow at the node of which it is determined. So that is at t equals 5, but we will discount it appropriately to reflect the fact that payment does not take place until t equals 6 and that is what we have done here. So if we look at this point 0.015, 0.015 is equal to the payoff of the caplet af, determined at t equals 5, so this is the maximum of zero and the short rate that prevails at that period, which is 3.54% minus the[INAUDIBLE] 0.2. So this is the payoff, of the capital, which is determined at this note, however it is not paid unto type t equals six, and so that is why we must discount it by 1 plus 3.54% to reflect the fact that the payment is made in the rears. So we do that for all of the notes at time t equals five. These are all of the payments of the caplet discounted by 1 period. Once we do that we can work backwards in the lattice using our usual risk neutral pricing. And just to remind ourselves our usual risk neutral pricing takes the following form s t is the price of whatever security we want to price and it's equal to the expected value at conditional time t information using the risk neutral probabilities of St plus 1 divided by 1 plus rt, where rt of course is the short-rate prevailing at the node your at time t. So this is risk neutral pricing for a security, that does not pay any intermediate cash flows or coupons. If the security did pay a coupon at time t plus 1 or some intermediate cash flow time t plus 1 we would of course inject that cash flow into this point here. And here we can see the lattice with all of the caplet prices displayed, for example, the value of 0.021 is calculated as follows. It is simply one over one plus 3.94%, remember that is the short rate prevailing at this note here, 3.94%. So we get simply 1 over one plus 3.94% times the expect, expected value of the cap at one period ahead, using the risk neutral probabilities which are a half and a half. One period ahead it's either worth point 0.28, which we have here, or 0.15, which is what we have down here. So we get the value of the caplet at this node. So again all we're doing is using what we had on the previous slide, we're using the fact that s t equals the expected value, of s t plus 1 over 1 plus r t. So we start off at time t equals 5. At time t equals 5, that is where t plus 1 equals 5. We know the value of the caplets; It's this value, these values here, and we just work backwards one period at a time to get to time zero and we see a caplet value of 0.042. Now just to be clear, this is the value of the security that pays off r 5 Minus 2% the maximum of this and it's paid at time t equal to 6. Well this 0.42 is how much this is worth, but in practice of course, you might actually not just buy just one of these, you might buy a million of these. So a million dollars, that would be a notion of 1 million dollars, that price of that would therefore be 0.042 times 1 million dollars. So this value here, is the value for a notional of one dollar. We're multiplying this pay off by if you like one dollar here. In general, in practice, you would be actually buying many of these, or selling many of these, and so you would need to multiply the price you obtain here by the notional of the counters. And here we see our familiar spreadsheet, that I hope you've opened in front of you while you go through these calculations. Here we have our parameters for a short-rate lattice or starting off with 6% which neutral probabilities of a half and a half, u equals 1.25, d equals 9. So we have a familiar short-rate lattice that we're using throughout these examples, down here we see how to price the caplet. The .0149 is the payoff of the caplet at the time as determined the time equals 5. So that is the maximum of 0, and the short rate which is g 16, which is 3.5%, minus the strike 2%. But of course that payment does not take place until time t equals six so we have to discount by the one plus the short rate prevailing at that node which is again in g 16. So we compute the value of the caplet at time t equals 5, and then we just use risk mutual pricing to work backwards. And I've highlighted the, the cell here in bold because it is this cell which contains the formula, the risk mutual pricing formula for the value of the caplet at this cell. We can then copy and drag this cell formula throughout lattice to determine the prices at every node. And again, we see the value of the caplet is 0.0420.

### 027. Fixed Income Derivatives  Swaps and Swaptions

In the last module, we saw how to price caplets and floorlets. Well there are other liquidly traded fixed income derivatives securities in the market place and there are swaps and swaptions. So in this module how to price swaps and then how to price options and swaps which are called swaption. Again we will be focusing on the binomial lattice model. And by pricing them in this model, we will also understand and reinforce our learning behind the mechanics of these securities. So here again is our familiar short-rate lattice. We've seen it now many times beginning at r equal to 6%. Rising by a factor of u equals 1.25 or falling by a factor of d equals 0.9. What we want to do initially in this module is the price an interest rate swap with a fixed rate of 5% that expires at t equals to 6. The first payment will occur at t equal to 1, and the final payment will occur at t equal to 6. Now the payment at each node will be the following. It will be plus or minus depending on whether you're long or short the swap. Of the short rate that prevails off that node minus k. But that payment is made in a rears at time t = i + 1. So again, like the caplet that we saw in the last module, we're going to assume that the cash flows in our swap are paid in a rears which is a typical situation that occurs in practice. So just to give you an idea. So for example up at this node here, 18.31%. Well the cash flow at this node will actually be 18.31%-5%. But actually I should say that this is the cash flow that is determined out of this node. The cashflow itself will not take place until one period later time equal to six. Similarly the cash flow at this node will be 11.2%-5%. That is the cash determined at that node, it would be paid a time t equal to 4. And so all of the nodes here will have cash flows equal to these values minus 5% to be paid one period ahead. How do we price this swap? Well let's go to that. So what we're going to do is to figure out again how much the swap is worth at the final node. Now the final node again is t equal to 6. But we don't want to record the final values of t equal to 6. Because for example, if we find ourselves at this node here. Well it won't be clear how we got here. Is the payoff at this node because we were at this prior node or we were at this prior node? And depending on which node we were at in the previous period, we'll get a different cash flow up here. So this is the exact theme situation as we saw the cash in previous module. It's actually much easier to record the cash flows after nodes at which they occur. But discount them suitably to reflect the fact that they paid in the rears or in one period later. And that's what we're going to do here, so for example, this 0.723 that we have highlighted up here. Well that is equal to the cashflow, r5 5-K divided by 1 + r5 5. So r5 5-K is the payoff of the swap, but this swap takes place at time 6. So we have to discount it by the short rate that prevails at this node. And so we get this value which is 0.0723 at time t=5 and stays 4. Here's another sample calculation. 0.1686, so where do we get this from? Well we're going to get that from our standard risk neutral pricing. Maybe we should write our risk mutual pricing again here. So in this case, risk mutual pricing takes the following form. Let st be the generic value of some security that we want to price. Then we know that st is equal to the expected value, conditional on time t information under the risk mutual probabilities. The payoff or the value of the security one period ahead ST plus 1. But also this swap actually has intermedia cash flows or coupons if you like. We must also include these cash flows CT + 1, discounted by 1 + rt. So this our risk mutual pricing or familiar risk mutual pricing for security that has intermedia cash flows. So this 1.686, for example, how is that calculated? Well it is as follows. It is 1 over the short rate that prevails at that node, so that short rate is 9.38%. And we can check that by going backwards. Here it is, 9.38%. And we have the cash flow, so this is our CT + 1. This is the payment that takes place one period ahead. It is the cash flow determined at this node, but it is paid one period ahead. And these terms here, give us the possible values of ST + 1. So either 0.1793 if we go up or 0.1021 if we go down. So this is just risk neutral pricing. We work backwards in the ladders until we get the time t equals 0. That gives us the initial arbitrary value of the swap, and we find this 0.0990. And again to keep in mind here, this is the fair value of the swap for a notion of $1, right? We're multiplying each of these pay offs, these cash flows by $1. In practice maybe you'd have $100,000 or $1 million and so you should be multiplying this value then by that notion of a 1 million or $100,000. Now let's consider how to price swaptions. Swaptions like swaps are very liquid securities that are traded all the time used by many market participants to both hedge interest rate risk as well as speculate on interest rate risk. A swaption is an option on a swap. So what we're going to do is we're going to consider a swaption on the swap of the previous slide. We're going to assume that the option strike is 0%. This should not be confused with the fixed rate of the underlying swap. Remember the fixed rate of the underlying swap was, 5%. So we're going to assume that the option strike is 0% and that the swaption expiration is t = 3. In other words, the option on the swap expires at t = 3. Therefore a time t = 3, if you own the swaption, you have the right to exercise or enter into this swap for a value or a strike value of 0. So the payoff at t equals to 3 is going to be the maximum of 0 and S3. You will only exercise this swaption at t equals to 3 if S3 is positive. If S3 is negative, then you won't exercise the maximum would be 0 and you will do nothing. So how are we going to price this swaption? Well actually it's going to be very simple. We're going to use our calculations from the previous slide which we see here, to get the value of the swaption or order to get the value of the swap a t equals a 3. We're going to replace this column of prices with the maximum of 0 on this column, that will gives us a pay off of swap option at maturity, t = 3. And then we will just calculate the fair value of this pay off by working backwards in the lattice using risk neutral pricing. One thing to keep in mind though however, is that when we're working back from t equal 3 back to 0, we no longer include the underlying cash flows of the swap. And that's because the holder of the swaption does not get those underlying cash flows. The holder of the swaption will only get the cash flows of associated with the swap if they exercise the t equals 3. And then they will get this swap cash flows for all time periods greater than t equals 3. They will not get them for the periods before t=3. So here are some sample calculations again, for example, so if you look at t equals to 3, this is the pay off of, This swaption. So in fact all of these values here from t equals 4 and 5 are simply the values that we see that we calculated earlier for the underlying swap. So we see 0.0512 here, well that's the same 0.0512 here. Down here however, is the value of the swaption at maturity. And now this is equal to the maximum of 0 and S3. So if you recall, the only change is actually down here. Because in the underlying swap value, we had a negative value minus 0.0085 at this node. But now, the holder of the swaption would not choose to exercise at this node. Why would they buy something for 0 when it has a negative value? They won't do that. So they will exercise however at all of these three nodes, because these three nodes the swap has a positive value. So certainly the whole of the swaption will exercise at these three nodes and receive these three payoffs. So what we have is here are the values, the payoff values of the swaption at maturity, at t = 3. It's equal to the maximum of 0 and S3. And now we actually just compute the fair value of the swaption by computing the value of this payoff backwards in the lattice. So here what we're using in our risk-neutral pricing again, if you like I won't use s here, I'll say Z. So Zt = the expected value of Zt + 1 divided by 1 + over t. This is our risk neutral pricing for the swaption. Note, I don't have any intermediate coupon or cash flow in here. And that's because the swaption doesn't pay any intermediate coupons or cash flows between t = 0 and t = 3. So I just iterate this backwards to get the value of 0.0620 as being the value of the swaption at t = 0. So here's a sample calculation, 0.0908. Well 0.0908 is just 1 over 1 plus, or 1 over 1 is going to be 7.5% of this node times the expected value of the swaptions one period head while the risk mutual probabilities are half in a half. These are the values of the swaption one period ahead 0.1286 and 0.0665 and so that's how I get 0.0908. You can see all of this calculations performed in the spreadsheet, they're very easy to do. We see again here that we have our usual short rate lattice that we're using throughout. So these are the details here, I won't go through them again. Down here, we calculate the value of the swap, the underlying swap. So there's a fixed rate of 5%, here, we see the payoffs of the swap at time t equals the 5. In fact these are the values of the swap, because remember the payoffs occur time t equals to 6. But we discount them back one period to reflect that the swap cash flows occur in the rears. So we do that at time t equals 5, we now work backwards in the lattice using risk mutual pricing. So for example down here, we see that the value of the swap at this node is the payoff that's determined at that point. So that's the cash flow identified up here plus the expected value of the swap one period ahead. And that's given to us by these terms here. And of course, I have to discount both of these quantities. The cash flow because of in the rears and the value of the swap one period ahead by 1 plus the short rate at that node. And that's how I get this expression here. It's in bold again because you can actually enter the formula into the cell. And then drag this formula throughout the rest of the lattice to compute the prices of the swap at every node. We find an initial swap value of 0.0990. To compute the fair value of the swaption, well all we do is we just repeat really what we did for the swap. We just calculate the value of the swaption at maturity, so we see it down here. In this case, it's the maximum of the swap value which is given to us here and 0. So that's how we get these values down here. And now we just use risk mutual pricing to work backwards on the lattice. Note that any cell in this lattice, we don't have any intermediate cash flow or we don't have the cash flow associated with the swap at that time. And that's because the holder of the swaption does not get any of those cash flows or pay any of those cash flows until such time as they exercise the swaption. So we just work backwards to find the initial value of 0.0620.

## 014.The Forward Equations

### 028. The Forward Equations

In this module, we're going to discuss the so-called forward equations. The forward equations enable us to compute the prices what are called elementary securities. An elementary security is a security that pays $1 at a particular time and in a particular state at that time. We'll see that by constructing the forward prices we'll be able to price many derivative securities very easily. So let's get started. We're going to let P subscript i comma J superscript E denote the time zero price of a security that pays $1 at time i, and state j, and zero at every other time and state. Such a security is called an elementary security. Actually, it is sometimes also referred to as an arrow Debreu security, for those of you with some background in economics. This type of security actually has a very important role to play in financial economics. So such a security is called an elementary security and we call P subscript i comma j superscript e its state price. We can actually see that these elementary security prices satisfy the forward equation. So these are the forward equations, we'll explain where they come from in a moment. We note that P0,0 subscript e equals 1, why is this? Well this quantity here is the time zero value of $1 that is paid at time zero and state zero, i.e., today. So $1 today is equal to $1 today. So certainly, this is true. So, starting with this value, we can actually work forward in time to compute the values of the Pij's at every note. For example, suppose this is our binomial lattice. Well, we start off with knowing this value it is one. And now we can use the forward equations to get the values of these two nodes. So this value here of one is equal to P0,0. I'll ignore the superscript e just to avoid cluttering the, the slide. This value we want here is P1,0 and the value we want up here is P1,1. Well, if you look at these we could see how to get them. So we can get P1,0 from, this equation and we can get P1,1 from this equation. In this case we would take k equal to 0. And in this case we would take k even to 0 and that's how, sorry we would take yes k equal to 0 and that is how we can calculate the state prices at time 1. Given that we now know these three state prices we can go forward to calculate P2,1 or rather P2,0, P2,1, P2,2. Again using these two equations for the P2,2 and P2,0 and we can use this equation here for p two one. So actually that, this is why they're called a forward equations, we start off with P0,0 equal to 1. And we actually use these equations to work forwards in the binomial lattice to calculate the state prices for every node. So, where do these forward equations come from? We're going to answer that question on this slide and hopefully make clear. Where these equations come form, so for example, let's consider this elementary security. This is the elementary security that pays $1 at time t equals 3, and stage two. And zero everywhere else, so by definition the value of the security is P3,2. However, we can also compute the value of the security another way. We can just treat this as a regular security and use risk neutral pricing to compute its value. So if we use risk neutral pricing, we will work backwards in the lattice in the usual way to find its value. So let's do that, so if we work backwards, we can come back to this node. This is node r2,2 up here. Well, the value at node r2,2 is going to be 1 over 1 plus r2,2 times the expected value of the security, 1 period ahead. With 1 period ahead the value of the security is either 0 or it's 1. And so we get this quantity here which simplifies down to this expression here. So this is the value of this elementary security at time t equals 2 and state 2. It's value of node n2,0 is clearly 0 because at node. At time t equals 2 and state 0 you'll only get 0 in the 2 successive states. So its expected discounted value must be 0. So therefore we have this, its no that n2,1 which is here. Well that is given to us by 1 over 1 plus r2,1 times the expected value of the security 1 period ahead and that is 1 with probability a half. And zero with probability a half, and so we get this quantity over here. So what we've done is the following: we've seen, we've come to this elementary security, which is worth one of this statement zero everywhere else. We know by definition the value of this elementary security is P3,2, but by working backwards in the lattice we've also computed its value at these three nodes. It's equal to this at r2,2 is equal to this at r2,1 and it is equal to zero at r2,0. So therefore, we can say that P3,2, over here, must be equal to this quantity times the value of $1 at that node. Well the value of $1 at that node is P2,2 plus this quantity times the value of 1 dollar at this node and 1 dollar at that node is actually P2,1 plus zero dollars times the value of P2,0 which is the value of $1 at that node. So in fact, all we're doing here is linear pricing. We're actually breaking this security up into this many units of P2,2 plus this many units of P2,1 plus 0 units of P2,0 and this is indeed, in this case equation 13. So this is equation 13.So this is the argument that you get to show that the forward equations are true. It's easy to see that this holds in general for any node any time k state s. If we're at an extreme node at the bottom or at top. Well there's only one predecessor known that's possible, so we would only get one term in this equation, and that's why we would either get this equation here or this equation here. So these are the forward equations we can calculate the stay prices, or the elementary prices by working forwards in time from t equal to zero. So lets go back through a familiar short-rate lattice. This is the short-rate lattice we're considering throughout these, these modules. We start off with r equal to 6%, it grows by a factor of u equals 1.25 or falls by factor of d equals point 9 in every period. So we're going to actually compute the forward prices in this particular model by starting with P0,0 equals $1, and working forwards to calculate the forward prices at all future nodes. And this is the lattice with the corresponding elementary prices, or state prices. So the value at any node, nij is actually Pij. The value of the elementary security that pays $1 time i state j. So how do we get these values, well we know where the 1 comes from. We can work forwards using the forward equations to get these values. So for example, how do we get this value 0.3079, well we know from the calculation we just did in the previous slide. The 0.3079 is going to be equal to 0.2194 time divided by twice 1 plus the short rate prevailing at this node plus 0.4432 divided by twice 1 plus the short rate prevailing at the node. So this is just the same calculation that we did in the previous slide. We find that P 0.3079 is equal to the sum of these two quantities here. Now what can you do with these elementary prices or these state prices? Well once you've calculated these state prices many other derivative securities are very easy to calculate. For example, suppose we want to compute Z04, the price of this zero coupon bonds. So this is the zero coupon bond, its value at time 0, maturity 4. Well with face value a 100 we can compute Z04 is just being 100 times. The state prices, the sum of the state prices, in all of the states time t equals 4. So what are those states a time t equals 4? Well it is these quantities here. So remember a zero coupon bond is going to pay $100. And this note a $100 here and $100 here and so on. So, how much is that worth? Well that must be worth 100 times this elementary security price plus 100 times the elementary security price for this note plus 100 times the elementary security price for this note and so on. Again that is just linear pricing in action and so that's how we get Z04 equals 100 times. The sum of these elementary security prices 0.0449 and so on, and actually that summed to 77.22, which we've seen before, we saw this in one of the first modules in this section where we computed zero coupon bond prices by working backwards in the lattice. Well, we've done it in a different manner here. We've done it here by first calculating the forward prices by working forwards in time, and iterating those forward equations. And, then given all of the elementary prices it was absolutely trivial to compete the price of a 0 coupon [unknown]. It was simply the face value times the sum of all the elementary prices at that time. We can also calculate other security prices using these elementary prices. So, here's another example consider a forward starting swap. That begins at t equals 1 and ends at t equals to 3. The notional principle is $1,000,000. The fixed rate in the swap is 7% and the payments are received at time t equals i for i equals 2 and 3. So this is where the forward feature kicks in. If it was a regular swap you would get a payment of time equals 1. Here we're assuming that you only got a payment at time t equals 2 and time t equals 3. And that payment is based as usual on the fixed rate minus the floating rate that prevail at time t equals i minus 1. So the first payment is at t equals 2, because payments are made in arrears. So the question is, what is the value v0 of this forward swap today at time t equal to zero? Well, how can we calculate that? Actually it's very straightforward. So what we have here are the actual cash flows. For this one, there are actually five cash flows and we can go back to see these cash flows by looking at the short rate lattice. So these cash flows are based on these short rate, they occur in arrears, so we should be seeing these cash flows of 7.5 minus the fixed rate of 7%, 5.4 minus 7%, 9.38 minus 7%, and so on. These are the [inaudible] of the underlying swap and so indeed here they are. These are the fixed rate of 7% minus the floating rate 9.38, 7.5, 5.4, 6.75 and 4.86%. So they're the cash flows of the swap, but remember these cash flows are paid in arrears, one payment ahead. So what we do is we take these cash flows and discount them by the appropriate short rate. So it's 9.38%, the same value as, as in here, 7.5%, same value as here and so on. So now we've got the value of the cash flows that each of the nodes at which these cash flows are determined. Given that we know the elementary security prices for those nodes, it is just a simple matter of multiplying these values by the corresponding elementary security prices. And that is exactly what we have done here. So we see, we got a value of $5,800 for a notional principal of 1 million dollars. So again, we could have priced this forward starting swap if we liked, by working backwards in the lattice using risk neutral pricing While instead we've done something differently. We're still using risk-neutral pricing of course because that's where the forward equations come from. But what we've done instead is we've determined the elementary security prices via the forward equations, and then used those elementary security prices to compute the fair value or the albatrosary value of the cash flows associated with this forward starting swap. All of these calculations are certainly the calculations for the elementary security price available to us In the spreadsheet, so we have our short rate lattice. You can see how we actually calculate the elementary prices. We start off with a value of 1 and then we just iterate the forward equation. So we get 0.4717, 0.4717 and these two nodes are [inaudible] equal to 1, and we can actually iterate forward the forward equations, by using if statements in here to make sure that we're actually using the correct version of the forward equations. There are three different versions that we saw. We need to make sure that we're using the correct one. And so that's how we do that? We just copy and drag these formulas through the lattice and updating the elementary prices at each node or each sub and the [inaudible]. Given these we can actually now compute all of the zero coupon bomb, calculating the zero coupon bomb prices now absolutely trivial, we just sum the corresponding, elementary prices, multiply them by a 100 and that's how we get the, the zero-coupon bond prices. So down here, you can just see we're just summing the corresponding elementary prices, multiplying by 100. And then of course, we can invert the zero-coupon bond prices to get the spot interest rates for that maturity. So for example, 6.68% we get by inverting the 77.22, assuming per period compounding. And we did that calculation as well in an earlier module.

## 015.Model Calibration

### 029. Model Calibration

Up until this point, we focused on how to price derivative securities, in particular fixed income derivative securities, in the context of the binomial model. However, we have not said anything yet, about how to calibrate these models. In particular, how should we choose the parameters of these models so that the model prices match the prices that we see in the marketplace. It is particularly important with derivative securities models that our model prices match market prices. That is the problem of model calibration and we're going to discuss that problem in this module. Up until now we focused on the pricing of derivative securities. We've taken our model and the parameters of the model as given. What we've done is we've priced everything our bonds, our options on bonds, forwards, futures and bonds, caplets, swaps, and swaptions. We've priced all of these securities using risk mutual pricing. Using risk mutual pricing, ensured that our models were overcharge free. However, a model is no good, unless at the very least, we can get the model prices to agree with the market prices of liquid securities that we see in the marketplace. Security such as caps and floors, caplets, floorlets, swaps and swaptions are all very liquidly traded. And we can see the prices of these securities in the marketplace. So what we want to do with our model is to pick the parameters of our model in such a way that the model prices of the securities match the market prices of these securities. This process is called calibration. What we want to do is calibrate our parameters so that the model prices agree with the market prices of liquid securities. So we're going to discuss that further in this module. The first thing to keep in mind is that they're actually very money-free parameters in our binomial model. We have rij's and qij's for all ij. So in fact, there's going to be some sort of approximation to cn squared parameters in our model where n is the number of periods in our binomial model. So what we typically do is we fix some of these parameters, and so that's in fact what we've been doing until now. We just fixed our qij to be equal to q, which is equal to half for all ij. So we actually assumed our risk neutral parameters or risk neutral probabilities were half at all notes. We've also assumed that the short rates, rij, were also given to us up until this point. We started off with r being 6%, we let it rise by a factor of 1.25, or fall by a factor of 0.9. Well, we can no longer do that. If we want our model prices to match market prices, we're going to actually have to have some free parameters that we can use to calibrate the market prices. And so that's what we're going to do here. One possible way to do this is to use a parametric form for the rij's. So for example, the Ho-Lee model assumes that rij is equal to ai plus bi times j. So if you recall i is time and j is state. So it assumes that there is a drift component parameter ai and then there is a volatility component bi. Why do I call this a volatility component? We remember j is the state that we're going to see a time i. j is a random variable. We don't know what statement will be in a time j, so we can interpret bi, the multiplier of the state j as being a volatility parameter. So in this case, we actually only get 2n parameters, ai and bi for i equals 0 up to n minus 1. You can actually check that the standard deviation of the one period rate is then bi over 2 if you're conditioning on where you are at time i minus 1. Now the Ho-Lee model that should be set is actually not a very realistic model at all. There is some real problems with the dynamics induced by this assumption here. However, it has been a very influential model in the term structure literature and some very interesting term structure models have grown out of some of the ideas that were present in the original paper by Ho-Lee. We're going to focus here instead on the Black-Derman-Toy model. The Black-Derman-Toy model assumes that the interest rate at node N(i,j) is given by rij equals ai times e to the b i j. So actually if I take logs across here I'll see that what we're assuming is that the log of rij is equal to the log of ai plus bi times j. So we can interpret log ai is being a drift parameter for the log of the short rate. I make it an interpret bi is being in volatility parameter for the log of the short rate. Remember, as I said it on the previous slide that the random variable here is the stage j. And that's why I can interpret bi which multiplies the random variable as been in volatility parameter. What we want to do is we need to calibrate the model to the observed term-structure in the marketplace and ideally other security prices. So certainly at the very least, any term structure model that you want to use should ensure that the zero-coupon bond prices are equivalently the term structure of interest rates matches the time structure of interest rates we see in the marketplace. So we're certainly going to want to calibrate our model to zero-coupon bond prices. Ideally, we would also want to calibrate to other liquid security prices like caplets, and swaps, and floors, swaptions, and so on. So this is done in general by choosing the ai's and the bi's to match market prices. For relatively few periods we can actually do this in Excel using the Solver Add-In and indeed we're going to do this in a few minutes, but also more efficient algorithms and software could be used in general. In fact, it would be very straightforward to do this and/or applies in MATLAB or C++. We'll also see how to calibrate the Black-Derman-Toy model to market zero-coupon bond prices using Excel, the Solver Add-In in Excel, and the forward equations. So to get us started let's assume that we have an n-period binomial lattice model as usual. We will let s1 up to sn be the term structure of interest rates observed in the marketplace. So these interest rates are given, they're fixed. We see them in the marketplace right now. We're going to assume spot rates are compounded per period. There's no loss of generality in doing this because we can always use any compounding convention that we like. For now, we're going to make the assumption that bi is equal to b and that this is known for all i. So this is actually quite a heroic assumption, we'll come back to this in a moment. We're doing this for several reasons, number one is we just want to calibrate our model to the time structure of interest rates. There are n interest rates, one for each period. There are n parameters ai. So if we fix the b's, and assume they're known, we then have n equations and n unknowns. We're going to need to solve for n ai's using n equations. And those n equations will be the equations that matched the term structure in the marketplace to the term structure in the model. So here's how we're going to do this or at least this is how we could do it if we wanted to using the forward equations. We're actually going to be a little bit lazy and let Excel do all the work for us or let Solver in Excel do all the work for us. But this is one way we could go about doing this. We know the following. Well, we know that 1 over 1 plus si to the i is equal to this sum here of elementary security prices. What is this sum on the right inside? Well if you think about it, i is fixed, so this is the time i, state j elementary security price summing over all states j at time i. Well we know that this is just a zero-coupon bond price at time zero, which matures at time i. And indeed, this indeed is equal to 1 over 1 + si to the power of i. Remember, the fair value of a zero-coupon bond that matures at time i, well that's equal to 1 over 1 + si to the power of i. So this is how we can express an equation for si, in terms of quantities in our model. These are going to be the elementary security prices. We're going to use the forward equations to actually compute and expression for each of these guys here. So how can we do that? Well, if you recall the forward equations that we saw in the previous module we can substitute n for each pij. When j equals zero we just get one term, when j equals i we get this term. So this term actually corresponds to pii. This term is equal to pi0. And then this term here is simply pij, when j is between 1 and i minus 1. So these are quantities this expression is coming from the forward equations that we saw on the previous module. Given this we could actually now solve iteratively if we wanted to for the ai's. For example, suppose we start off with i equal to 1. Well, in that case we're going to have the following equation. 1 over 1 plus s1 will be equal to p00 over 1 plus a0 times 2 plus p00 over twice 1 plus a0 e to the power of 0 times 2. And this, of course, is equal to p00 divided by 1 + a0. So in fact, we know that p00 = 1, we will know s1 from the marketplace and so this will give us a0. Given a0, this will then give us r00, which we can see from over here. If we know a0, remember, the b's are assumed to be known and fixed. So if we know a0, we're going to know r00. So we have r00, we can then use the forward equations to get p10 and p01. And now we can move on to i = 2. We can actually use this equation we can get 1 over 1 plus s2 to the power of 2 is equal to and we can sub in these terms. These terms will just have the p1s, p10 and p11 which we will know already. They will have an a1, which we don't know, but that's what we will solve for. And they will have s2 which we see in the marketplace. So we'll get some quantity here which will depend on a1, we will know everything else and we will there for be able to determine, a1. And we can continue on, on this iterative manner working forwards to determine all the ai's by comparing the si's, which we see in the marketplace, using this equation to compare them with what the model says si must be and figure out what the ai's are. So, in this spreadsheet, we're actually going to perform such a calibration. We have here a 14 period model, you can think of periods corresponding to years and months, whatever you like. We have the market terms structure of interest rates, so we have 7.3% for 1 year or 1 period, 7.6% for 2 years, 8.1% for 3 years or 3 periods and so on. The important thing here is that we see the term structure of interest rates in the marketplace and it's given to us here in these highlighted cells. We need to assume some starting values for the a values. So we'll just put in the value of 5 for all of these values. The calibration's going to actually determine what the correct values of a should be so that the model prices of zero-coupon bonds or the term structure matches the market term structure. Right now for example, we can see here is the market spot rates, 7.3% up to 12.32%. Down here, we have our short rate lattice, this short rate lattice is the BlackDerman-Toy lattice. You can actually see that we're constructing this lattice using the b and a parameters from Black-Derman-Toy. Very important to note over here, we've actually fixed the volatility parameter b, we've assumed that b is a constant for all periods i, and we've set it equal to 0.005. We will certainly be returning to this issue in awhile. Now we've got the risk neutral probabilities which we've assumed to be q and 1 minus q and that they're both equal to a half. We compute the elementary prices down here using the forward equations, so we actually copy in our formula in this cell. And then we can drag the formula in this cell throughout the lattice to complete the elementary prices at all other nodes. So we have our short rate lattice, we have our elementary prices. Note that these elementary prices are a function of b and these a's, which at the moment are all set equal to 5. Below that, we can actually sum the elementary prices for each period, to get zero-coupon bond prices. So for example, if I sum these three guys here, I'm going to get 0.907. If I sum all of these, I'm going to get 0.709. So we're just using what we've seen in an earlier module. That is how we can use the elementary security prices to compute the zero-coupon bond prices. Once I have the zero-coupon bond prices in the model I can invert them in the usual way to get the spot rates in my models. So I'm seeing here that the spot rates are 5%, 5.01%, 5.06% and so on. So a very flat term structure where all the interest rates are approximately 5%, and this is following because I've actually assumed that the a's are all 5, and that's to begin with. So what I want to do is, is to do a simple calibration. What I want is, I want to choose the ai's, so that these spot rates down here, that I've highlighted in row 48, I want to choose them so that they match the market spot rates in row 4. Right now they certainly don't. So how am I going to force them to match that? Well I'm just going to use Solver. I'm going to compute the square differences between those cells, so this number here for example will be the difference between 5.04 which is the model spot rate and the market spot rate, which is up in cell I4. I'm going to square it and I get this number here. I'm going to do that for all the periods from i = 1 out to 14, and then down here I summed them. So here is sum of the squared differences, and I want this to be equal to 0. So this is what I'm going to do with Solver. I'm going to try and choose the ai's up there in row 5. I'm going to tell Solver to choose the a's in row 5 so as to minimize this sum here. I want this to as close to zero as possible. So we can do that in Solver. So let's do that. So we have Solver and installed Solver in Excel add-in. We've set the objective to be cell D51. And I want to minimize D51 by changing the variable cells C5 to P5. These are the cells that contain the A's, A0 up to A13. So let's run it. For some reason we're using a Mac here. Solver seems to be quite slow using a Mac. We can see the solution we're getting. I'm getting an objective function of 0.001. Now this looks pretty small. It looks pretty good, but actually I expect it to be even smaller, so I'm going to actually run Solver again and try to get a better solution. When I do this on Excel for Windows I don't need to run it again. I seem to get a very good solution when I run it in Windows. So as you can see I'm actually getting it much smaller now. I'm getting a number by 8.7 by 10 to the minus 11. And so if you noticed, the values of A have now changed. I no longer have 5 in all these cells, by running Solver to minimize the square differences between the market spot rates and the model spot rates, I have succeeded in matching the market spot rates to the model spot rates. So 7.3% let's pick a value. So 9.64% is the market spot rate. My model spot rate is 9.64% for the same period. So now the term structure of interest rates in my model matches the term structure of interest rates in the market. You might also ask the question at this point well we've just calibrated our model to the term structure of interest rates in the marketplace. Is that enough? Should we not also be calibrating to other security prices? And the answer to that is absolutely, yes, and we return to that issue in the next module.

## 016.Pricing in a BDT Model and Pricing in Practice

### 030. An Application  Pricing a Payer Swaption in a BDT Model

In the last module, we discussed the very important problem of model calibration using the Black-Derman-Toy model as our example. We saw how we could make sure that the prices of the zero coupon bonds in our model matched the prices of zero coupon bonds in the marketplace. We did this by selecting the parameters, the ai's in the Black-Derman-Toy model to ensure that the two sets of prices coincided. In this module, we're going to extend this example a little bit further. We're going to use our calibrated model to price payer swaptions. We're then going to change one of our fixed parameters in the model, recalibrate and price the same payer swaptions again and see what happens to the prices. This is important implications for the whole process of model calibration. In the last module, we saw how to calibrate the Black-Derman-Toy model to the term structure of interest rates. We're now going to actually use a calibrated Black-Derman-Toy model to price a swaption. We've seen how to price swaptions before and we're going to do so again. The difference now is that we're actually going to use a model, the Black-Derman-Toy model, that has been calibrated to the term structure of interest rates that we might see in the marketplace. We're also going to see what happens as we change certain parameters and then reprice the swaption. So, what we're going to do here is we're going to consider what's called a 2-8 payer swaption. So, this is some new terminology here, the, the word payer. So, payer refers to the fact that the owner of the option will pay fixed and receive floating. A receiver swaption, the owner of such a swaption would receive fixed and pay floating. So, what we have is a 2-8 pair swaption with a fixed rate of 11.65%. It's an option to enter an 8-year swap in 2 years time. The underlying swap payments are settled in arrears so the payments would take place in years 3 through 10. Each payment would be based on the prevailing short-rate of the previous year. So, we therefore need a 10-period lattice with one period corresponding to one year. Of course, in practice, you would have a much larger lattice with many periods corresponding to one year. But for our purposes, we will keep it simple with just a 10-period lattice and one-period corresponding to one year. We're going to assume initially that bi is a constant for all i and it's equal to b which is equal to 0.005. If you recall in the Black-Derman-Toy model, in the BDT model, we assume that rij the short rate of time i [unknown] j is equal to ai times e to the bi times j. So, we're going to assume here that the bi's are constant for all i, and that it's equal to 0.005. Later on, actually we'll change bi and see what that does to the swaption price. So, our calibration parameters are actually going to be the ai's. We're going to choose the ai's so that the term structure in our Black-Derman-Toy model, matches the term structure in the marketplace. And we actually saw on the last module how to do this. We did it using the solver in Excel, that was our lazy, easy way to do it. We could also have done it by using the forward equations, as I also described in the last module. So, returning to the swaption, we're going to assume a notional principle of $1 or maybe one million dollars. Let S2 denote the value of the swap at time t equals 2. We know how to compute S2 in any binomial lattice, we just discount the cash flows back from t equals 10 to t equals 2 using risk-neutral pricing. We also recall that it is easier to record the time key cash flows after their predecessor nodes and then discount them appropriately. So, this is why there would be no payments recorded at t equal to 10 in this swaption lattice that we'll see in the Excel spreadsheet in a few minute's time. Once we get back to time t equals 2, we have the value of the underlying swap. So therefore, the value of the swaption will be the maximum of 0 and S2. And then, once we have this at time t equals 2, we just work backwards in the lattice using risk-neutral pricing in the usual way to get the value of the swaption at time t equal to 0. When we calibrate to the 0 coupon bonds in the marketplace, we find the swaption price of $13,339 when b equals 0.005. So, in fact, in this case, I'm actually assuming a notion of one million dollars. So, I should have had 1 million here. When we change b, so here, b was 0.005. Now if we double the value of b to 0.01, we actually find a different swaption price, we obtain a swaption price of $19,497, which is actually approximately 50% higher than our original value of 13,339. Now, when we actually change b, by the way, to 0.1, we must remember to recalibrate our model. We have to recaliberate recompute the a values so that the term structure of interest rates in the BDT model matches the time structure of interest rates in the market. So, we see significant difference in swaption prices even though both models are either model with b equals 0.005 and the model with b equals 0.01 were calibrated at the same zero coupon bond prices at the same term structure of interest rates, we see very different swaption prices, $13,000 versus $19,000. So, this is not surprising. Swaption prices clearly depend on market volatility. The more volatile your market is or your model is, the more valuable swaption prices will be. And if you want to get some intuition for this, you can think of the following. The payoff of the swaption at maturity, as we said, is the maximum of 0 and S2. So, if you imagine increasing volatility, well then, what you are doing is you're increasing your upside. The more volatile the market is, the more upside you have in S2, the more spread out it is. So, you're getting more of the upside as you increase volatility but you're not getting more downside, a more negative outcomes. And that's because the negative outcomes are constrained by this value 0 here. You can never get something that's worth less than 0. So, you actually like volatility because you're getting better outcomes or better range of good outcomes with higher volatility, but you are not getting a larger range of poor outcomes, because you are constrained by the, this zero factor here. So, very loosely, that's why when you own an option you like volatility and we'll return to this again later in the course when we go back to the Black-Scholes model and discuss options on stocks. But back to here, so what we're saying is we shouldn't be surprised that the swaption price is increased as we've increased b from 0.005 to 0.01. If you recall, we said before that in the BDT model, log of rij is equal to log of ai plus bi times j. J is our random variable because j is the state at time i, and bi is multiplying j. So therefore, our b parameter is, if you like, a volatility parameter. And the higher the value of b is, the more volatile the short rate is, and therefore, we expect the swaption value to be higher as well. And indeed, that is what we have seen here. Now this, these observations have very important implications for the calibration, calibration process in general. We want our calibration securities to be close to the securities we want to price with the calibrated model. So, what do I mean by close? Well, I mean the following. Because a swaption, the, the value of a swaption depends on volatility. I would like the securities that I'm using to calibrate my mode, I would like their prices to also depend on volatility. In this example, we have not done that. We've only calibrated the model to zero coupon bond prices and they do not depend on volatility. The value of a zero coupon bond price is, can be determined from the term structure of interest rates we see in the marketplace today. And actually the volatility of that term structure does not enter into the pricing of these zero coupon bond prices. And so, I would say that zero coupon bonds are not really close to swaptions. I would think securities like caplets and flowlets are actually much closer to swaptions. And that if I was to calibrate a model to caplets and flowlets, then maybe I would actually get a more accurate price for my swaptions. We will discuss this further in the next module. So, here is our Black-Derman-Toy model again. We saw in the last module how to calibrate the Black-Derman-Toy model using Excel Solver. We've already gone ahead and done that here, so these are our market spot rates. We can imagine having observed these in the marketplace today, of course, these rates are much, much higher than you would see in the financial markets today, but that's fine. We can just assume that these are the actual rates that do exist today. We assumed and fixed a value of B equal to 0.005. So, I made the comment here that fixing the volatility parameter b, this is not a good idea if we wish to use the model to price fixed income derivatives that are sensitive to volatility. So, you can see that our objective function is very small. We've already done the calibration at this point, we see that the model spot rates actually match perfectly the market spot rates that we see up here. And we actually get a pair of swaption price of 0.00134. That's for a notional of $1, so if we multiply it by a million dollars, we get about, a note, we get a price of a swaption of about $13,000. So, we begin here at t equals 9 with the value of the swap. Actually, the last payment for the swap takes place at t equals the 10, but we record this t equals 9 so to be discounted. We work backwards until t equals 2 and we compute the value of the swaption. So, this value is equal to the maximum of zero and the underlying swap. Once we obtain that maximum, we work backwards in the usual way to get the price of the swaption. So, what's interesting here is I've highlighted the value of the swaption is $13,400 for a notion of 1 million and that's the value when we fix b to be 0.005. Over here, on this worksheet, I fixed b to be 0.01 so I've doubled it. Again, I've already performed the calibration so that you will see that the term structure of interest rates or if you like, zero coupon bond prices and the model, match those in the marketplace. And yet, now, I see a swaption price of $19,600. So, what I'm seeing is I, I can say that I've calibrated my model, my Black-Derman-Toy model to the marketplace but I've only calibrated it to the zero coupon bond prices in the marketplace. If I want to use my model to price swaptions, then I need to do a better calibration. I need to include more instruments in my calibration. I need to include instruments whose price depends on volatility in my calibration. So, the upshot of all of these is the following. If I use my calibrated model to price exotic, fixed income derivative securities, for example, a swaption, now in the real world, a swaption is not exotic, it's actually a very liquidly traded security. But for the purpose of this example, I can pretend it's an exotic security. So, if I use my model to price an exotic security like a swaption, I need to be aware of the fact that the price I get, very much depends on what securities I use to calibrate the model in the first place. I use zero coupon bond prices and I fixed certain parameters, i.e., b. If I actually use a different set of securities, maybe caplet prices o flowlet prices to calibrate the model, then presumably, I would get a different set of calibrated parameters and therefore, get a different swaption price. Users of these models, therefore need to be very careful about how they were built and how they were calibrated.

### 031. Fixed Income Derivatives Pricing in Practice

In this module which is our last module on fixed income derivatives pricing we're going to talk about the practice of fixed income derivatives pricing. We'll explain how it is really not much more than using observable liquid Security prices to extrapolate and compute the prices of non-observable security prices. We're going to discuss, again, the problem of calibration and how it is a difficult problem to solve in practice. So, in practice, more complex models than binomial models are used to price fixed income derivatives today. In fact, the models that are used today are a lot more complicated than the binomial models we've seen so far. However, the pricing philosophy is still very much the same. It works as follows. We specify a model under the risk mutual dynamics which we are calling q of theta and where theta is a vector of parameters that you need to choose. So, for example, the theta's could be the ai's and bi's that we have seen in the Ho-Lee and BDT models. So, we fixed our model. There is some unknown parameters theta. What we will do is we will price all securities with our new model using risk neutral pricing. And if you recall this is our risk neutral pricing framework. So, what we do is we say that Z t over B t where Z t is the price of the security in question, B t is the value of the cash account So that is equal to the expected value, conditional in time t information, under the risk neutral probabilities of the expected value of the security at time t + s divided by the cash account, plus all the intermediate coupons or cash flows that you receive between times t + 1 and t + s, again divided by the cash account value. This is our risk neutral pricing framework, we know that there cannot be any in the model. When we price all of our securities like this. So, that's step number two. Step number three is then to choose data so that the market prices of appropriate liquid securities agree with model prices of those securities. This is the model calibration procedure. And we've seen in the last module, some examples of how to do model calibration in the context of the BlackDermanToy model. And when our calibration securities [INAUDIBLE] coupon bond prices. The calibration problem typically requires minimizing a sum of squares of the following form. So remember, the Theta are the vector of parameters we want to choose in our model These could be the a i's or b i's in the black [INAUDIBLE] your [INAUDIBLE] model so the goal is to choose the thetas in such a way as to minimize the following. So we have a bunch of securities which are indexing by i here and we have a market price of the i security which is pi market and then we have our model price of the i security, pi model and this model price is calculated using this equation here, equation 14. This is our risk mutual pricing that we use in our model. Doing this ensures that our model prices are arbitrage free. So in our model, we can compute this price. We see this in the marketplace. And omega i is a weight, it's a positive weight reflecting the importance of the ith security in our calibration. Maybe omega i is large for some values or for some securities, and omega i is small for other values. Omega i could reflect, maybe, how certain we are about the market price that we see. Maybe we think this market price is stale, maybe it's a few minutes old, or maybe there's a wide bid ask on this market price, so we're not as confident of the true value of the security. Either way the omega i's can be used to reflect the importance of the i security in the calibration. We also have this additional term, which I won't spend too much time on. But, theta prev stands for theta of the previous calibration. So, the previous model calibration might have occurred the previous day or the previous hour or the previous half hour. What we want to do typically is make sure that our calibrated parameters don't move around too much. There are various reasons for this, but it helps to keep the model somewhat stable through time if we penalize Theta being too far away from the previously calibrated vector theta. And lambda will be a parameter that's greater than or equal to 0 which reflects the importance of this term to the overall calibration. Once this model has been calibrated we can use it to hedge and price more exotic or illiquid securities. One problem, however, is that this calibration problem is often very difficult to solve. This is typically a known convex optimization problem. Well, if you don't know what I mean by nonconvex basically the upshot of that is that there will be many local minima. And it would be very hard to find the true solution to this optimization problem. As market conditions change we often find that we need to recalibrate frequently, often many times a day. If the model wasn't right then actually you would only need to calibrate once. So, in fact your model typically in practice is not right it's never even close to being right. We always need to recalibrate it. So, this is very different to the situation on the physical sciences for example. Or typically if you have the right model then you don't need to recalibrate it very often. In finance unfortunately you do. So, derivatives pricing in practice then is little more than using observable market prices to interpolate and extrapolate to price non-observable security prices. But risk-neutral pricing at the model level at least implies that we can extrapolate and interpolate in an arbitrage-free manner. And in case you're wondering, we haven't said anything about the true probabilities in this section. We've discussed fixing con derivatives up to to now, and we've completely ignored true probabilities. We've only discussed risk-neutral probabilities, Q and one minus Q, and in fact in the binomial model, we set them equal to a half. So, does that mean that the derivative prices and practise don't depend on true probabilities? Well that is not true. Of course they depend on practise and the dependence actually enters into the calibration process because the true probabilities will enter the market's perception. Of market conditions, economic conditions, political conditions and so on. And so, the markets perception of the two probabilities will certainly enter in here into the market prices of these securities. So, implicitly when we do this calibration we're actually Including the market's views, the market's probabilities, the market's level of risk aversion, into the entire derivative's pricing exercise.

## 017.Modeling and Pricing Defaultable Bonds

### 032. Modeling Defaultable Bonds

This is the first of two modules where we will introduce you to the modeling of defaultable bonds. In this first module, we will introduce a modified binomial lattice for pricing short rates with default. We will show you how to price zero coupon bonds that are default free and zero coupon bonds that are, have a default and have a recovery associated with them on this binomial lattice. A defaultable bond is characterized by a coupon payment c, the face value F and the recovery value R, where R is defined as the random fraction of the face value recovered upon default. We also have to specify the probabilities of default. When would the default events happen, what is the rate at which they're going to happen, and so on. As before, we will work directly with the risk neutral probability, Q. We will model the term structure of default that is the time dependence of default probabilities using the one step default probability h of t. Which is defined as the conditional probability that the bond will default over the interval t to t plus 1, given the information at time t. So, Ft will represent the information at time t. This is the conditional probability that the bond is going to default over the next period. As in the case with other fixed income securities, we are going to calibrate age of t to market prices. And we will modify the binomial lattice to include defaults. Just as a review, let's look at the binomial lattice for short rates. The nodes in this lattice were labeled i and j. i went from 0 through n. G went from 0 through i. So, at time zero, you have one node. At time one, you have two nodes. At time two, you have three nodes and so on. So, each of these nodes were being labeled i, j. There was a short rated, all of these nodes r, i, j. And the transition probability was given by the binomial lattice probability. So, the, at time i plus 1, you could only reach states j and j plus 1. The probability that you went from node i, j to node i plus 1, j plus 1 was qu. The upper probability still is qu. The probability that you went from node i, j to node i plus 1j, it's going to be q of d. And the probability of reaching any other state is going to be 0. This was the short rate lattice that we worked with when we were constructing, the short rate lattice for default free bonds. Now, in order to model default, we are going to split the node i, j by introducing a new variable that encodes whether or not default has occurred before date i. i, j, 0 will denote the fact that the state is j on date i, and the default time tau is greater than i. Which means that that time i or date i, the default has not happened. i, j, 1 will encode the fact that the system is in state j on date i and the default has already occurred at some point before i. And when I say before i, I mean it includes i as well. Now, for the split lattice, for these split nodes, I'm going to tell you what the transition probabilities are going to be. Again, these transition probabilities are going to be risk neutral transition probabilities. So, lets work through this figure slowly. Here's my state at date i. And here, the possible states at date i plus 1. So, here is date i plus 1. When we looked at the short rate lattice, we had nodes i, j. Now, we've split each of those nodes into two nodes, i, j, 0, means default has not occurred, i, j, 1, which means default has occurred. So, the red nodes here, indicate the fact that these are the nodes associates with states where the default has not occurred. And one, the black nodes are referring to the fact that these are the states at which the default has occurred. So, what are the transitions out of the state i, j, 0? This is the state where the interest rates are in state j, the date is i, and the bond has not yet defaulted. Then, the probability qu, you can go to stage j plus 1. At that point, there are two possibilities, either you can default or you do not default. So, up here, it's qu times 1 minus hij, is the probability that you go to state j plus 1 without default. qu times hij is going to the probability that you go to state j plus 1. And now, you have defaulted. So, instead of going, going from a red node, now you're going to a black node. What about the down probabilities? They are the same. It's going to be qd, times 1 minus hij. This is the probability that you start from state i, j, 0. And go to state i plus 1 j 0, meaning no default and no default at time i plus 1 as well. What about the probability that you default at time i, it's going to be qd, times hij. Okay? So, in this table emphasizes the same thing. Qi plus 1 s eta, eta is the label for whether there is a default or not. s is the label for the state. You can only go, if you go to stage j plus 1 and eta equals 1, it means default the probability is quhij. If you go to stage j plus 1 eta equals 0, which mean no default, the probability is qu 1 minus hij. This is exactly the same probability that I just wrote on the figure. What happens with the transition out of the default state? So, the transition from the default state are actually very simple. So, once the bond has defaulted, we are going to assume that there is exactly one default event between dates 0 through n. So, once a bond has defaulted, it's always in the default state. So, from this particular default state, you can go to state j plus 1 and default and you can go to state j and default. You can never go to the non-default state. So, notice that there are no blue arrows or black arrows going to the state with no default. What is the probability of going to the state j plus 1? It's the same as the short rate probabilities. So, this is going to be qu and qd. The hazard rates or hij's, which are the conditional probabilities of default, are not going to play a role in this transition, because once the bond has defaulted, it never reappears and always stays in the default state. The conditional probability of default, hij, is state dependent. It's labelled by both i and j. And therefore, this is date i and this is the state on that particular date. Okay, once we have specified the transition probabilities, we can now start thinking about how we are going to price simple securities using this binomial lattice. And also, how we can use these simple securities to calibrate both the intrastate lattice, as well as this conditional probability hij. So, the first thing we're going to start with our default-free zero-coupon bonds. The default-free zero-coupon bonds with expiration capital T, pays $1 in every state on the expiration date capital T. These are default-free, so no default is possible. Let Z, super tij eta denote the price of the bond, maturing on date i in node ij eta. When a default-free zero-coupon. just by context, this is what I mean here. So, it's the same story. Earlier, we had one node. Now, we have two nodes. This is i, j, 1 and this is i, j, 0. I need to specify what is going to be the price off of a zero-coupon bond in both of these states. The first thing we recognize is the fact that default events do not affect the default-free bonds. So, whether the, the default event has happened or weather the default event has not happened, the price of a default-free zero-coupon bond is going to remain the same. So, the price of that bond, in both of these states, are going to be exactly the same. So, ZTij1 is going to be the same as ZTij0. And, we're going to drop the state corresponding to default, since it does not matter to a zero-coupon bond, and just call it ZTij. When we do risk neutral pricing for this default-free zero-coupon bond, it's the same as that was seen in the terms structure modules. ZTij is simply 1 over 1 plus rij. This is the short rate in node ij. quZTi plus 1j plus 1qdZTi plus 1j. So, this is the expectation of the prices once time step later according to the risk-neutral probabilities, discounted back to time i. And as before, as you saw in the modules corresponding to term structures, we can calibrate the short-rate lattice, that is, we can compute qd, qu and rij, using the prices of this default-free zero-coupon bonds and other default-free instruments. In the modules, we emphasize the fact that there are too many variables, and often one sets qu equals to qd equal to a half, and then calibrate the rij to make sure that prices of all the default-free instruments work out to be correct. What about extending this idea to defaultable zero-coupon bonds? So now, the bonds that are, that we are considering, have the possibility that they are going to default. And when they default, we're going to start with the instrument that pays no recovery. So, what does it mean? It means that these bonds pay $1 in every state at the expiration, provided default has not occurred on any date T less than or equal to T. If a default occurs at some point, the bond pays 0. There's no recovery. Again, let's see what the pricing works out to be. Z bar T i j eta will denote the price of a defaultable zero-coupon bond maturing at, on date T in node i j eta. Since there is no recovery, we know that as soon as the bond gets into a default state, its price is going to be zero. The moment a default occurs, you don't get anything, and therefore, the no arbitrage price must be 0. So, ZTij1 is always going to be 0 for all default notes ij1. What happens to the price in the new default node? Now, we can use risk-neitral pricing. We know what happens to the transitions under the risk-neutral probability. So, the price at iT, iJ0 is going to be 1 over 1 plus rij. This is simple discounting. So, there are four possible states that you can go to. You can go to state i plus 1, j plus 1 without default. You can go to state i plus 1 j plus 1 with default. You can go to state 1 plus 1j without default. And you can go to state i plus 1j with default. What are the corresponding probabilities? It's qu1 minus hij, qd1 minus hij, quhij, and qdhij. We already know that if you're going to a default state, the price of a zero-coupon bond with no recovery is going to be 0, so this term drops away. This other term also goes away because it's also a default state. So, essentially the risk-neutral pricing for a zero-coupon bond with no recovery is, take the prices one times step later and discount them using the risk-neutral probability. But the risk-neutral probability now has two components. One that corresponds to the interest rate dynamics. And another that corresponds to the default dynamics. Once you have the prices for all defaultable zero-coupon bonds with no recovery, you can can calibrate hij using those prices. Now, we want to interpret the prices of defaultable zero-coupon bonds with no recovery, and try to understand or give an interpretation for what hij is. The risk-neutral pricing, by ignoring the two, default state. Essentially happens to be Z bar ij0 is 1 minus hij divided by 1 plus rij qu zt, i plus 1, j plus 1, no default, qdZT i plus 1j, no default. This fraction here, can be approximated by e to the power minus rij, hij. And the quantity in the bracket here is actually an expected value with respect to a different probability match up which we're going to call the default free risk neutral probability measure. What do I mean by default free? What I mean is that all the default rates have been pulled out. So, the price of a defaultable zero-coupon bond is set by discounting the expected value by rij plus hij. And that's just coming from the expected, this expectation involves both the rates. So, hij has the interpretation of a one median credit spread. It's state dependent, it's time dependent, and it's a credit spread because if the bond was not defaultable, then I would have discounted only by rij. But because the bond is def, defaultable, I'm going to discount the price by extra interest rate which is hij, which is exactly the interpretation of a credit spread. The conditional probability of default hij is also called a hazard rate. It's the probability of default given no default has occurred up to time i. Now, let's extend this to the notion of recovery. I'm going to assume that the random recovery, R tilde, is independent of the default and interest rate dynamics. And let R denote the expected value of R tilde. As before, let Z bar tij eta denote the price of a defaultable bond maturing on date i, in node ij eta. But now, I'm going to emphasize the fact that this is after recovery, after whatever recovery amount has been paid. It's the x dividend or the x coupon, here's it's the x recovery price. Again, once the recovery has been done, there are no cash flows available from these bonds. We already know that Z bar ij1 is going to be equal to 0 for all the default notes. What about the no default nodes? The price there, Z bar tij0, is going to be the discounted value of the prices in the future nodes as before. But now, if a default occurs, you get an expected value R, which ends up playing a role. And therefore, the new risk-neutral pricing for what happens to zero-coupon bonds which are defaultable, but have a recovery, is that this extra term shows up. And we'll stop here. And in the next module, we're going to talk about how to price general bonds and how to use these general bonds or coupon paying bonds to calibrate the hazard rate.

### 033. Pricing Defaultable Bonds

This is the second module on pricing defaultable bonds. In this module, we're going to extend, the idea that we had developed in the previous module, to pricing coupon bearing bonds, and also show you how these are done in practice using several bonds and calibration on an Excel spreadsheet. In this module we're going to assume that the hazard rates h i j are state independent. This ensures that the default probability is going to be independent of the interest rate dynamics. It'll be easier for us to keep track of the events by defining a quantity called q t which at the risk mutual probability that the bond survives until date t. A simple recursion defines what q t is going to be. So look at q t plus one, which is a probability that the bond survives up to date t plus 1. This is going to be the probability that the bond survives up to date t, and the conditional probability that the bond survives one extra period which is 1 minus h t. And therefore you can write q t plus 1 as just a product of k going from 0 to t, 1 minus h k. Let I t denote the indicator that the bone survives up to time t. So I t is going to be 1, if the bond is not in default at time t, and its going to be 0 otherwise. Then the indicative variable that the default occurs exactly at time t is going to be the difference between I t minus 1 and I t. I t minus 1 equals 1 and I t equals 0, tells me that exactly that the bond defaulted at time t. From the definition of I t, it immediately follows that the expected value, under the risk-neutral measure of I t is exactly equal to q t. Once we have this indicator val, variable I t, we can define various events using this indicator value, variable. And it's going to be easier for us to keep track of various events that happen to the bond. We're going to assume that the random recovery rate, R tilde, is going to be independent of the interest rate dynamics under the risk neutral measure Q. And we're going to let R, without the tilde, denote the expected value of R tilde under the risk measure, risk neutral measure Q at time 0. Recall that R tilde is a fraction of the face value F 8 on default. Here are the details of the pricing. We are going to assume that the current date is equal to 0. t 1 to t n are the future date at which the coupons are going to be paid. The coupon on date t k is paid only if i t k, the indicator vari, variable that indicates whether the bond is in default or not, is equal to 1, meaning that the bond is not in default. Therefore the random cash flow associated with the coupon payment on date t k is c times I t k. The randomness comes from the fact that although the coupon payment is deterministic, the fact whether the bond is in, not in default or is in default, is going to be a random quantity. The face value F, is going to be paid on date t n only if I t n is equal to 1. Therefore, the random cash flow associated with the face value payment on date t n is going to be a deterministic quantity F times the random quantity I t n. The recovery itself is random, so recovery at date t k is going to be R tilde t k. The random recovery rate times the face value F. But this random quantity is going to be paid only if the default occurs on date t k, which have been indicator vari, variable I t k minus 1 minus I t k. Therefore, the random cash-flow associated with the recovery on date t k is going to be R tilde t k times F times I t k minus 1 minus I t k. Now that we have all the random cash-flows associated with a bond, a defaultable bond with some random recovery, we can now price this bond by just discounting all of these random cash-flows with respect to the risk neutral measure, and that's what we're going to do on the next slide. Let B t denote the value of the cash account at time t, then the price at time 0 of a defaultable fixed coupon bond is given by, the expected value under the risk neutral measure of the random cash-flows discounted by the cash account. So C times I t k is the random cash flow associated with the bond, with the bond coupon payment, it has to, and it occurs at time t k, therefore it has to be discounted by the cash amount at time t k. F times I t n is going to be the random cash flow associated with the face value. It's going to have to be discounted, so there's no b t, but it's just 1. And, at the rate b t n, R tilde t k times F is going to be the random cash-flow associated with the recovery at time t k, so it's discounted by B t k, but this extra variables has the default, of course at time t k. Now, we have, we have assumed that the default is independent, of the interest rate dynamics. So the first expectation, I can split it up into two expectations. This expectation is the expectation of the default, the second expectation is just the expectation with respect to the risk neutral dynamics of the interest rate, or the short rate. And this split, happens, only because I've assumed that the default and the interest rate dynamics are independent. Again, I'm going to split up the next term into two terms. One that corresponds to the default and one the other one that corresponds to the interest rate dynamics. And finally with the same, same thing with the last term, this corresponds to default. And this other one corresponds to the interest rate dynamics. [SOUND]. Now we know from the definition of the indicator function that I expectation under Q sub 0 of I t k is nothing but Q t k. In the expectation under Q sub 0 of I t n is nothing but Q t n. Similarly, this quantity expectation under Q sub 0 of I t k minus 1 is Q t k minus 1, and E sub 0 super Q of I t k is Q t k. So the, all of these are just coming from the definition of the indicator function of the expectations of that indicator function under the risk neutral measure. What happens to these quantities? These are nothing but the prices of the zero coupon bond. So that particular quantity is nothing but the price at time 0 of a 0 coupon bond that pays $1 at time t k. This quantity over here, is the price of the 0 coupon bond at ti, that pays $1 at time t n. And similarly again, this is the same repeat, it's a 0 coupon bond paying $1 at time t k. We can further simplify this exp, expression. This quantity is nothing but the discount rate up to time t k, discount rate up to time t n, and discount rate up to time t k. Here's a formula that tells me what the price is. The only thing that is going into this formula are the discount rates, which are determined by the short rates, and the probabilities of default that are going to be determined by hazard rates. So in principle, if I had the prices of lots of defaultable bonds with fixed coupon payments, I can infer from there what the hazard rates are going to be. So my story is going to be, I'm going to assume that the interest rate is dynam, is deterministic and known. We could have calibrated this and you have done this in another module. To keep the story simple and focus on the hazard rates, we are going to assume that the interest rate dynamics are going to be deterministic. If that is deterministic, then I can write, the model price of a defaultable bond as a function of the hazard rates. I'm going to assume that I have some observed prices of the market bonds and I can use those prices, and compare it with the model price, get an error. So here's the market price for the Ith bond. Here's the model price for the Ith bond. I compare the two, take the square. That is going to be the error that I'm going to be making on the Ith bond. And I take the sum over all possible bonds, that's the total error, and the calibration problem that I'm going to be facing, is to minimize over H F H. And I'm going to show you this, using a numerical example in the associated spreadsheet. So here's a simple spreadsheet that I'm going to be working with. In this sheet, I'm just, I'm going to assume, that the discount rate is given to me. So the discount rate is assumed to be 5% per annul, deterministic. And from that interest rate, I can compute out what the discount rates are going to be. For the six month discount rate, it's just going to be half of this. So if you look at the formula, it's just going to be 1 plus R F divided by 2 times the number of half year periods that have elapsed. So this is simple, this is something that we have done before. Now, in this particular worksheet, I'm going to assume that the hazard rate, which is going to be the six month hazard rate, is fixed at 0.02. What does that mean? So right now, it's time 0. So the survival probability is 1 because the bond exists. Now from this survival probability, I want to compute the survival probability and the default probability in six months from now. The hazard rate of time, 0 is 0.02, so the probability that I default, in the next six months, is simply going to be the probability, survival probability times the default probability. The conditional probability, of default is the hazard rate. The probability that I have survived right now is 1. I take the product of that, that gives me the default probability. What is the probability that I survive, it's the probability that I'm surviving right now times 1 minus H, where H is the hazard rate. That gives the survival probability in six months. What is the survival probability in 12 months? It's, again the same thing, which is 0.98, which is the survival probability at six months times 1 minus the hazard rate. What is the default probabilitiy? It's the surval probability times the hazard rate. So all of this table has been computed using, the survival probabilities and default probabilities form the hazard rate. Now let's see what happens to a coupon. So here is a bond, which is a one year bond so it expires in one year. It me, it has two coupon payments and the face value payment. I'm going to assume here that the face value is 100, and the coupon is 5%, therefore the coupon is 5. The recovery rate is 10%. So what happens? So the coupon and face value payments are going to be 5 in six months and 105 in one year. The recovery is going to be 10% of the face value, so it's going to be $10 if a default occurs in six months. It's going to be another $10 if a default occurs in 12 months or a year. How do I compute what is the expected value of the payments? So if you look at this formula, what's going to happen? If the bond survives in six months, you're going to get the coupon payment. So it's going to be 5 times the survival probability, which is 0.98, plus 10, which is the recovery times the default probability 0.02, and this happens in six months, and therefore you have to discount it back using the discount rate, which is 0.98. Similarly, if you look at this one, it's the same formula again. It's the coupon plus 105, which is going to be paid only if you are going to be surviving at time 12 months or in 1 year. So it's H8 times C8. And, in the case that you default, it's going to be I8 times D8, which is the default probability times the recovery. It has to be discounted back. So now you're going to use the discount rate of 0.5. Sum all of that, you end up getting what the price of this particular bond is going to be. Similarly, if you look at, here is another example of a bond, it's a two year bond with 8% recovery, same story. [SOUND]. This should be 2%, so that coupon payment is 2%. So therefore, here are the coupon payments. Here are the recovery rates. If you look at the formula, it's exactly the same. Coupon payment times the probability of survival, recovery times the probability of default, discounted back to time 0. Sum it all up, and you end up getting what the price of this bond is going to be. Great. So we know how to price bonds, given the calibrate, given the hazard rates. Now I'm going to show you the next spreadsheet, what happens when you calibrate. So here, what I've done, is I have created for you, same bonds as was there on the last sheet. I took the true price of the bond, and to it, I added a small random quantity. I took the true price that was there and then I added about $0.10 of randomness. You can play with this and see what happens when you add more randomness. Here, I'm assuming, just to keep things simple, that the hazard rate, the six month hazard rate of default is going to be constant for a year. So what I've done is that, in the first year, the six month hazard rate is an unknown quantity, but in the next six months it's exactly equal. So if you click on this, I've just made it equal to A6. Similarly, over here I've made it equal to A6, A6 and so on. Once I know the hazard rate, I can compute the survival probability to the default probability, and I can compute the model price. This is the model price that has been computed using whatever these hazard rates are going to be. Now, what I'm going to do, is I'm going to compare the model price with the true price, compute the error. This is nothing but the model price minus the true price squared. I have five different bonds. I'm going to sum up all of those errors. And this is going to be the sum of the 5 errors. Add them up, and then I'm going to minimize it. So, if I use solver, what I'm trying to do is, before I go to solver, let me randomly create some instances here. [SOUND]. So there's this a random instance of what happens to the boat. Now I'm going to go to Solver. And if you look at Solver, all I'm trying to do is, minimize the error of J21. Which is this error quantity here. By changing the variable cells, A6, A8, A10, A12, and A4, and the reason, I left off A16, is because this is the hazard rate that's going to be in the future and it's not going to matter. The A7, A9, A11, A13, and A15 have been left off because, I'm just assume that this is going to be equal over the entire year. And the reason I made that assumption is because I only have bonds that I, that are expiring in the years, and not at six months. And therefore I will not be able to calibrate the next six months of asset rate. So we minimize that. We hit solve. And, it found a solution, and the minimum error it found was 0.01. And, the prices that you end up getting is pretty to what you started of with. It's slightly different, it's 0.0201 instead of 0.002. Here it's just 0.19 and so on. And that happens just because the error is small. Some of the bonds, it's able to compute it correctly, some of the bonds it's it has small errors. And so the overall error turns out to be 0.01.

## 018.Credit Default Swipes

### 034. Credit Default Swaps

This module is the first of two modules on Credit Default Swaps. In this module, we are going, we are going to introduce you to the details of what a Credit Default Swap is. Talk about, on an intuitive level, of how Credit Default Swaps give you some information about the default probability. And how these quantities can be used for hedging, can be used for investment, can be used for speculation. And how Credit Default Swaps have played an important role in the financial crisis and also the sovereign debt crisis that is currently going on in Europe. The seller of a Credit Default Swap, CDS, agrees to compensate the buyer in the event of a loan default or some other credit event on a reference entity. The reference entity could be a corporation, it could be a sovereign that's a country, in return for periodic premium payments. So, the dynamics are as follows. This is what happens to the buyer. So, the buyer pays periodic premiums and what is a premium? It's some coupon rate S, which is also called the spread. d is in a year, it's a fraction of a year. So, d times S is the total coupon that has been accumulated over the years. N is a notional principal. So, there's a certain amount of principal that has been protected. In order to protect that principal, you have to pay a spread or a coupon S times N. It has to be paid every d fraction of the year. So, every coupon payment is going to be d times S times N. And this keeps on going until some kind of a credit event happens. Maybe the corporation defaults on the bond, maybe the country is not able to make an interest payment, and so on. It's, we going to talk about credit events later on and talk about the fact that defining whether a credit event has happened or not in itself, a difficult problem. So, once that credit event happens, two things happen. This credit event has happened somewhere in between two coupon payments. There should have been a coupon payment there. There should have been a coupon payment there. So, the credit event happened right in between these two coupon payments. So, at the next coupon payment date, the buyer has to pay the accrued interest over this interval . And I'm showing this with a smaller arrow to suggest that the accrued interest is actually less than the full coupon payment. On the other hand, the seller, the one who decided to sell the protection on this underlying credit event, after the credit event has happened at time, at the next coupon date, the seller has to pay 1 minus R, where R is the recovery rate, times the notional payment, N. Because the buyer pays premiums, this, the premium payments are sometimes called the premium leg of the CDS. And because the seller always pays the amount only on default, this is also called the protection leg. Here's a simple numerical example. So, consider a hypothetical 2-year CDS on a notional principal N equal to $1 million. And the spread S equal to 160 basis points, so just about 1.6%. And lets assume that the payments are quarterly. Suppose a default occurs in month 16 of a 24-month protection period. And the recovery rate at that time is 45%. And now, let's understand what happens to the payments of the buyers and the sellers. The buyer pays premiums, so he pays premiums at month 3, 6, 9, 12, and 15, and this is going to be S, the spread, times the notional principal of $1 million divided by four. Why? Because these are quarterly payments, so it's 1 4th of a year. So, the payments in all of these months is going to be $4000. Now, here's month 15. The next coupon is going to be on 18. But in month 16, the default has happened. So, this is the period over which the interest has accrued. So, the accrued interest that I have, that the buyer has to pay in month 18, is just 1 3rd of 4,000, so it's $1333.33. What about the payments from the protection's seller? Nothing paid up to month 15, because the default has not happened. Default happens in month 16 and month 18, which is the next coupon date. The seller has to pay 1 minus R times N. R was 45%, therefore, 1 minus R is 55% of N, which is $550,000. This is the total protection payment. Some other names for these payments. We've called them premium payments. We have called them, another name for the same payment is fixed leg or the fixed payments. Because the premiums are fixed, except for the accrued interest amount. The name for the protection sellers payment is also sometimes called a contingent leg or the contingent payment because it's contingent on a default happen. So, the basic model for the CDS cash flow that we're going to be using in this module is what we saw in this example. There will be a faction, delta, which is a fraction of a year, times k, would be the times at which the coupon payments are going to happen. Delta typically is 1 quarter, that is quarterly payments. And the dates of the payments are also set. The March 20th, June 20th, September 20th, and December 20th. If the reference entity is not in default at time tk, the buyer pays the premium delta which is the fraction times S, which is the spread times N which is the notional principle. If the reference en, entity defaults at some time tao between tk minus 1 and tk, the contract terminates at time tk. So, in the example, the default time was 116. This was between the two coupon payments at month 15 and month 18. The contract terminates at time 18. The buyer appraised the accrued interest over whatever fraction is left over. So, one month was what we did in the numerical example. And the buyer receives or equally the seller pays, 1 minus R times N where R denotes the recovery rate of the underlying. We are going to be working with this basic model to price and understand what is going to happen to the CDS sensitivities. But the details behind CDSs are enormous. they have been standardized by the International Swaps and Derivative Association, ISDA, in 1999. There were changes made in 2003. Then again, changes were made in 2009. And may yet again, changes be made, once if CDSs become exchange trader. And the reason there are so many different details in a CDS contract is there are many difficult issues. How does one define that a credit event has occurred? was the interest payment just late, did it not occur at all? It's a problem. How does one determine the recovery rate? there's often litigation, there's delays and so on. So, we're not going to be worrying about that in this module. We are going to assume that the recovery rate is somehow known. And we're going to price assuming that this recovery rate is known. But also many, many details. How is the spread set? How is it set for junk bonds versus investment grade bonds? What about countries? How is the spread set for countries? When is the coupon payment done? In advance or in arrears? How is the spread quoted? Is the spread quoted in terms of par spread, meaning the value that makes the net value the CDS equal to 0, or some other standardized spread. All these details are important when you talk about particular CDS contracts. But in order to understand the basic mechanisms of how CDSs work, the basic model that we have introduced is sufficient and it highlights all the main features. So, we're going to focus on the basic model to illustrate the details of pricing and the sensitivity to hazard rates, which are the probabilities of default. Later on, in the next module, I'm going to show you that the CDS spread, S is approximately 1 minus R times h, here R is the recovery rate and h is the hazard rate. So, for a fixed value of R, the CDS spreads are directly proportional to the hazard rate h. And the hazard rate is the conditional probability of default. So, you will end up getting that the conditional probability of default is approximately equal to S divided by 1 minus R. And therefore, CDS spreads end up giving you a very good handle on the probability that a particular company or a particular country, or a sovereign, is going to default on the next period. So, here, just as an illustration, I'm showing you what happens to the fove, what happened to the five year CDS spread for Ford, GM and AIG in the first nine months of 2008. The, this data up here, is all in basis points. So, it started around, a thousand basis points, and it went, oh, it started rising as the dates went by. And it didn't, neither of these companies actually defaulted. But the probabilities of default are going very high because the spreads are going high. AIG went all the way up to 3500 basis points before coming back down because this is where bail out event started to happen. The only idea that I wanted to take away from this picture is the fact that CDS spreads react to news events. AIG was very low. And then, suddenly, it started to shoot up because there was feeling in the market that the default is going to happen. And using the formula that h is approximately equal to S divided by 1 minus R, we can back out what is the probability of default from the spread rates. In this slide, the y axis is in percentages and not in basis points. [SOUND] And it gives you a sense of the credit worthiness of different countries. So, if you look at Greece, Greece, all the way, went up to 25% default on around, 20, 25% spread around January 12th. So, if the recovery rate is, let's say, approximately 50%. Then, h, which is S divided by 1 minus R. Will turn out to be, approximately a 50% default probability. So, the, the market taught that the probability that Greece is going to default is going to be very, very high. The next one over is Portugal, but it's only at around 1.5%, which is the period over here. And Germany which is exactly flat down here is pretty close to zero. And so, in some sense its going to be considered the most safe or risk free of the countries. Just to give you a sense of what the development of the applications of CDS, I'm going to trace some of the history. The development of the modern merger CDS is credited to Blythe Masters of JP Morgan. It was created in 1994 to cover JP Morgan for the $4.8 billion credit line that it had issued to Exxon to cover the possible punitive damages in the Exxon Valdez spill. So, after extending the credit line, JP Morgan protected itself by buying protection from the European Bank for Reconstruction and Development using a CDS. The CDS market, since then, has grown tremendously. By the end of 2007, the CDS market had a notional value for 62 trillion. Since then, things have become better. The DTCC estimates of the gross notional amount, gross years stands for the fact that after netting of, off setting CDS agreements, the notional amount in 2012 was about 25 trillion. So, 2007 was before the financial crisis, 2012 is after the financial crisis and things have started to come down. CDSs is where initially developed for hedging. they allow to hedge concentrations of credit risk privately. So, if, take the example of JP Morgan, Exxon. JP Morgan makes a loan to Exxon. It wants to protect itself. So, there are two possibilities. One, it could write the loan off to somebody else, in this case, the European Bank for Reconstruction and Development. But that would mean that it would have to inform Exxon that the loan has been written, written to another corporation. That might affect the relationship of JP Morgan and Exxon. Instead, you could construct, you could create a CDS contract and effectively still remove that credit off of your balance sheet. you can create, you can hedge credit exposures when no publicly traded debt exists. And this is because CDSs can be written on anything pretty much, and it's a contract, it's not really a bond or a cash bond. And therefore, you can use this construct to hedge against situations where bonds, or publicly traded debt, is not available. Although, CDS can be used to protect against losses, it's very different from an insurance contract. It's a contract that can be returned to cover anything. You can buy protection even when you don't hold the underlying debt. In order to buy insurance, you have to hold the underline quantity. To buy the insurance on a house, you have to be the owner of the house. To buy insurance on a bond, you need to hold the bond. You can buy a CDS on a bond without even holding the bond. CDS is easy to create and until recently completely unregulated. And because of these reasons, investing, and in some cases, speculation, became the main application very soon. CDS has provided an unfunded way to create credit risk. So, in order to take a credit risk on a particular company, you either have to take by the bond or you have to short sell the bond. Now, short selling bonds is very difficult. On the other hand, by writing a CDS from a particular company, you can expose yourself with a credit risk. You can tailor the credit exposure to match the precise requirement. This is because CDS is a contract and you can precisely define the contract that you want. CDS has allowed you to take view on the credit quality of the referenced credit. If you think that the credit quality is going to go down, you're going to buy protection. If you think that the credit quality is going to go up, then you're going to sell the protection. So, in both directions you can take a view, a positive view or a negative view. Buying protection, which means that when you have a negative view in a market, is often easier than shorting the asset. So, CDSs are became the real easy way of taking negative bets on various corporations. Another way CDS has started to be used is to arbitrage between the reference bond and the CDS price. It's not coupon, but a reference bond and the CDS spreads, gave another opportunity to find an investment opportunity to make the difference. CDSs have been blamed for the financial crisis and the debt crisis. And there are many reasons why this happened. CDS positions are not transparent. The riskiness of financial intermediaries, therefore cannot be accurately evaluated, because they don't, these positions don't show up on a balance sheet. And because of that, because of the fact that you could not accurately evaluate the riskiness of financial intermediaries, it threatened the trust in all counter parties. Since no one knew who faced losses when a crisis event happened, all the counter parties were suspect and entire trading came to a halt. CDS were treated on an OTC market and because of that, because impossible for any dealer to know what previous deals a customer had made. Resulting in situations where some dealers could make lots of CDS deals without putting up enough collateral. So, AIG was able to leverage its high credit rating to sell approximately $500 billion worth of CDSs, without putting up the enough collateral. Because it was in the OTC market and because they were, because these trades were opaque, it allowed a small number of CDS traders to take on huge amounts of risk. And it also allowed them to be very severely interconnected in terms of their obligations. And as a result of this interconnectedness, the dealers led to worries about contagion. CDSs also have been blamed during the financial crisis to adversely affect the cost of borrowing of a firm in a country. And recently, more so in the European debt crisis, CDS have been blamed for the fact that the cost of borrowing of countries have gone tremendously high. So, the story here is that speculated purchase CDS, without holding the underlying debt, sometimes called a naked CDS. Once a lot of these speculators actually start buying these naked CDS, this drives the spread higher. And when the spread goes high, because the market perceives the spread as the riskiness of a particular company or a particular country, the firms start appearing risky. And the cost of borrowing of the firm increases. The cost of borrowing of the sovereign increases. And this can lead to collapse. Various policy decisions have been made in the recent past to try to correct all of these problems. Try to get CDS positions and balance sheets. Trying to move the CDS, at least, to a clearing house. And then, to an exchange credit situation. this allow naked CDSs. Many of these are things that are in, in place, some of them completed, some of them are still being discussed. But CDSs have played their role and will, unless something is done, will continue to be a risky part of the economy.

## 019.Pricing Credit Default Swaps

### 035. Pricing Credit Default Swaps

In this second module on credit default swaps we're going to introduce you to a very simple pricing formula for credit default swaps, and then using this simple formula I'm going to show you how you can price CDSs on a spreadsheet. In this module, we are going to start with a very simple CDS pricing formula. The value of the CDS to a buyer is going to be the risk neutral value of the protection minus the risk neutral value of the premiums. We're going to assume that the default event is uniformly distributed over the premium interval delta. So let's walk through each of the pieces that go into constructing the value for the CDS. The risk-neutral value for single-premium payment on date t k, is going to be delta times S. Delta is the period, times S, which is the spread, times N, which is a notional amount, times the expected value under the risk-neutral measure at time zero, of I t k divided by B t k. Recall. I t k is the prop, is the indicative function that the entity does not default, is not in default. And B t k is a cash account at time t k. So this going to be here simply is a discounted value of the event that there is no default up to time t k, discounted back to time 0. Using the cash account B t k. Again we're going to assume as we have done in the modules corresponding to defaultable bonds that I t k and B t k are independently distributed, and therefore I can take the expectation separately. If I take the expectation separately I'll end up getting Q t k which is the time zero probability. That the bond doesn't default up to time t k. This quantity which is Z t k 0 is simply the expectation or under the risk neutral measure of 1 over B t k, which is nothing but the price of a zero-coupon bond which pays $1 at time t k. This can further be simplified as the discount rate. Up to time t k. So what's the risk neutral value of all the premium payments? Just sum this overall times k, that's k going from one through n, delta times S time N, which is the coupon payment, this is the probability that this coupon has to be paid, this is the discounted value of that quantity. So the expected discounted value of the coupons is what the coupon payments are going to be. What about the accrued interest. We've got to assume, that if t k is here, and this dot, some default time tau happens, it's uniformly distributed over this. So the value of coupon that you're going to be paying, would be approximately half. So that's what this quantity here is. About, this is about, approximately half the coupon. And this comes from the fact that we are assuming that the default is uniformly distributed over the interval t k minus 1 to t k. Now, what is the probability that the default occurs at time t k? It's I t k minus 1 minus I t k, divided by B t k to discount things over, again. Just taking the expectation and using the fact that the default is going to be independent of the interest rate dynamics. We end up getting that this quantity is going to be delta S N divided by 2 q t k minus 1 minus q t k. This is the probabilities of the two indicators times Z t k 0 which is the price of a zero-coupon bond. Which pays $1 at time t k. We can dis, we can simplify this further and write this quantity as a discount phase. If you add up the two quantities, this tell you the risk-neutral value of the premium and the accut, accrued interests can be approximated and the approximation here comes from the fact that we're approximating this uniform distribution. Is also another subtle approximation which I don't want to go in too much detail and that comes from the fact. That if you look at the, hazard rates, those are going to be going monotonically down, so even if you assume that the period, that it's going to be in the interval is going to be uniform, the probabilities are going to be slightly different. We're going to approximate all of that and assume that it's sort of a flat probability, in that interval. Okay, to sum that up, you get an expression, and we're going to be using this expression in the next page to try to figure out what the par value is going to be. What is the risk-neutral present value of the protection or the contingent payment? It's 1 minus R times N. This is going to be the amount of protection that you have to be paid. It's another subtle amount here. We're trying to price the CDS. We're going, but in the pricing we're assuming that the R is known. But really R gets known only on default. So in some sense we're making an implicit assumption that these CDSs have been around, and so we have a good idea what the expected recovery is going to be on particular CDS that we are going to be pricing. What is I t k minus 1 minus I t k, this is the event that a default happens at time t k, and, times B t k which is a discount that I have to do in order to bring the quantities back to time zero. Again I've gone through two steps. We can first write it as the price of zero-coupon bond or you can directly go to the discount and I'm directly going to the discount here. That is the quantity that is going to be the contingent payment or the protection payment. So S par which is the par spread is defined to be the spread that makes the value of the contract exactly equal to 0, you compare this term with that term. This term involves S and solve for S and you end up getting to the solve for, the value, the notional amount goes away. It's 1 minus R. This is protection. Down here it's premium plus accrued interest. If you assume that the default probabilities remain sort of flat over the entire premium interval so q t k is going to be 1 minus some hazard rate h times q t k minus 1. Then you can approximate that power spread to be 1 minus R times h divided by 1 minus h over 2. And, if you recall, back in the module, the first module in CDS we had said that this is approximately equal to 1 minus R times h, and this is typically because h is assumed to be pretty close to zero. When h starts becoming pretty close to 1, the approximation is not valid and one has to use a better approximation. As you would intuitively see this is increasing in the hazard rate h and decreasing in the recovery rate R. In the rest of this module, I'm going to show you this pricing using a spreadsheet. So in this spreadsheet we're going to price the hypothetical two year CDS that we had introduces in the module. The principal amount for the hypothetical CDS was $1 million. The recovery was set as 45%. So 1 minus R which is the amount that we are going to have to pay is 55% Arbitrarily I'm just setting the interest rate here to be 1% per annum. So using that interest rate, I can computer out the discount value, which is right here. So it's just going to be, the quarterly discount is going to be R divided by 4 times the month count divided by 3. So that, this interest rate directly gives me the discount rate. The hazard rate. I took it from the calibration worksheet that we worked with for the bonds. So, there, we computed the hazard rate for a six month default probability. Here, we are talking about three month default probability. So I just took that value, and divided it by 2. How did I compute the survival probabilities? I took the same formula. It's going to be the survival probability 1 times step before times 1 minus the hazard rate. The only difference is before I was using survival probabilities in absolute numbers, here I'm looking at them at percentages. What about the fixed payments, which are the fixed coupon payments that. The buyer has to make. This is simply going to be the quantity of the spread divided by 4, and I've left off the notional amount, and I'm going to look at the notional amount in a moment. So that's the fixed payment that's going to happen. Now in this column, row F, what we have done is we have taken the fixed payments and found an expected value, the expected value which takes into account the probability of default. So that's e7 times d7, divided by 100. And this 100 just comes because the probability of survival is written as percentages. So, the values in this column simply reflect the fact that fixed coupon payment has to be paid only if the reference entity survives up to that time. This is the present value. We have taken the expected value, multiplied it by the notional amount, and because, these spreads are in basis points, I multiplied it by 0.0001 to covert into absolute numbers. And multiplied it by b7, which is the discount value to get the present value. Of the coupon payments. Done this for all time periods. That tells me what the total fixed coupon payments are. But we still have to figure out what the accrued interest is. And, in order to compute the accrued interest, we need the default probabilities. So here's the default probability. This default probability is just a survival probability. Times the hazard rate, and I put that along this column all the way through. What is the accrued interest? If you click on that, it's we've assumed it to be half of what the coupon payment is going to be, because we have assumed that this is going to be half way between. Times the default probability again divided by 100 to convert the default probability, which is in percentages, into absolute numbers. What is the present value? You take the notional amount, N, which is of $1,000,000 times the accrued interest, times the discount times again 0.0001 to convert the basis points into. absolute numbers. So this is going to be the present value of the accrued interest, in different periods. Finally, what about the protection. What is the expected value of the protection, it's the default probability times 1 minus R divided by 100. The 100 again to take the default probabilities and convert them into absolute numbers. What is the present value of the protection? You multiply by the notional amount, multiply by the discount rate, that tells me what is the present value of the protection for the different time periods. So the premium leg now is going to be the sum of the present value of all the premiums and sum of all the present value of the accrued interest. And that tells you what the buyer has to pay. What the buyer will receive is just the sum of all the expected present values of the protection payments. This is the net value of the swap at time zero. The difference between the premium leg and the protection leg. So, since the value of the CDS is positive. It, it suggests that this spread is set too low. it's a good deal for the buyer. The buyer is getting protection at too lower rate. If you increase that spread, to say from 218 to 220 basis points, then you end up getting that that spread is too high, you end up getting that the difference between the premium leg and the protection leg is negative. Which means that it's not been, it's not a good deal for the buyer. This spread has been set too high. You can compute out what the correct spread is going to be. So we're going to set the objective which is the value and try to solve for the value equal to zero by changing the variable cells S, it's just a reference cell. And I'm assuming that it's going to be positives. If you solve that and you wait for Solver you end up getting that the spread is going to 218.89 which is slightly smaller then then spread that we had started with. And this brings us to the end of this module.

## 020.Interview with Emmanuel Derman

### 036. Interview with Emmanuel Derman

It is a great pleasure to have Professor Emanuel Derman for a guest lecture today. Professor Derman is co-head of risk at Prisma Capital Partners. He's also the director of Financial Engineering Program at Columbia University. He's the author of two books, he's latest book, Models Behaving Badly: Why Confusing Illusion With Reality Can Lead to Disaster, on Wallstreet and in life, Was one of Business Week's top 10 books for 2011. His other book, My Life as a Quant, was one of Business Week's top ten books in 2004. Way back in 1996, he wrote an article titled Model Risk, where he pointed out the dangers that inevitably accompany the use of models. Among his many awards and honors, he was named the Sungard IAFE Financial Engineer of the year, in the year 2000. Professor Derman has Phd in theoretical physics from Columbia. In the 1980s he worked at AT&T Bell Labs, on developing programming languages for business modelling. From 1985 to 2002 he worked on Wall Street, running quantitative strategies, research groups, and fixed income equities and risk management. He was appointed as managing director at Goldman, Sachs and company in 1997. The financial models that he developed there, in particular, the Black-Derman-Toy interest model and the Derman Kani Luke volatility model have become widely used in the industry. Today, we'll be speaking with Professor Derman about models, how they are developed in Wallstreet, using the Black-Derman-Toy interest rate model as the main context. You moved from Bell Labs to Goldman in 1985. Can you describe what the state of the art was in terms of the products being used, the models being used and how you made the transition from Bell Labs to Goldman.  >> Yeah. I came from Bell Labs to Goldman in 1985. And, it was actually a real pleasure for me at the time. Goldman was, and the whole of Wall Street was experiencing a burgeoning in the application of financial models and quantitative financial models to the, to fixed income in particular. And people, Black Shoals had appeared in 1973 and people were now busy extending Black Shoals and the methodology of Black Shoals to other sectors. And the disk I would thought a Goldman was a fixed income options treasury trading disk, and the big battle at that time was to try to extend Black Scholes to work for options on treasury bonds. And fixed income was a very good area for applying Black Scholes and quantitative technology because, when you deal with fixing com productions. For example Treasury Bonds, they have payments every six months and the principle back in 30 years. And so there are a lot of fixed points that you could describe very accurately, mathematically, and it makes the whole field actually much more amendable to mathematical modelling than equities. Okay.  >> How are people modelling these products and how are they using the exisiting models to price and trade these products? Okay, so when I arrived I was set to work, I was in a quantitative strategies area but I was set to work other fixed income options desk that were selling options on Treasury bonds. Options on Treasury bonds were kind of the analog of credit default swaps being a hot product in the, in the 2000s, that was the hot product of 1985. the economic reason was that interest rates had been coming down since the Carter era in the late 70s. And treasury rates, long term Treasury bond yields that sort of hit 16 or 17% and they were now coming down to 10 or 11%. And a lot of the investors in the world who invested in fixed income were used to earning 15, 16% and couldn't earn that anymore. And so what they were doing was, they were selling call options on the particular Treasury bonds that they owned to try to get a little extra premium. In exchange for giving away the upside as they went up, the idea being to enhance their yield. And so this was a big a big area of application for Treasury bond trading desks and option trading desks. And for quantitative people who are trying to build models to understand these things. When I first came to work in the fixed income strategies area, I worked for a guy called Ravi Dattatreya, who had actually built the first model, that I will shortly describe, that I set about modifying. And he had a very pragmatic attitude towards things, and one day he said to me, you don't really need to much skill over here, all you need is addition, subtraction, multiplication and division. And most of the time you don't need division. And he kind of had a valid point, which I think isn't valid anymore now. I mean that people on Wall Street, both at the quantitative level and at the trading level are much less numerate and much less mathematically sophisticated than they are now. And you could get away with a lot less advanced skill and in a way before I launch into describing what I worked on. It was kind of amateur heaven in a sense that nobody, there weren't a lot of option trading books, there weren't a lot of option valuation books. And if you were reasonably smart and came in and had a good background, you were expected to pick this stuff up from a few papers and start working. the product that I started to work on was pricing options on Treasury bonds. And the natural way which the guy I worked for of he had first modeled this and this was a common practice on Wall Street, was to treat a Treasury bond as a kind of stock. And just apply Black-Scholes to it by moving the model across, by treating the bond as the under-liar instead of the stock price. And so you treated a bond as a stochastic variable whose price could vary in the future, and you treated the, the coupon unpaid somewhat as a dividend and you modeled it's future evolution. there was one problem with this approach, and that's that, if you look at a stock, thirty years from now a stock can take on any uncertain price you can imagine. Whereas a bond, if there's no credit risk, will always pay you back its principal in thirty years. people in the business call this a pull to par in the model. That one price has to go back to its initial principle value. And so if you use Black Scholes to model the stochastic evolution of a bond price, it's good for the first few months because you can't tell that the bond is eventually going to revert to par. But if you go out to 3 or 4 years, the fact that it's got a finite time to maturity starts to make a big difference. If I can gesticulate to explain what I mean. a stock price evolves out into the future with more and more uncertainty. The bond price goes up, but then it has to come back to par after 30 years, and the technical term for that is that, it's a Brownian Bridge for the stochastic process. Meaning, it's a bridge between its current price, and its terminal price at expiration, which you know. And all the uncertainty is somewhere in the middle, or the maximum uncertainty's somewhere in the middle. And, nevertheless it wasn't a bad model to use for, for short term options on Treasury bonds. For longer term options, people came up with all kinds of, I want to say kluges or adjustments freely pragmatic ones to try to make the price process be a Brownian bridge. So for example Ravid came up with this idea that, instead of modeling the bond price as the sarcastic variable, you model the bond price as a yield to maturity as a log normal sarcastic variable. Making the yield to maturity log normal means it never goes below zero, it's always positive and it can get very large but since it's a yield to maturity, it doesn't affect the price that much. When you get close to expiration, even a yield of 10,000% has no effect on the price one day before expiration, so the price does behave like Brownian bridge. so there is an improvement, it wasn't really satisfactory for a bunch of reasons. the predominant one being that, like Scholes when you, when you do When you do stock options on two different underlying stocks. Say you do Apple and Google, an option on Apple and an option on Google pretty much have nothing to do with each other. You're free to model them independently. You only have to worry about the relation between Apple and Google, and the correlation and the covariance, if you did an option on the combined index that involved Apple and Google. But when you come to bonds, if you want to do a five year option on a 30 year bond, and you also want to do a three year option on a 30 year bond. You can't actually pretend that those two options are independent because the, the five year option will be a three year option two years from now. And so there's a relation between bonds that get shorter in maturity as time passes and options whose expiration changes as time passes. And so you actually implicitly involved in modeling the whole yield curve. You cannot model one bond as an independent entity. Another way to see this is that in Black Scholes, you have to discount the expected payoffs at the riskless. And when you Apply Black Shoals to bonds, you have to discount the expected value of the option on the bond, at the riskless rate. But the riskess itself is a reflection of the bond price. And so implicity are already modelling two bonds, when you treat the riskless rate, and the underlying bond has separate instruments. And in fact, Ravi taking some interesting approaches to trying to do this, he tried to embed in the crude Brownian Bridge Model that treated yield as an independent variable. He tried to make the short discount rate move parallel to the long term yield to maturity, to reflect the fact in a crude way that yields always tend to move up or down together, or they're not really one for one. so, this was the way people did things.  >> Can you describe how you, Fisher Black, and Boltoy got into a collaboration? And how this idea of modeling short rates came to be?  >> Yes, so we were actually. Fisher Black and Boltoy were actually in the equities division, which is were Fisher was located. Boltoy worked for him. And I was in fixed income, working with the bond option desk. And I spent my first two or three months rewriting the bond option model, fixing some technical errors. Trying to build a calculator, meaning a front end, there were no calculations in those days, and I built a front end for people to use the model. I had a lot of experience at Bell Labs building front ends in units. And our Editor user interface that actually make it, made it very easy for salespeople to talk to clients, model a deal, save a price, talk to them the next day modify it a little bit. And it was kind of interesting that, fixing up the model helped their business but I would almost argue at the beginning that adding a good user interface. And good ergonomics help the business much more than actually improving the model to some extent. And when I finished that they had meanwhile involved Fischer who was obviously the world expert on options in trying to model the whole yield curve. Because we all understood pretty clearly that if you want to rebuild a model for options and bonds, you actually had to model the yield curve consistently. And so they sent me to interview with Fisher, and I joined the collaboration with him and Bill Toy up in equities to try to build a better model that had no arbitrage violations. And would model the whole yield curve and all options and fix income instruments derivative on the yield curve. It was pretty clear to us that we had to start with a one factor model. Although, late, later we actually tried to extend it to two factors. Because, Black Scholes is a one factor model and, we all had a sort of a pragmatic idea that, you start simple and add complexity later. So, if you are going to model the whole yield curve, and you are only going to use only one factor, the natural thing is to use the short rate, because. In an intuitive way you can think of long rates as reflecting expectation of future short rates. And so if you model the short rates as stochastic process, you can then try to make sure that long rates come out as the right expected value of short rates, so a long bond prices to be more precise. Come out as the expected value of, of discounting all future possible shortrates and expectations. One of the things I actually learned at the time which I always try to tell students now, is that you quickly learn that what you have to do is finance is not average perameters but average prices. Because of convexity, and so You shouldn't average short rates to get long term prices, you should average bun prices to get bun prices. We started by modeling the short rate, and figured you could model long rates as the expected value, in some sense of future short rates. We also adopted a binomial model approach for a variety of reasons. The first was, it was very simple to picture, and we were all very familiar with the binomial model. The second is, one of the things, even these days I think, in trying to persuade sales people and traders in particular to rely on a new model for business, is they have to understand it. And traders in the 1980s were not as numerate and didn't have advanced mathematical education as some of them do now. And so it was kind of important to us to use a binomial model because you could draw diagrams that showed what rates were doing. You could show the nodes, you could show the discounting from period to period in a way that traders were very comfortable with. So for both PR reasons and because we didn't like to be too mathematically sophisticated. We decided to do everything binomially, and build the computer program to do it so that we could deliver it to them as a way of doing business.  >> So, it appears that in developing the BDT model there were lots of approximations made, there was a single factor model, you put in a second factor later on. there was also this philosophical idea that you had to somehow calibrate models to bond prices. That it wasn't a model which was going to give you all the details. was that a conscious decision? How did you decide on that approach.  >> Yeah, that, that's an interesting question because, although BDT. There, there were two models that came out around the time we wrote our model. There was Ho-Lee, which was kind of similar in a normal framework and we had BDT which was a little bit more advanced, and allowed you to vary volatilities but was logged normally. And logged normal interest rates were more realistic than normal interest rates which can go negative. There had actually been ten years earlier a bunch of, we had a different attitude. There had actually been ten years earlier a bunch of continuous time extensions of black shelves sort of fixed income world. The first one was[UNKNOWN] check which was really a[UNKNOWN] model. And the second one was by[UNKNOWN] but their aim was different. They were trying to build a model that correctly describes the behavior of[UNKNOWN]. And they were theoreticians. And we were actually partitioners working with a trading disk and our job Wasn't to model the yield curve. Our job was to model options on the yield curve and give realistic prices for them for traders. And so we had to take the yield curve as a given, in the same way as option, option traders, option pricers take the underlying stock price as a given, they don't try to decide whether it's right or wrong. In the same way, we had take the yield curve as that's the way it is, now price an option on it. So the whole question of calibration became a big issue, and maybe that's the first time in modern history of building these models that it became a name. So the idea was we'll build a model of short rates, but we had to make sure that when you price all fixed income on zero coupon bonds or treasury bonds on the yield curve. On our model they had to reproduce the price of treasury bonds at the instant that the option was priced. Because when you price an option you want to make sure that you at least price the end line correctly, so this was a question of calibration. We chose a log-normal distribution cross sectionally of short rates and each log-normal distribution of short rates had a mean, standard deviation or volatility and we calibrated those to fit the price of a bun with that majority. By pricing the bun but this cutting all the way down to trees. So it's kind of[UNKNOWN], you price the tree of bond, you fixed everything then you went to three and a half years. And you added another layer to the tree with the right mean, and the right standard deviation to place the four year bond. And we targeted the volatility of bonds which the traders gave us because that was important for the option. And we targetted the yield of bonds so the price of bonds because that was given to you by the treasury bond market... And the idea was to choose your sort rate distribution calibrated to reproduce these long yields and long volatilities. Since then I would say that has become a pretty standard method of running all models. You know your model is not strictly correct, but you want it to reproduce the price of liquid instruments that are underliers, and you calibrate the model everyday if you have to. Since the financial[UNKNOWN] to make it fit the prices of underliers.  >> Over the years you've shared many interesting quotes of Fischer Black with me, about modeling, about how he approach modeling, what was his overall philosophy. It would be great if you could share some of those with our students.  >> I came from a physics background, and actually I came to Wall Street as I said in late 1985. And I got very excited about it. Getting a shot in the arm about applying physics and math techniques to new area that I have not done before. And, I think I like a lot of people have this illusion that you could sort of build a grand unified theory of finance, in which you would model all fixed income rates with stochastic process. And consistently price every instrument in the world and look for arbitrage opportunities, and BDT was an arbitrage-free model in its, in its own limited one factor way. And Fisher was actually much more pragmatic about all of this. He was quite happy to live with an imperfect financial market and have different models that weren't consistent with each other in different areas. And didn't have this overarching desire to unify everything and I only really got to that point sort of six or seven years later. And I, I have a couple of nice quotes that he wrote in the late 80s and early 90s which I think are reflective of his understanding of the way models work. So I have a couple of quotes from papers that he wrote. One he says, it's better to quote estimate a model than to test it. I take quote unquote calibration to be a form of estimation. So I'm sympathetic to it. So long as we don't take seriously the structure of a model we calibrate. Best of all though is to quote, explore a model. That's the end of the quote. I think what he's saying there is fighting against the people who don't like calibration. There are people who say you're taking a wrong model and fitting it to the data with wrong paramiters. And his argument was I don't think this is gospel truth. I think I'm just trying to get a handle on how things will behave in this model. And I sort of come around to the idea that you should think of all of these models as imaginary worlds that you're trying to construct. Which don't reflect the real world in all its details but may Be consistent with parts of it. And you calibrate a lot of different models to the same data and see how, why the range of prices you get, when you, when you pass the same instrument calibrated to the same underliers under different stochastic models. he's got another quote which I like too, even better. He says, my job I believe is to persuade others that my conclusions are sound. I will use an array of devices to do this theory, stylized affects, time series data surveys and appeals to introspection. I particularly like the appeals to introspection because he's making clear that finance isn't just a science, it's a science of the way people behave and and an art. And he's looking inside himself to try to get an idea of, what's a sensible way that people would try to come at prices, and then model that. the last quote I wanted to say, is, He says, in the world of real research, conventional tests of statistical signifigance seem almost worthless. I particularly like that, because when people new. Either students or even people who are economists come to Wall Street. In my experience, they always. Have greta expectations for models and think they're going to be used in a, in a way that explains the truth. And think you should test them very carefully to calibrate them, find the best model and then use that. And the truth is, the financial world goes through regimes of change, and the same models don't work in the same period. And if you try calibrating one model to 30 years. It doesn't work because you really have to use different, different models at different times, and I think he kind of understood that. He was also a big believer in rationality, Fisher, in that he once wrote an internal article at Goldmann that said, you should pay traders not for the results that they get but for the stories that they tell. About why they made money or why they tried to make money because you want to encourage them. To think, rather than to simply reward them for luck.  >> Thank you very much.

## 021.Introduction to Mortgage Mathematics and Mortgage-Backed Securities

### 037. Introduction to Mortgage Mathematics and Mortgage-Backed Securities

In the next series of modules, we're going to discuss mortgage mathematics and mortgage backed securities. We're going to look at more mortgage backed securities because they will give us an example of the process of securitization. That is the process by which new securities are created from pools of underlying loans or mortgages. So we're going to begin in this module with basic mortgage mathematics and an introduction to the mortgage markets. We called it according to SIFMA, the Securities Industry and Financial Markets Association, that in the third quarter of 2012, the total outstanding amount of US bonds was $35.3 trillion. Now if you look at this you can see that the mortgage market actually accounted for 23.3% of this total. So the mortgage markets are therefore huge, and they played a big role in the financial crisis of 2008 and 2009. And that's one of the reasons we're going to talk about mortgages and mortgage backed securities over the next few modules. It is interesting to understand what they are and how they are constructed. And some of the mechanics behind the basic or more standard types of mortgage backed securities. Mortgage backed securities are a particular class of what are called asset-backed securities. These are assets-backed by underlying pools of securities such as mortgages, auto loans, credit card receivables, student loans, and so on. The process by which ABS or mortgage-backed securities are created is often called securitization. Here's a picture of how securitization works in the context of mortgages and mortgage backed securities. What we have here are 10,000 different mortgages. Each of these mortgages corresponds to a different home owner. What we do is, we combine these 10,000 mortgages into one big pool of mortgages. So these 10 000 mortgages formed the collateral for the mortgage back securities that we will create. Here, we have what are called Tranches, Tranche A, Tranche B, Tranche C, and Tranche D, and Tranche E. We won't worry about these are right now with seen example of this later on, but basically what we're getting at is the following idea. We combine these 10 000 mortgages into accrual of mortgages or a pool of loans. And then from this large pool, we can construct a series of different securities. Each of these securities are labelled Tranche A to Tranche E, and the payments, the mechanism, the risk characteristics of each of these securities are very different. Even though they're all built from the same underlying pool of loans or mortgages. So this is the process of securitization, now you may ask the following question. Why bother with securitization? So why securitize? Well a standard answer to this, Is that by securitizing we are enabling the sharing or spreading of risk. So it is in order to share risk, if you like, anyone of this individuals mortgages might be risky by itself. Maybe the owner of the home will default and not pay. So anyone mortgage by itself might be to risk for a small bank to hold. So instead what they can do is they can pull all of these mortgages together. And then sell them off to investors who willing to bear that risk. We will look at some examples of the mortgage backed securities, but first we must consider the mathematics of the underlying mortgages. Now there are many different types of mortgages, both here in the US and in different parts of the world. We're going to consider just level payment mortgages. Level payment mortgages are mortgages where a constant payment is paid every month until the end of the mortgage. So that's a level payment mortgage, but there are other types of mortgages. For example, adjustable rate mortgages are mortgages where the mortgage rate is reset periodically. And in fact these kinds of mortgages actually played quite a big role in the subprime crisis. So as I said, we're only going to consider level payment mortgages, but that's fine. It's important to note though, that mortgage-backed securities may be constructed out of other mortgage types as well. And the construction of mortgage-backed securities, as I said in the previous slide is an example of securitization. And the same ideas apply to asset-backed securities more generally. And so that's one of the goals of these modules in mortgage-backed securities. It's just to show how the process of securitization might work. How you can combine pools of loans, be they from mortgages or other markets, credit cards or auto loans, for example. How you can combine these pools of loans and create new securities out of them. That's a very big part of the financial industry and so we're going to discuss that, but in the context of mortgage-backed securities. Before I go on, I'll mention that a very standard reference on mortgage-backed securities is the textbook Bond Markets, Analysis and Strategies by Frank Fabozzi. But I should advise you it is an extremely expensive book and so I wouldn't recommend that any of you actually go out and purchase it. So if some of you have it or a few local libraries or college library has it, you might want to take a look. If you want to learn more about the mechanics of mortgages and how they work. So as I've said, we're going to consider a standard level payment mortgage. We're going to assume for example, that maybe there are 360 periods in the mortgage. So this is t equal 0, t equals 1 and so on, up until t equals 360. So this actually would correspond to a 30 year mortgage, because there are 12 months in a year. And so there would be 12 times 30 equals 360 periods in the mortgage. So we have an initial mortgage principal of m0. We're going to assume equal periodic payments of size b dollars are made in each period. So we're going to pay b dollars at the end of every period, And so on, until t equals 360 when the mortgage has finally been paid off. We'll assume that the coupon rate is c per period. So if you'd like, this is just the interest rate due each period on the mortgage, but we're going to use the term coupon rate for this. There are a total of n repayment periods. So in this example I've drawn up here, n is equal to 360. And then after the n payments, the mortgage principal and interests have all been paid. The mortgage is then said to be fully amortizing. This means that each payment B pays both interest and some of the principal. After all, if we make the same payment B in every period out until the end of the mortgage then clearly. Each payment B is paying both some of the interest due on the outstanding principle, but it's also paying down some of the outstanding principle. So this is an important fact and we're going to analyse this over the next couple of slides. We're going to use the following notation, we're going to let Mk denote the mortgage principal remaining after the kth period. In that case, we can say that Mk = 1+c times Mk-1-B. Now where does this come from? Well it comes from the following fact. The coupon rate is c per period. So if you look after period k-1, the outstanding principle is Mk-1. Well in the next period, the outstanding principle alone will still be Mk-1. But you'll also own additional c times Mk-1 of interest. So therefore, the outstanding principal will be 1 + c times Mk1-1. But don't forget, you will also have paid b dollars at the end of that period. So therefore the total outstanding principle after the kth period will be 1+c times Mk-1-B. And that's true for k= 0, 1, 2 up to far as n, the total number of repayment periods. But keep in mind, we said that the mortgage ends after n periods, when the entire mortgage has been paid off. So that implies that Mn = 0. And this is very important, so this last couple of lines here on the slide are very important. What can we say or how can we use this expression here in 1? Well what we can do is we can iterate it. For example, we know that M1 is therefore equal to 1 + C times M0 the initial mortgage principal minus B. We can now use this with k=2. So M2 = 1+c times M1, and M1 is 1+c times M0-B, and we have a -B out here. So therefore, this is equal to 1 + c squared M0 minus the sum of 1 + c times. Well let me put the minus here and it's a B here, get to the power of j, with j = 0 up as far as 1. So now we could go on to M3 and repeat the same calculation to get M3 in terms of M0 B and C and so on. So that will leave us in general for k, we'll get to follow the expression to the Mk = 1 + c to the power of k times M0-B times the sum from p = 0 to k-1 times 1 + c to the power of P. We can simplify this, this is just a simple geometric summation here. And so we can just use our standard formula for the sum of a geometric series to get this expression down in two. Now, we are not done yet remember that Mn = 0 after M repayment period so mortgage has been paid off. So if we take k equal to n, so take, k = n in equation 2. And use the fact that Mn = 0, we will find that B is equal to the following expression down here. So this gives us B, And this is very interesting. Why? Well it tells us that if we have a level payment mortgage and we know the initial loan amount or the initial principle M0. And we know n, the number of time periods, and we know the coupon rate. Well we can compute what the correct value of B is, so that b dollars paid in every period would pay off the mortgage after n periods. By the way, this is very related to the mathematics of annuities, which you saw back in the first week of this course. Anyway moving on, we can substitute our expression for B back in up here. So we can put B in for this, and we can get this expression down here. And this is very nice, because it tells us the value of the outstanding mortgage principle after k periods on the left hand side. That is equal to an expression on the right hand side, which only depends on M0. The initial mortgage principal, the coupon rate c, the number of time periods in the entire mortgage n and the current period k. Suppose now that we wish to compute the present value of the mortgage assuming a deterministic world. And by the way, what do we mean by deterministic world? Well what I mean is that there's no uncertainty in the world. We're using a very stylized situation here. There is no randomness, there is no possibility of default so prepayments though of course, these are very important features in practise. In that situation, we can actually compute the present value of a level mortgage. If we assume, the risk free interest rate of r per period. We obtain that the fair mortgage value is and we're going to use F0 to denote the fair mortgage value. Then the fair mortgage value is equal to the sum of the Bs divided by 1 + r to the power of k from k = 1 to the power of n. Now just to keep in mind or you can think of r as the borrowing rate for the banks. The banks that write the mortgages or that lend the money out to the homeowners. Presumably they can borrow at r and for all intents and purposes here, we can imagine r to be a risk free interest rate. R in general will certainly not be equal to c. C is the coupon rate or if you like, the interest rate that the homeowner must pay on their mortgage. R is the interest rate that the banks use to discount their payments. So in this case, we're going to get F0 equals the sum of the b over 1 + r to the power of the k. Again this is a geometric series, we can easily calculate this term and then we can substitute in for B using our expression on the previous slide. If we do that we'll get this expression here, expression number five. Note that if r = c then actually F0 = M0 because if r = c, this term would cancel out with this term, and this term could cancel out with this term. And so not so surprisingly we get F0 = M0, and that is exactly as we would expect. In general however, r is less than c, and that is because the banks who write the mortgages. Or lend the money out to the home owners must charge a larger rate of interest z, to account for the possibility of default, prepayment, servicing fees on the mortgage. They must make some profit, they must also account for payment uncertainty and so on. So in general r will be less than c, and the difference here between r and c accounts for the difference between F0, the fair value for the mortgage from the bank's perspective. And M0 the amount of money that the home owner is being lent in the first place. So in some sense, you can think of F0-M0, as being the amount of money that the bank is earning from the mortgage. But that money must be used to handle these effects here. The possibility of default, prepayment, servicing fees and so on as I mentioned already. By the way, we're only working here with the level payment mortgages where you could do similar kinds of analysis with other types of mortgages including adjustable rate mortgages or ARMs or so on. I also want to mention the fact that we can also decompose the payment B that is paid in every period into an interest component under principal component. And this is very easy to do, since we know Mk-1, we can compute the interest, let's cal it Ik in every period. So Ik is equal to c times Mk-1, afterall Mk-1 is the outstanding principle at the end of period k-1. So c times Mk-1 is the interest that is due on that principle in time period k. So this is the interest that is paid in time period k. Therefore that means we can interpret the kth payment which is B, as paying Pk = B-cMk-1 of the remaining principle. So Ik is the interest that is paid at period k and Pk is the principal that is paid at period k. And of course note that Ik + Pk = B, which must be the case because we pay B dollars in every period. So that B dollars must be split up between principal and interest and the way to split up is given to us up here and here for Pk. So in any time period k as I said, we can easily break down the payment B into scheduled principal payment and a scheduled interest payment, Ik. And we're actually going to use this observation later to create principal only and interest only mortgage backed securities. These are an interesting class of mortgage backed securities. And we will see that when we actually use a pool of mortgages to create these new securities. We're actually creating new securities that have very different risk profiles, but we will return to that in a later module. In the spreadsheet that goes with these modules on mortgage backed securities, there are three worksheets. The first worksheet is called single mortgage cash flows, and it simply shows you how a single level payment mortgage works. So that we can see everything here on the same on the one sheet on the one screen I've assumed that there's just 18 periods in the mortgage. In reality there might be 240, or 360 and if I change it to 360 for example we'll see that the spreadsheet adjusts appropriately. So we see that we got 360 months appearing. But just so that we can see anything see everything in the same screenshot, I'm going to assume that this is just aiding periods. We start off with a mortgage loan of $20000, the mortgage rate is 5%. Now this is an annual rate, this is not c, this is an annual rate but we can easily convert it into a monthly rate and what's what we do here when we calculate the monthly payments. So this is d. This monthly payment in cell C3 is our B from the slides. So we see how to calculate B using C2 which is the monthly rate. As well of course C1 which is M0, the initial mortgage loan. So what we have here is we have the 18 months. We see the beginning monthly balance. This is the outstanding principle on the mortgage at the beginning of each month. We see the monthly payment is $1155.61. It's the same monthly payment in every period. And as we saw in the final slide, we can break this payment down into a monthly interest payment and a scheduled principal payment. So that's what these quantities are here. Note that the monthly interest and the scheduled principal always sum up to the monthly payment. So in any cell here, you'll see that these numbers always sum up to the corresponding cell in column E. So monthly interest plus scheduled principal repayment is equal to the total monthly payment. And then of course in order to get the ending mortgage balance, we simply subtract the scheduled principal repayment from the monthly payment. And of course after 18 periods the outstanding mortgage balance is zero at the end. So you can play with the spreadsheet if you like. As I said, in practice, you typically have a much longer term of the loan. Instead of 18 periods, you might have 240 for a 20-year mortgage, or 180 for a 15-year mortgage, or a 360 for a 30-year mortgage. Another interesting observation to make. Is that in the earlier part of the mortgage, the monthly interest payments are larger than they are in the latter part of the mortgage. So that up here, you see in the earlier months of the mortgage, the interest payment's around $80, $75, and so on. But they're much smaller later in the mortgage. On the other hand, the principal repayments in the earlier pert of the mortgage are smaller in this case around $1,075, $1,080 versus later in the mortgage when they're $1,141, $1,146, $1,150. The impact isn't so obvious here but if I switch to say a 360 period mortgage you will see that this effect is much greater. So here, let's make it say at $200,000 mortgage. So here, what you'll notice is the monthly payment is $1073. But, most of that payment is going to pay interest, look at that. Of that $1073, in the earlier part of the mortgage life, most of that is going to pay interest and only a smaller fraction of it maybe on the order of 25% is going to pay principal. However, if I scroll down towards the end of the mortgage which is a long way down because it's a three 360 months, then, you will see that now only a small part of the monthly payment is going to pay monthly interest and that's because the outstanding principle is much smaller in this time period. So, a much smaller interest amount is due and a much larger fraction of the monthly payment is going to pay the principal. And this observation was important. It's worthwhile knowing for anybody who's thinking about taking out a level payment mortgage, that in the earlier part of the mortgage life, most of their monthly payments will actually be going towards paying interest, and only a small fraction would be going towards paying principal. That will be reversed towards the end of the life of the mortgage. This, as I mentioned earlier, will also have a significant impact when we create principle only and interest only mortgage backed securities and see how they are constructed.

## 022.Prepayment Risks and Pass-Throughs

### 038. Prepayment Risk and Mortgage Pass-Throughs

In this module we're going to discuss Prepayment risk and Mortgage pass-throughs. Prepayment risk is a particular type of risk that mortgage backed securities are exposed to. Prepayment risk refers to the ability of homeowners to prepay their mortgages. So mortgage holders or homeowners often have a option to prepay their mortgage early. And that creates prepayment risk for investors in mortgage-backed-securities. We're also going to discuss Mortgage pass-throughs securities. A Mortgage pass-throughs is the simplest example of a mortgage-backed security, and so we're going to spend some time as well on this module, in this module, discussing pass-throughs. Many mortgage holders in the US are allowed to prepay the mortgage principal earlier than scheduled. Payments made in excess of the scheduled payments are called prepayments. Now, there are many possible reasons for prepayments. Number one, homeowners must prepay the entire mortgage when they sell their home, and there are many reasons why somebody might need to sell their home, maybe they're moving for a new job, maybe they're getting divorced, and so on. Homer, homeowners can also refinance their mortgage at a better interest rate. So for example say a homeowner took out a mortgage when the interest rates were very high on mortgages, and maybe five or six years later, they'd see that interest rates are much lower. Well the ability to prepay allows the homeowner to pre-pay their mortgage and then take out a new mortgage at a much lower level of interest. A third reason is the homeowner may simply default on their mortgage payments. Maybe they're behind on their payments, they can't catch up and they smiply default. In this case, if the mortgage is insured then the insurer will pre-pay the mortgage as well. And finally, for another example, the home might be destroyed by floods or fire or by some other catastrophe and insurance proceeds in this case will pre-pay the mortgage. So there are many possible reasons for pre-payments. The second reason we've highlighted here is a very valuable reason. It's the prepayment option that mortgage holders have. In particular they can benefit when interest rates go lower. And so this is a prepayment option and like options it has a positive value to the owner of the option, in this case the US homeowner typically. So prepayment modeling is therefore an important feature of pricing mortgage-backed securities. And the value of some mortgage-backed securities is extremely dependent on prepayment behavior. Again, we'll come to some examples of mortgage-backed securities in later modules. For now, we're going to consider the simplest type of mortgage-backed security, and that is the Mortgage pass-through. Now before I go on I should mention that pretty much everything I'm going to be saying here is very US centric. The mortgage markets are the markets from mortgage bank securities originated in the US in the 1980s. And that's where most of the the modeling and the if you like action in the mortgage market is taking place. So I'm going to be focusing mainly on the US but that's fine. Because pretty much everything I say will apply in some form or another to mortgage markets generally. Also the bigger picture that I want to get at here is the general idea of securitization and how mortgage-backed securities and indeed asset-backed securities can be created. How are Mortgage pass-throughs constructed. Well in practice mortgages are often sold on to third parties who can then pool these mortgages together to created mortgage-backed securites. In the US, the third parties are either government sponsored agencies such as Ginnie Mae, Freddie Mac or Fannie Mae, or other non-agency third parties such as commercial banks. Mortgage-backed securities that are issued by the government-sponsored agencies are guaranteed against default. It is not true of agency mortgage-backed securities. What do we mean by default here? Well what I mean by default here is just that the homeowner might be default on their mortgage payments. They just may not make their mortgage payments and, and therefore the mortgage can go into default. Well, in that situation, if the mortgage-backed security was issued by Fannie Mae or Freddie Mac, for example, then the agency will step in and guarantee the payments. This is not true in general of non-agency mortgage-backed securities. So the modeling of mortgag- backed securities therefore depends on whether they are agency or non agency mortgage-backed securities. The simplest type of MBS is the pass through MBS, where a group of mortgages are pooled together. Investors in this MBS receive monthly payments representing the interest and the principal payments of the underlying mortgages. So, here's a diagram explaining how this works. We saw this before in the last module. We've got 10,000 mortgages, of course the number doesn't have to be 10,000, it could be 5,000 or 20,000 mortgages. We've got mortgage number one, mortgage number two, up to mortgage number 10,000. All of these mortgages are pulled together into one mortgage pull and from that mortgage pull we can create new securities. These new securities are mortgage-backed securities and maybe they've got names like Tranche A, Tranche B down to Tranche D and Tranche E and so on. For now let's not worry about these tranches. In fact, in the case of the Mortgage pass-through security we don't have any tranches. But we will some examples later on where you can have tranches. So these 10,000 mortgages formed the collateral for the mortgage-backed security. and so when we create these new securities out of the underlying pool of 10,000 mortgages, this process is often called securitization. And as mentioned earlier, the economic reasons for securitization is that the desire of people to spread risk. Most people most agents most investors do not like risks. They need to be compensated for holding risky securities. So, one could view these 10,000 mortgages, individually, as being very risky. If you hold any one of these mortgages, there will be a substantial chance that the homeowner will default, for example, or pre-pay, and so there will be risk associated with these mortgages. But by pulling them together, creating new securities, we can sell these new securities on to investors who want the particular type of risk. And so that is the economic or financial motivation behind securitization. The pass-through coupon rate, and we're referring now to our Mortgage pass-through is strictly less than the average coupon rate of the underlying mortgages. Now this is due to fees associated with servicing the mortgages. Somebody has to collect the mortgage payments every month and do the book work and bookkeeping to make sure that the homeowners are up to date on their payments, and so on. We're going to assume that our mortgage-backed securities are agency issued, and are therefore default free. Now, I'm going to give you a couple of definitions here. You'll find when we discuss mortgage-backed securities that there are many definitions. The weighted average coupon rate, WAC, is a weighted average of the coupon rates in the mortgage pool with weights equal to the mortgage amounts still outstanding. Similarly, the weighted average maturity is a weighted average of the remaining months to maturity of each mortgage in the mortgage pool with weights equal to the mortgage amounts still outstanding. Now there's no need to worry about the specific details of these definitions. I just want to mention that there are many definitions associated with mortgage-backed securities. We also need to discuss some important prepayment conventions, that are often used by market participants, when quoting yields, and prices, of mortgage backed securities. But first we need some definitions. One definition, is the following, the conditional prepayment rate, the CPR, is the annual rate at which a given mortgage pool prepays. It is expressed as a percentage of the current outstanding principal level in the underlying pool, to this is the so called conditional prepayment rate. I very related definition is the single-month mortality rate. The SM and the SMM is the CPR converted to a monthly rate assuming monthly compounding. And so therefore the SMM and CPR are related as follows. Now the CPR is expressed as an annual rate, and so it is probably the rate that makes most sense to us. We like to think in terms of annual rates. We think of interest rates expressed as annual rates, and so likewise we might think of a conditional prepayment rate as an annual rate. However, when modeling the payments of a mortage-backed security we typically need the coresponding monthly rate and that's because payments in mortgage-backed securities typically take place monthly and so we wont be able to convert our CPR to SMM, and that's what we do here. We'll also see how the SMM and CPR are used in the spreadsheet that is associated with these modules to calculate the various cash flows underlying the Mortgage pass-through and, indeed, other mortgage-backed securities. In practice, of course, the CPR is stochastic, it is random, and it depends on the mortgage pool and other economic variables. We saw, for example, earlier that prepayments tend to go up when interest rates go down. And that's because it is more attractive to homeowner's to prepay their entire mortgage and then refinance at a better rate which is possible when interest rates have gone down. So the prepayment rate for a given mortgage pool will certainly depend on the economic variables. That are present at any given time. That having been said, market participants, that is, people who work with mortgage-backed securities in the marketplace. They often use a deterministic pre-payment schedule as a mechanism to quote mortgage-backed security yields, and so-called option adjusted spreads. Now we're not going to discuss option adjusted spreads it all in this course that's fine so you don't have to worry about what they are. The standard benchmark is what is called the Public Securities Association benchmark or the PSA benchmark. The PSA assumes the CPR is equal to 6% times t over 30 if t is less than or equal to 30 and I should mention here that C is now measured in months. Here and then after 30 months, CPR is equal to 6%. So the assumption here is that the conditional prepayment rate of a mortgage is 60% if it's more than 30 months old. If it's less than 30 months old, the conditional prepayment rate is 6% times t over 30. So basically the CPR grows linearly, for 30 months and then is flat. So this is time t in months, this is 6%, and this is the CPR. And then slower or faster prepayment rates are given as some percentage or multiple of PSA. So, for example 2 times CPA refers to mortgage pool that repays at twice this rate. A 50% CPR refers to a mortgage pool where the condition of prepayment is half of this CPR. Giving a particular prepayment assumption the average life of a mortgage-backed security is given as the following. Sells equal to the sum from k equals1 to capital T, k times Pk divided 12 times TP. Where Pk's the principle scheduled and projected prepayment paid at time k, TP's the total principle amount, capital T is the total number of months. And, we also divide by 12, so that average life is measured in years. It should be clear that the average life decreases as the PSA speed increases. And that makes sense, because if the PSA speed increases, well then you're going to get more of your principle payments earlier in the life of the mortgage. So the Pk's for k small, will actually be larger when the PSA speed increases. And so average life gives you a measure of the average life, or how long you have to wait to get the payments associated with the mortgage or mortgage. Implicit in the calculations of the average life is some assumption regarding the speed of prepayments. In practice the price of a given mortage-backed security is observed in the marketplace and from this a corresponding yield to maturity can be determined. This yield is the interest rate that will make the present values of the expected cash flows equal to the market price. So if you recall what a yield to maturity is in the case of a fixed income bond where the cash flows are fixed, well, it'll be some quantity that satisfies the following. So it will be n, i equals 1, ci over 1 plus lambda to the power of i. Now if lambda, if the payments are made semi-annually and we're compunding semi-annually then I should divide lambda by 2 here and multiply the i by 2. But basically lambda is the quantity that makes this equation correct. Where P0 is the value of the fixed income security in the marketplace and Ci is the cashflow that you receive at time I when you own this fixed income security. The problem with mortgages is, and mortgage-backed securities, is that the Ci's are uncertain. You don't know what they're going to be and that is because of prepayments. So when you are calculating a lambda or yield maturity for mortgage-backed security, you have to fix the ci's, and the way to fix the ci's is to make some assumption about prepayments. So that's what market participants do. So the expected cash flows are determined, or based on some underlying prepayment assumptions such as 1 PSA, 300 PSA, etcetera. So any quoted yield must be with respect to some prepayment assumptions. When the yield is quoted as an annual rate based on semi-annual compounding, it is often called a bond-equivalent yield. Yields actually are very limited when it comes to evaluating a mortgage-backed security. And indeed, fixed income securities in general, that don't take account the term structure of interest rates. They don't take the prepayment option into account. so yields are very limited, and indeed the, the market place typically uses option adjusted spreads as the market standard for quoting yields in mortgage-backed securities, and indeed other fixed income securities with embedded options. But, as I mentioned before, we're not going to be discussing option-adjusted spread so there's no need to worry about that in this course. An investor in a mortgage-back, backed security pass-through is, of course, exposed to interest rate risk in that the present value of any fixed set of cash-flows decreases as interest rates increase. However pass-through investors also exposed to prepayment risk, in particular contraction risk and extension risk. When interest rates decline prepayments tend to increase and the additional prepaid principal can only be invested at lower interest rates. So this is contraction risk. So if you think about it. When interest rates fall if you own a home and therefore have a mortgage, it is in your interest to prepay that mortgage early and then re-finance the mortgage at a much lower level of interest. If you do this then the people who have invested in these mortgage-backed securities. They're going to get payments sooner than they expected, and these payments can only be invested at the lower interest rates. So this is called contraction risk. The opposite also provides a risk, which is called extension risk. In this case, when interest rates increase, the prepayments tend to decrease, and that makes sense. After all, why would I want to prepay a mortgage early when I'm going to have to re-finance it at higher interest rates. So therefore, interest rates increase implies prepayments tend to decrease, and therefore I'm getting less prepaid principals than I expected. And so I'm not going to invest that principal, that prepaid principal at the higher interest rates that might now be prevailing. This is called extension risk. So, to summarize, in addition to the regular interest rate risk that fixed income securities have Mortgage-backed securities and Mortgage pass-throughs are also exposed to prepayment risk, in particular contraction risk and extension risk.

### 039. Mortgage Pass-Throughs in Excel

In this module we're going to go through the mechanics of mortgage pass through securities. And we will do that within the context of our Excel spreadsheet, which I hope you have with you. You can download that Excel spreadsheet with these modules and mortgage backed securities. We're going to look at the second worksheet in this Excel workbook. It's going to be about mortgage pass throughs. We'll discuss the mechanics of mortgage pass throughs. And see how the, how the cash flows of a mortgage pass through are created, and passed on to investors. The second worksheet on the XL workbook that goes along with these modules, and mortgages, and mortgage backed securities is called pass through. This worksheet shows the mechanics of a simple pass through mortgage backed security. Now, I just want to state in advance. Don't worry too much if it takes you some time to figure out. What the various self formulas are doing. it's not a hugely important part of this course. What I want you to come away with is a basic understanding of the mechanics of how these kinds of securities work. So what we have here is the following. We've assumed that the pass through. Now remember, a pass through mortgage backed security is constructed. From a pool of underlying mortgage loans. So we might assume, for example, that the mortgage balance, or here, the remaining mortgage balance, is 400. That might represent $400 million for example, representing a large pool of underlying mortgages. We're going to assume that the mortgage rate, so if you like, this is the coupon rate on the underlying mortgages. It's 8.125%. The pass through rate is 7.5%. Now, what is the difference between these 2 rates? Well, the pass through rate is the rate that gets passed on to investors. And it will always be less than the mortgage rate. And that difference accounts for the fees associated with servicing. The mortgage-backed security, in this case the pass-through. Somebody has to organize and manage and service the mortgage-backed securities. They need to be paid a fee for doing so. That fee is represented by the difference between the mortgage rate, 8.125%, And the pass thru rate 7.5%. The initial monthly payment, or if you like, the average monthly payment, that the underlying mortgage owners are paying, is 24.989. The seasoning, so this is how old the mortgage pool currently is, it's 3 months,and the term of the loan of the underlying mortgages is assumed to be 20 months. Now of course this is very unrealistic in realty you would be in a much larger pool certainly for mortgages or mortgage backed securities that have just been initiated. But I've assumed 20 months here, just so that we can see all of the payments on one screen. In reality, this might start off as being 240 or 360, corresponding to 20 or 30 year loans, respectively. We start off in Month 1, and let's work across. So, we have our conditional prepayment rates. So, this is our CPR, which is expressed as an annual rate. It tells you what percentage of the outstanding mortgage at the beginning of the period will be prepaid. Of course, we will need convert this into a single month mortality rate, and that's what we do here. The SMM gives us the percentage of the mortgage balance that is prepaid that month. We have an initial beginning monthly balance of 400. The monthly payment is 24.989 as we caluculated earlier. This is the monthly interest paid in by mortgage holders. And this is the monthly interest paid out to the past through investors. Note that this interest. Payment here 2.5 is less then 2.71 and that's because of the difference 8.125% and 7.5%. Finally the scheduled principle repayment is 22.281. That's equal to E13 minus F13. So that's the monthly payment minus the monthly interest paid in. And then finally there are some prepayments. As I mentioned in the last module. Sometimes mortgage owners prepay, and they might do so for various reasons. Maybe they're selling their house and moving to another location, maybe they've gotten divorced, maybe they've had a flood or a fire, maybe they've defaulted on their payments. And all those situations What the mortgage investors see, investors in mortgage-backed securities see is the mortgage being prepaid. So we're going to assume that these prepayments take place according to this schedule, the cpr. And SMM schedule and we get a prepayment of 2.53. So therefore the total principle payment is .253 plus 22.281 and that gives us 22.533. We can therefore subtract that from the initial mortgage balance of 400 to give an ending mortgage balance of 377.47. We then move on to the next time period, time period two. We see that the conditional pre-payment rate is increased to one percent. We get our single monthly mortality rate and so on. We know our beginning monthly balance is 377, this is the same monthly balance we had at the end of the previous period. We get our monthly payment. Now notice our monthly payments are now no longer the same constant. So in our last module we had a constant B being paid in every period. We would've the same constant B being payed in every period here, if there were no prepayments. But there are prepayments. Those prepayments actually reduce the outstanding principle by more than what you'd expect. And therefore that changes the B in each period. So if you, if you look carefully at the formulas here, you'll see that this formula is the same formula we assume to calculate B. In our earlier module. But of course we have to keep recalculating it in every period to adjust for the fact that prepayments are taking place. So what I want you to get from this spreadsheet is basically just how the repayments are calculated. How the interest payments are calculated. The interest payments paid out to past due investors are calculated. And the fact that prepayments take place and that these prepayments Alter the outstanding mortgage principal that remains at the end of every period. Now this is an idealized world, we don't have any defaults. We don't have any randomness in our prepayments. We're assuming prepayments occur according to this deterministic schedule given to us by the CPR. That's all fine as I said. In the real world of course You have to take these into account, but for our purposes we just want to understand some of the mechanics behind how these mortgage backed securities are created. And the simplest type of mortgage backed security is what is called the mortgage pass through. Where you just pool a whole series of loans together and then you pay out the principle and interest on those loans out to the investors in the pass through security.

## 023.Principal-Only and Interest Only Mortgage-Backed Securities

### 040. Principal-Only and Interest-Only MBS

In the last module, we discussed prepayment risk and the simplest kind of mortgage-backed security that is a mortgage passthrough. In this module, we're going to discuss two new types of mortgage-backed securities. The first type is a principle only MBS and the second type is an interest only MBS. We're going to see how these securities can be constructed from an underlying pool of mortgages. We will see that the principal only MBS is constructed from the principal payments of the underlying pool. And that the interest only MBS is constructed from the interest payments in the underlying pool of mortgages. So in this module we're going to discuss the construction of a principal only and interest only mortgage backed security. We're going to construct these mortgage backed securities from an underlying pool of mortgages. So in this example here we've got a total of 10,000 mortgages. These mortgages correspond to 10,000 separate homeowners, each of whom has a mortgage on their house. So these mortgages are going to be pooled together into a pool of mortgages. And from these mortgages we're going to construct two separate mortgage backed securities. One is called a principal only mortgage backed security. And the other is called an interest only mortgage backed security. So if you like these 10,000 mortages form the collateral of the principle only, interest only mortgage back securities. Again we're going to assume our deterministic world with no defaults, no prepayments and so on. And that's fine because what we want to do here is to just get an idea of how these securities work in practice and what their risks might be. All right. So we saw in an earlier module that we know m k minus 1. The outstanding principle on a mortgage at time k minus 1. So what we have on he, mind, and this slide is just a single mortgage, where the outstanding principle at time k minus 1 is given to us by m k minus 1. Well, the interest on this outstanding principle is going to be denoted by Ik and that's equal to c times Mk minus one. If you recall c is the coupon rate of the mortgage. This is the rate that the homeowner must pay on their mortgage every month. So, it also means that we can interpret the case payment, as paying Pk. And Pk equals b minus c times Mk minus 1. So again what we have in mind here is a level payment mortgage, where a fixed payment of b dollars is paid in every period for the entire duration of the mortgage. So this b dollars, some of it goes towards paying the interest in that period, and that's c times mk minus 1. And the remainder, b minus the interest, ecmk minus 1, is paying the principle. So if you recall our earlier expression from mk in an earlier module, we saw that mk, the outstanding mortgage principle of time k Is given to us by this quantity. So using this expression here in 7 we can actually calculate Pk. Pk equals b minus c times this expression here evaluated at k minus 1. Because we have k minus 1 here. So if I substitute for k minus 1 instead of k here. I get everything down there. So these two quantities are equal, except k has now gone to k mines 1. So therefore Pk equals b minus c times this. Now it's just straightforward algebra to tidy up this expression, and I get the value Pk. So this is the amount of b, or if you like, this is the number of dollars that goes towards paying the principal in time period k. If I wanted to, I could compute the present value of these principal payments. Let's call this present value V0, so then V0 is equal to the sum from k equals 1 up as far as n of Pk divided by 1 plus 4 to the power of k, for if you recall, r is the risk free interest rate. Think of R, if you like, and this is just a loose approximation, but you can think of R as being the borrowing rate for the bank that wrote the mortgage in the first place, or that gave the mortgage to the homeowner in the first place. So from the bank's perspective, you can think of the fair value of the principal stream, the Pk's from k equals 1 to n, as being equal to the sum of these pk's [UNKNOWN] discounted. If you do that and if you, if you evaluate that expression. Remember we know what the Pks are so we can actually write this as being B minus c times m zero times the sumation n k equals 1 of 1 plus of c to the k minus 1 divided by one plus r to the k. Now I can easily take out a fact of one plus r over outside here, and make this a simple geometric sum which is easy to calculate. If I do that I'm going to get this expression up here. So this therefore is the present value, V0, of the principle payment stream. And is given to us in terms of B, which is the monthly payment on the mortgage. C, the coupon rate on the mortgage, M0 the initial mortgage principle, the fixed inch-, risk interest rate. Or, and n the number of time periods in the mortgage. Now, if we want to, we can actually compute the limit of V0 as c goes to r. you see that both the numerator and the dneominator in this case go to zero so we need to use the so called[UNKNOWN] to complete this limit while its straightforward to do so. And we find that the limit of V0 as c goes to r equals n times B minus rM0 divided by 1 plus r. Now, if you recall our earlier expression for b, which is the fixed monthly period on, monthly payment on the mortgage, then we can substitute for 9 inside up here in 8 to find V0. So here, this is the fair value, or the present value today at time zero, of all the principle payments on the mortgage. Assuming admittedly it's a deterministic world, no prepayments, no defaults. In the case that r equals c, then we see that V0 collapses down to this expression here. Now it is clear that earlier mortgage payments comprise of interest payments rather than principle payments. Only later in the mortgage is this relationship reversed. Well, how do we know this? Well we saw earlier that Ik is equal to c times Mk minus 1. So this is the interest payment that is made in time period k, and that Pk, the principal payment that is made in time k is equal to b minus the interest payment. So that's minus cMk minus 1. Now if you think about it, early on in the mortgage, let's set k equal to 1. Well then in that case Mk minus 1 is M0. It's the initial principal. The initial mortgage amount, and so clearly we see that Ik is large then, because it's c times the initial mortgage amount. And Pk will be small because it's B minus c times the initial mortgage amount. On the other hand, as time elapses and we move towards the end of the mortgage. Well then M k minus 1 will be getting much smaller, and so c times Mk minus 1 will be much smaller. And therefore the interest Ik towards the end of the mortgage will be quite small. On the other hand, remember we're paying a fixed amount B in every period. And so the principal that is paid towards the end of the mortgage would be B minus c times Mk minus 1, c times Mk minus 1 would be small, so the principle payment will be large. So, therefore, what is happening, is that the fixed payment B, that is paid in every period. So remember, we've got our periods, maybe this is 360, maybe this is T equals 0. And in every payment we're paying B dollars. Well therefore, what we are seeing here, is that in the earlier time periods most of this B period, B is going to interest and in later time periods most of the B is going towards principal. So this is an important fact to keep in mind with mortgage payments. Certainly level payment mortgages. Most of the payments are going to pay interest early in the mortgage and most of the payments later in the mortgage are going to pay down the principle. And in fact, it's quite interesting but if you can imagine a mortgage where the number of time periods n goes to infinity. You could actually check that the limit of V0 in that case is equal to zero. And in fact, that's not hard to see, and the reason it's not is because in the numerator, we've got r n times M0, so certainly the numerator is going to infinity up here as n goes to infinity. However in the denominator, we've a one plus r to the power of n. This is also going to infinity, but because it's raised to the power of n, the denominator is going to infinity much faster than the numerator and so V0 actually goes to 0. And so that's what happens. We see that if we stretch out the, the, the duration of the mortgage, so if we let n go to infinity, all of the payments, all of these fees goes towards the interest and none of them goes towards paying the principal. How about an interest only mortgage backed security? Well we could also compute the present value W0 say of the interest stream. Again assuming there are no mortgage prepayments. To do this we could compute the following sum. We could set W0 equal to the sum of the interest payments. Sure to be discounted by the risk-free rate, which is one plus r to the power of k. Now we could calculate this, but in fact it's much easier to recognize that the sum of the principal-only payments and the interest-only payments must equal the total value of the mortgage, F0. Which we calculated in an earlier module. If you recall, F0 is the fair value of all the payments in the mortgage. So F0, if you recall, was equal to the sum of the B's, divided 1 plus r to the power of k. And we actually calculated this expression earlier, and we found that F0 was equal to this. Well F0 must be equal to V0, the fair value or present value of the principle stream, plus W0. The present value today of the interest payment stream so F0 plus V0 equals W0. We've calculated F0 before, we've calculated V0 in the previous slide, so W0 is equal to F0 minus V0, and we find it's, using 12 and 10. 12 is here, 10 is here, we can actually use the two of these simplify, the algebra and get the expression like this for W0. It is also easy to check that when r goes to c, W0 is equal to this expression here. And this is as expected from 11 because we know that when r equals c, F0 equals M0. And so we see that W0 equals F0 minus V0, this is V0 when r is equals c and that's exactly what we've calculated up here. If we go back to our single mortgage cash flows worksheet. This is still the single underlying mortgage. You can actually see how we compute the monthly interest payments and the principle repayments in each period. We just used what we saw there. Ik is equal to c times Mk minus 1. And Pk equals b minus c times Mk minus 1. Therefore, if we wanted to compute the fair value of all of these payments. We could simply sum them all up, and suitably discount each of these payments by one plus or to the power of k, where k is the period in which the payment takes place. Likewise, we could compute these, the fair value of all of these principle payment by computing the sum of these weighted 1 over 1 plus r to the power of k. And so, what we've done here, it's just a simple single mortgage, but what, and it's a very, it's a deterministic world with no prepayments and no defaults. But we've still learned an awful lot about the structure of level payment mortgages. And how we can split the monthly payment up into an interest component and a principal component. We'll see in the next module how these components have very different risk profiles. They react very differently to changes in prepayments and so on. So we'll see that in the next module.

### 041. Risks of Principal-Only and Interest-Only MBS

In the last module, we saw interest-only mortgage back securities and principal-only mortgage back securities. And we saw how we can construct these from an underlying pool of mortgages or from an underlying pass through. In this short module, we're just going to discuss the risks of interest-only and principal-only securities. We will see how they have very different exposures to prepayments, for example. So if you recall, this is our diagram for an example of how a principal-only and interest-only mortgage backed security might be rated. We start off with a pool of 10,000 individual mortgages. Each of those mortgages has been issued by some broker, some bank to a home owner. these mortgages are then pooled together to form the collateral for the principal-only, interest-only mortgage backed security. so out of this pool of loans, we can create a principal-only tranche if you like and an interest-only tranche if you like. And in the last module, we saw how you could actually create these, these securities. I just want to spend a little bit of time talking about the risk of principal-only and interest-only mortgage backed securities. I'm just going to measure risk here by the concept of duration. Duration is a simple concept that's used throughout the fixed income markets for describing risk. If you haven't seen it before, that's fine. We're just going to use the definition of it here. This definition states that the duration of a cash flow is a weighted average of the times at which each component of the cash flow is received. And this is a standard measure of the risk of a cash flow. And it should be clear by the way that the principal stream has a longer duration than the interest stream. And I mentioned this in the last module, but just to remind ourselves. The interest payment Ik, if you recall, is equal to c times Mk minus 1. So this is interest from a level payment mortgage that is payed at time k. Then the principle that is payed at time k is equal to b minus c times m k minus 1. So clearly, in the earlier parts of the mortgage, Mk minus 1 is going to be larger. And so the interest payments will be larger. In the later parts of the mortgage, Mk minus 1. The outstanding principal will be smaller. And so, in that case, the interest payments will be smaller and the principal payments will be larger. It should therefore be clear that the principal stream has a longer duration than the interest stream. And this be, this is because the larger principal payments take place near the end of the mortgage. Whereas with the interest stream, the larger interest payments take place at the beginning of the mortgage. I mentioned that the duration of the cash flow is the weighted average of the times. Well, what are these weights? While these weights are given to us down here. So for example, let [UNKNOWN] the duration of the principle stream, then it is give by this quantity here. So I can write this as being equal to the sum from k equals 1 to n of Wk times k. Where Wk is equal to 1 over 12 times V0. And if you recall, V0 is the value of the principal stream of times 0. So Wk equals 1 over 12 times v0 times pk divided by 1 plus r to the power of k. We divide by 12 just to convert duration into annual units, rather than monthly units, because these ks are expressed monthly. So, for example, if k equals 6, that refers to month 6. So these are the weights. So notice that what we're doing is. We're saying that the duration is the weighted hours of the times at which each of the components in the cash flow is received. The particular cash flow at time k has value equal to this piece here that I'm circling. So, the weight Wk is proportional to the value of the cash flow received that time. And in fact, it's equal to the value of that cash flow divided by 1 over 12 times v 0. Recall then, that v0 is equal to the sum nk equals 1 of the Pk's divided by 1 plus r to the power of k. So, this is the value today. The present value of the principal payment stream. So, in fact, these weights, they actually sum to 1. If I ignore the factor of 1 over 12 here, which is just converting the months into, into years. So this is the duration of the principal stream. It tells us how long on average we have to wait until we receive the cash flows from that stream. The idea is that the longer the duration, the more risky the cash flow is because there's more uncertainty over interest rates and, and the timing of those cash flows. So generally, a longer duration is viewed as being equivalent to a riskier stream of cash flows. Similarly, we can also compute the duration DI of the interest-only stream as follows. DI equals 1 over 12W0 times the summation from k equals 1 to n of k times Ik divided by 1 plus r to the power of k. Now, we can actually think of this as being a weighted average of the times at which the payments occur in the interest-only stream. So we can write this as being a summation from k equals 1 to n of little wk times k, where wk is equal to 1 over 12 times w0, Ik divided by 1 plus R to the power of K. So I can think of the Di as being a weighted average of the times at which the payments in the interest only stream occur. This extra factor, 1 over 12 here, this just used to convert the duration into units of years rather than months. So I have this expression here. I also know what Ik is equal to. It's equal to B minus pk. So I can substitute B minus Bk in for Ik and get the second equation. And then, break it up to get this expression here. We saw what Dp was on the previous slide. And if I want to, I could actually substitute in for B as well. I know the value for B. I could substitute in here as well and simplify the expression down further. And so, I can get the duration of the interest-only mortgage backed security as well. In practice, of course, prepayments do occur to this point we have assumed they do not occur, but this is not realistic. Pass throughs do experience prepayments and the principle-only and interest-only cash flows must reflect these prepayments correctly. This is actually straightforward to do, although, I would mention that one should always be aware of the legal documentation in these securities [COUGH] but this is straightforward. The interest payment in period k is simply as before, c times Mk minus 1, where Mk minus 1 is the mortgage balance at the end of period k minus 1. In practice, of course, prepayments do occur. To this point, we've assumed they do not occur, but this is not realistic. Passthroughs do experience prepayments, and the principal-only and interest-only cash flows must reflect these prepayments correctly, but this is straightforward. The interest payment in period k is simply, as before, c times Mk minus 1 or Mk minus 1 is the mortgage balance at the end of period k minus 1. Mk, the mortgage balance at the end of period k must now be calculated iteratively on a path by path basis. So Mk is equal to Mk minus 1 minus the scheduled principle payment at time k minus any prepayments that take place at time k. So because the prepayments that take place at time k are random, it therefore means that Mk will also be rounded and that's what I mean by on a path by path basis. So the outstanding principle at time k will depend on the how the uncertainty in the economy has resolved between time periods 0 and k. Finally, the risk profiles of principal-only and interest-only securities are very different from one another. And this is one of the reasons I want to discuss principal-only and interest-only mortgage box securities. Even though, they are both constructed from the same underline pull of mortgages, they actually have very different risk profiles indeed. And in fact, they can be very risky securities. The principal-only investor would clearly like prepayments to increase. Now, why is that the case? Well, if you think about it, the principal-only investor is entitled to receive the principle stream from the underlined mortgages. That investor would prefer those principle payments to occur sooner rather than later. This just reflects the fact that money has a time value. And so, therefore, the principal-only investor would prepayments to increase. On the other hand, the interest-only investor wants prepayments to decrease. The interest-only investor earns only the interest payments, so interest payments are a function of the outstanding principle. The higher the outstanding principle at any point in time, the higher the corresponding interest payment at that point in time. So all other things being equal, the interest-only investor would like prepayments to decrease. And in fact, in an extreme case to see this, imagine that the entire principal pool repays immediately. So imagine an interest-only investor who owns the interest, who owns the interest-only stream, and suppose the underlying mortgages are prepay immediately. Well then, the interest-only investor will get nothing, because all of the principal will have been repaid, and so the outstanding interest on that principal will be 0. There will be no principal remaining, so no one interest will be paid, and so the interest-only investor will get nothing. So in the extreme case, you could see how an interest-only investor would receive nothing from this fixed income security. So I hope this makes clear to you that the principle only and interest only securities have very different behaviors. In fact, the interest only security is that rare fixed income security whose price tends to follow the general level of interest rates. When rates fall, the value of the interest-only security tends to decrease. And when interest rates increase, the expected cash flow increases due to few prepayments, but the discount factor decreases. The net effect can be a rise or fall in the value of the interest-only security.

## 024.CMOs and Pricing Mortgage-Backed Securities

### 042. Collateralized Mortgage Obligations (CMOs)

In this module we're going to discuss collateralized mortgage obligations or CMOs. CMOs are a class of mortgage backed securities that are created from underlying pools of mortgages or underlying pass-through securities or indeed underlying mortgage backed securities. We're going to see how tranches are created. We're going to see an example of sequential CMO where we've got four tranches, tranche A, tranche B, tranche C and tranche D. And we'll see how these tranches are created and how they've got different risk profiles that might appeal to different investors. In this module we're going to discuss briefly what are called collateralized mortgage obligations or CMOs. CMOs are mortgage-backed securities that have been created by redirecting the cash-flows from other mortgage securities. They are created mainly to mitigate prepayment risk, and create securities that are better suited to potential investors. In practice, CMOs are often created from pass-through's, so we've seen already what pass-through mortgage backed securities are, but they can also be created from other mortgage backed securities, including for example, principal loaning backed securities. Now there are many types of CMOs. They include what are called sequential CMOs, CMOs with accrual bonds, CMOs with floating rate and inverse floating rate tranches and planned amortization class CMOs or PAC CMOs. We're only going to briefly discuss sequential CMOs and I would point out here that the reason we're going through this module is just to give ourselves an idea of how these securities are constructed. To give ourselves another example of securitization. The results of our worksheet, it's the third worksheet in our XL workbook, which shows how a sequential CMO is created and shows how the cashflows for the different tranches in a sequential CMO are created. But I will emphasize here that this material, it's just there to show us how these securities are constructed and to give us an example of these securities. So, don't worry too much about the details, the details aren't particularly important. The basic structure of a sequential CMO is that there are several what are called tranches. Now this word appears very often into the securitization world. We're going to see it again when we discuss credit derivatives and what I call CDOs. So the basic structure of a sequqnetial CMO is that there are several tranches which are ordered in such a way that they are retired sequentially. What do I mean by that? Well, for example, the payment structure of a sequential CMO with tranches a, b, c, and d might be as follows. Number one, periodic coupon interest is disbursed to each tranche on the basis of the amount of principal outstanding in the tranche in the beginning of the period. Number two, all principal payments are disbursed to tranche A until it is paid off entirely. After tranche A has been paid off, all principal payments are dispersed to tranche B, until it is payed off entirely. After tranche B has been paid off, all principal payments are dispersed to tranche C until it is paid off entirely. And then after tranche C has been paid off, all principal payments are dispersed to tranche D, until it is paid off entirely. So let's translate what we're seeing here, what we're seeing here is that there's going to be four tranches, A, B, C, and D. And when we look at the spreadsheet in a few minutes we'll see what we mean by this. On each tranche the interest will be paid to the investors in each tranche in every period. But principal will not be paid to the holders of each tranche. All of the principle payments will go towards paying tranche A investors. And only when tranche A's principle has been paid off entirely will the principle payments from the underlying mortgage pool be used to pay tranche B. And then, only when all of the principle for tranche B has been paid off will the principle payments go towards tranche C. Then only when tranche Cs principal has been paid, will the principal be used to pay tranche D. That's what we mean by retiring sequentially. The advantages of doing this is that we're creating these four new securities, tranche A, B, C and D in such a way that there's more certainty around when these tranches will get their payments. Here's our earlier picture showing the process of securitization. Again, you could imagine that we've got 10,000 mortgages forming a pool of mortgages. These mortgages formed the collateral for our sequential CMO, so there's going to be tranche A, tranche B, tranche C and tranche D. These are all securities, so this is a security an investor can buy tranche a if you like. This is a security, this is a security and this is Is a security. So investors can come along and buy A, B, C, or D. These are four different types of securities. Their all constructed from the underlying 10,000 loans or 10,000 securities. But in order to get a better idea of actually how this sequencial CMO works, its actually much easier to go to our spread sheet and that's what we'll do. So here is our spreadsheet with our sequential pay CMO. The first thing to keep in mind is that this spreadsheet is constructed using the pass through spreadsheet we looked at earlier. So the pass through spreadsheet we looked at in an earlier module, this pass through mortgage, this, this pool of mortgages, of $400 million worth of mortgages, for example. Can be used to actually create a new set of securities and these new sets of securities give us the sequential pay CMO. So up here what we have is the following, we have a total of $400 million, that's from the underlying pass through on the other worksheet. We've split this $400 million into different notions, $194.5 million for tranche A, $36 million for tranche B, $96.5 million for transche C and $73 million for tranche D. We're going to assume that the underlying coupon rate for all four charges is 7.5% and of course, this is the same 7.5% that we saw on the pass through. The underlying pass through had a pass through rate of 7.5%. So, that gives us these four new securities. So we've got four new securities, each of them have different principle amounts but the sum of the four principal amounts must be equal to 400 million dollars, the sum of the principal of the underlying pass through security. We then have our months, again, just to show us all the payments on one screen, I've assumed that we're only going to have 17 payments, or 17 months. in reality, you can have many more months than this, up to maybe 240 or 360, as I said earlier. we start off with our balances for each if the tranche, so tranche A balance is 194.5 to begin with, tranche B is 36, which is what we have up here, tranche C is 96.5, which is what we have here, and tranche D is 73.0. Now, what we do is, we follow the instructions on the, on the and two slides ago, which tells us how interest and principle are paid on each of these trenches. So notice that the principle is decreasing on trench eight, for the first nine months until there is no interest or no principle remaining. It is only at that point that the principle in trench B starts to be repaid. Notice that the principle on trans B remains 36 on every period until the principle on trans A has been repaid and only at that point does the principle on trans B start being repaid. Likewise the principle on trans C remains 96.5 until such time as the principle on trans B has been repaid entirely, only then is tranche C paid down. Likewise, on Tranche D it starts off with a principal of 73 and it remains 73 until the principal on all the previous Tranches has been paid down and only after that point is the principal on Tranche D paid. Notice these principal payments by the way Are the principle payments that are calculated from the underlying passthrough on the previous worksheet. If you look at the formula, you'll see that it refers to the passthrough worksheet. Passthrough here is the worksheet here. So the principle payments are computed from the underlying passthrough and they are here. So, 22.533 That is the principal payment that appears over here. So what we're doing here is constructing a mortgage-backed-security, or CMO, with different tranches, so an investor could invest in tranche a or another investor could invest in tranche b, and so on. And they're going to get the schedule of cash flows. one thing to notice here as well is we've actually calculated the average life of each tranche . So you can see how the average life is calculated by looking at this formula. Not surprisingly, the average life in years of tranche A, is less than tranche B, is less than trance C, and is less than trance D. So for trans A, it's 0.4 years, for trans B it's 0.8 years, trans C it's 1.04 years, trans D it's 1.33 years. And of course that's understood by the fact that the principle in trans B gets payed, and so on. So what we've succeeded in doing here, is taking the underlying pass through and instead of just leaving it as a pass 3 mortgage backed security, we constructed a more complicated mortgage backed security, where the underlying charges have very dis, different risk profiles. Some investors might like a, a security with a shorter average life, other investors might prefer a security with a longer average life. And so they might prefer trans d to trans a. And why are we doing all of this? Well it goes back to that comment we made in an earlier module about securitization. The economic, or big picture goal behind securitization is the idea of spreading the risk. An investor may not want to invest in the pass through security. They may not like an average life of .76 years, however, that same investor may like a security with an average life of 0.4 and so they may be willing to buy this tranche, even though they would not buy the underlying pass-through. Likewise, there may be another investor who does not like the pass-through security, but they do like tranche D, with the longer average life. So by constructing new securities with very different risk profiles out of the same underlined pool of loans, you can actually potentially appeal to more investors. And therefore share the risk among investors who want to hold different types of risks. This prepayment multiplier by the way is the same prepayment multiplier of the underlying pass through. Remember, it's the underlying pass through security which is actually creating the cash flows that feed into the four trenches of the CMO. Finally, in practice you would actually have many more periods here, it wouldn't just be 17 periods, it would be maybe 240 and if I change it 240 here, it will also change appropriately over here. So now you can get a better sense. So in this case with a 240 period Sequential CMO, the average life of tranche A is four years, the average life of tranche C is 11.93 years, and so on. And the, these tranches will have there, therefore have very different risk profiles.

### 043. Pricing Mortgage-Backed Securities

In this module, the final module on mortgage backed securities, we're going to discuss prepayment modeling and the pricing and deed of mortgage backed securities. We'll see an example of a prepayment model and we'll see some of the factors that go into a prepayment model, but we will also mention that there are very few prepayment models that are available in the public domain. When it comes to pricing mortgage-backed securities, it is a very difficult exercise. We need to use Monte Carlo simulation, typically, to price these securities. They're very complicated, and they're very computationally intensive to price. So, we will just be discussing the big picture here. A little bit about prepayment modeling and a little bit about the pricing of mortgage-backed securities. In many respects, the prepayment model is the most important feature of any residential mortgage backed security pricing engine. Term structure models, which are also required to price mortgage backed securities are well understood in the financial engineering community. But this is not true in prepayment models. For example we can think of our binomial model that we saw that we used on price fixed income derivatives. That's an example of a term structure model and there are many term structure models that are out there in the quantitative finals community. They're well understood and people understand how to work with them. A mortgage backed security is exposed both to interest rate risk, which is why you need a term structure model but also it is exposed to prepayment risk. And so you would also need a model of prepayments, a model of how home owners in the underlying mortgage boosts of how they are going to prepay. So a prepayment model is also very important when it comes to processing mortgage backed securities. The problem is that there's relatively little publicly available information concerning prepayment rates. So it is very difficult to construct good prepayment models, accurate prepayment models, and to calibrate these prepayment models as well, in other words, to figure out what the correct parameter values are inside these prepayment models. One very well known publicly available model is due to Richard and Roll from 1989. And they model the conditional prepayment rate, the CPR, whose definition we recall. The CPR is the rate at which a given mortgage pool prepays. It is expressed as a percentage of the current outstanding principle level in the underlying mortgage pool. It is also expressed, by the way, as an annual rate. And we have seen that before as well. So let's take a brief look at this model due to Rich and Roll. I want to emphasize that, the vast majority of the prepayment models that are out there are private, they are not published, nobody knows what they are. They're just used by banks and other investment companies to invest in mortgage backed securities. And they don't share their models with other people. So it is very difficult to find good prepayment models that are out there in the public domain. So this is the prepayment model of Rich and Roll. It looks very complicated, but I don't want anybody watching this video to think that the need to understand everything inside here. The idea is just to give us an, a sense of how one might go about constructing a prepayment model. And in particular a model for the CPR. So this model of Richard and Roll assumes the following; So they assumes that the CPR time k is equal to the RI which is the Refinancing Incentive times the H which is the Seasoning Multiplier. Times the MM which is the Monthly Multiplier times BM which is the Burnout Multiplier, now what are all these multipliers. Well the refinancing incentive is something we've discussed before, lets not worry about the form of this here really that's not relevant, the only point I want to emphasis here is this. WAC if you, you recall is the weighted average Coupon in the underlying mortgage pool. And RK10 here, we're assuming, is the ten year spot interest rate. Now, why is this differnece relative? Well, remember we said that homeowners have an option to prepay their mortgage. So, for example, suppose the weighted average coupon was, let's take an example suppose WACwas equal to 10%, and suppose RK, in other words the ten year interest rate at time k, was equal to 3%. Well then this difference here is 7%. And it represents how much money in, homeowners could make by prepaying their mortgage. And refinancing at a lower interest rate. Now they wouldn't be able to refinance at 3%. This rate would be too low. But maybe they'd be able to refinance at r plus 2%. Which would be 5%. So therefore, they could prepay their mortgage where, on which they're currently paying 10%, and refinance at 5%, that would be a large gain. So this number here, WAC minus arc A10, represents the incentive to refinance, and that's why we call it R I. And so the larger this number is, the more prepayments you're going to get. So in fact this number here, although it may be difficult to see it when you've got this inverse tan function. But this RIk here will increase as WAC minus RK10 increases. And therefore it will increase the CPR. Age is what's called the seasoning multiplier, so again T is measured in months and it's a minimum of 1NT over 30. This is just meant to capture the fact that early in the lifetime of a mortgage a homeowner is very unlikely to prepay. After all if they've just taken out a mortgage maybe it's because they just bought a new home. It's very unlikely they're going to be moving home in the next year or two, and therefore we said age equal to the minimum of 1 over T30. So when T is just one month or six months this number here is very small and so it multiplies in here to give it a very small CPR, in the earlier life of a mortgage pool. And M is the monthly multiplier, so it's approximately equal to one. There's a different for each month, January through December, they're all close to one, but some of them are less than one, and some of them are greater than one, and this is just used to reflect the fact that. People tend to prepay at different times of the year. For example, there tends to be more activity in the housing market in spring and summer, for example, than in winter. And so, in winter, you have a number, in the winter months, you have a number less than one. And maybe in the spring, summer months, you might have a number greater than one. So this is the monthly multiplier, and then bmk is what's called the burnout multiplier. So for example, in this case, we could say bmk equals .3 plus .7 minus m k minus one over m zero. So for example, this is equal to one when K equal one and that's equal to .3. When k is well approximately n close to the end of the mortgage. And what this is reflecting is the following. So early on in the life of the mortgage. This burnout multiplier is equal to one. But it decreases linearly through the life of the mortgage and falls to .3 at the very end. And this is just used to reflect the fact that people who can prepay tend to prepay early. For various reasons, there are some people who have houses who can't prepay or who don't want to prepay and those people, if they haven't prepaid early in the life of the mortgage, then it turns out that they become increasingly less likely to ever prepay. And so that's the burnout multiplier. Now as I said at the beginning of this slide, don't worry about the details. I just want to give you an example of how some people might go about modeling this conditional prepayment rate. By the way, another comment on the spreadsheet in the work sheets in the excel work book that we've looked at so far, we always assumed that the CPR was deterministic. We used the so called PSA benchmark, I mentioned that in the real world. Of course the conditional prepayment rate will be random. It will depend on what's going on in the economy. And certainly that randomness is captured, for example, over here. The ten year spot rate, at time k, is random. So certainly the refinancing incentive will also be random. So, again just emphasizing the fact that in the real world the cash rolls are associated mortgage back securities are indeed random. How about choosing a term-structure model. Well, we also need to specify term-structure model IE, a model like the binomial model, the black term and[UNKNOWN] model or[UNKNOWN] model for example that we use to price fixing and derivatives. In order to fully specify the mortgage pricing model the term structure model is used to; one. Discount all of the Mortgage Back Security cash-flows in the usual risk-natural pricing framework but also to compute the refinancing incentive according to 15. Whatever term structure model is used it is important that we are able to compute the relevant interest rates analytically. For example, r10 in the prepayment model of Richard and Roll. Such a model would need to be calibrated to the time structure of interest rates, in the market place, as well as the liquid interest rate derivative securities like caps, floors, swaptions, and so on. The actual pricing of mortgage backed securities then requires Monte Carlo simulation. It is very very computationally intensive. Analytic prices are not available. So the point I want you to take away from the slide, and this module more generally is that the pricing by mortgage by security is, is very complicated. It takes and awful lot of work and an awful lot of modeling and it is very computationally intensive. You don't have to worry about the details I've mentioned here. As I've said before I just want you to understand the big picture of what is going on. Finally let me say a little bit about the financial crisis. The so called sub prime mortgage market played an important role in the financial crisis of 2008 and 2009. Sub prime mortgages are mortgages that are issued to homeowners with very weak credit. The true credit quality of the homeowners was often hidden. And the mortgages that were given to these sub prime. Homeowners were often ARMs. Remember an ARM is an adjustable rate mortgage where the mortgage rate is reset periodically. While the adjustable rate mortgages that were given to sub prime homeowners often had what were called teaser rates. In other words the initial mortgage rate was very, very low. And that was used to attract new homeowners to encourage them to take out mortgages that maybe they should not have been taking out in the first place. Because the very initial low rates made them easy to service, easy to make the payments in the earlier life of the mortgage. But after two or three years, these teaser rates were replaced with much higher coupon rates, and so become much harder for the subprime homeowners to pay these higher coupon rates. The financial engineering aspect of the MBS-ABS market certainly played a role in the crisis. Particularly when you combine this with the alphabet soup of CDO's and ABS-CDO's. And so on. We actually will discuss CDO's later in this course. So the financial engineering aspect certainly played a role. The securitization that took place became very, very complicated and it became very difficult to understand some of these very complicated securities. And also because these securities became so complicated, the models that were used to price these securities also became very difficult to understand. And people started to lose trust in these models as well. So certainly financial engineering played a role in the financial crisis. But it has to be said there are many other causes as well including the moral hazard problem with mortgage brokers. What is the moral hazard problem. Well the moral hazard problem is the problem of getting people to behave the right way. If they're given incentives to behave in the wrong way, they may well end up behaving poorly. So, for example, some of the mortgage brokers that sold these mortgages to sub-prime home, homeowners, they weren't careful about checking the paperwork and the credit worthiness of these homeowners. And the reason they weren't is they weren't going to be holding these mortgages themselves. They were going to be selling these mortgages on to other groups. Other agencies other banks who would hold the mortgages via mortgages bank securities. So they didn't have to worry about. The sub prime homeowners for example defaulting on their mortgages that would not be their problem and so that is the moral housing problem that I am referring to. Rating agencies also face moral housing problems. the problem at rating agencies is that they were rating mortgage backed securities and asset backed securities more generally. For the banks that were creating them. So they were being paid by banks to do the ratings. Well obviously there is a moral hazard problem there as well. There was inadequate regulation, inadequate risk management, and poor corporate governance in general. So there were many, many parties to blame for the financial crisis. Certainly some of the financial engineering behind the very exotic and complicated mortgage banks securities and asset bank securities share some of the blame. But certainly I would say these other sources here were very much responsible as well.

## 025.I

### 044. Review of Basic Probability

>> We're now going to review some of the basic concepts from probability. We'll discuss expectations and variances, we'll discuss Bayes' theorem, and we'll also review some of the commonly used distributions from probability theory. These include the binomial and Poisson distributions as well as the normal and log normal distributions. First of all, I just want to remind all of us what's a cumulative distribution function is. A CDF, a cumulative distribution function is f of x, we're going to use f of x to denote the CDF and we define f of x to be equal to a probability that a random variable x is less than or equal to little x. Okay. We also, for discrete random variables, have what's called a probability mass function. Okay. And a probability mass function, which we'll denote with little p, it satisfies the following properties. P is greater than or equal to 0, and for all events, A, we have that the probability that x is in A, okay, is equal to the sum of p of x over all those outcomes x that are in the event A. Okay. The expected value of a discrete random variable, x, is then given to us by this over here. So, it's the sum of the possible values of the random variable x. These are the xi's, weighted by their probabilities, p of xi. So, that's the expected value of x. If I was to give you an example. Suppose, for example I tosses a dice. So, it takes on 6 possible values. Okay, 1, 2, 3, 4, 5, and 6. Okay. And it takes on each of these values with probability, so that's wp, with probability 1 6th, with probability 1 6th and all the way down 1 6th. So, in this case, for example, the probability that x is greater than or equal to 4 is equal to, well, it's 1 6th for 4, 1 6th for 5, and 1 6th for 6, so that's equal to 1 6th plus 1 6th plus 1 6th equals 1 half. Likewise, we can compute the expected value of x. In this case, it is equal to 1 6th times 1 plus 1 6th times 2, and so on, plus 1 6th times 6. And that comes out to be 3 and a half. Okay. So, we also have the variance of a random variable. It's defined as the expected value of x minus the expected value of x, all to be squared. And if you expand this quantity out, you can see that you'll also get this alternative representation, so that the variance of x is also equal to the expected value of x squared minus the expected value of x, all to be squared. Okay. So, there, a discrete round of variables, probability mass function, and so on. So, let's look at a couple of distributions. The first distribution I want to talk about is the binomial distribution. We say that a random variable x has a binomial distribution, and we write it as x tilde binomial, or bin n, p, if the probability that x is equal to r, is equal to n choose r times p to the r by 1 minus p to the n minus r. And for those of you who have forgotten, n choose r is equal to n factorial divided by r factorial times n minus r factorial. So, the binomial distribution arises, for example, in the following situation. Suppose we toss a coin n times, and we count the number of heads. Well then, the total number of heads has a binomial distribution and we're assuming here that these are independent coin tosses so that the result of one coin toss has no impact or influence on the, the outcome of other coin tosses. The mean and variance of the binomial distribution are given to you by these quantities here. So, the expected value of x equals np, the variance of x equals np times 1 minus p. Now, there's actually an interesting application of the binomial distribution to finance. And it actually arises in the context of analyzing fund manager performance. We'll actually return to this example later in the course. But let me just give you a little flavor of it now. So, suppose, for example, a fund manager outperforms the market in any given year, with probability p. And that she underperforms the market at probability 1 minus p. So, we're assuming here that the fund manager either outperforms or underperforms the market, only two possible outcomes. And that they occur with probabilities p and 1 minus p respectively. Suppose this fund manager has a track record of ten years, and that she has outperformed the market in eight of these ten years. Moreover, let's assume that the performance, the fund manager performance in any one year is independent of the performance in other years. So, a question that many of us would like to ask is the following. How likely is a track record as good as this outperforming eight years out of ten, if the fund manager had no skill? And, of course, if the fund manager had no skill, we could assume maybe that p is equal 1 half. Okay. So, actually, we can answer this question using the binomial model, or the binomial distribution. So, let x be the number of outperforming years. Since the fund manager has no skill, then there are ten years, and the total number of outperforming years x, is then binomial, with n equals 10, 10 years, and p equals a half, okay? So, we can then compute the probability that the phone manager does at least as well as outperforming in eight years out of ten, by calculating the probability that X is greater than or equal to 8. So, what we're doing here is calculating the probability that the fund manager would have 8, 9, or 10 years out of 10 in which she outperformed the market. And that is given to us by the sum of these binomial probabilities here. So, these were the original binomial probabilities on each slide, and we summed them from r equals 8, to n. And n, in this case, of course, is 10, okay? So, that's one way to try and evaluate whether the fund manager has just been lucky or not. One can compute this probability and if it's very small, then you might conclude that the fund manager was not lucky and that she had some skill. But actually, this opens up a whole can of worms. There are a lot of other related questions that are very interesting. Suppose there are M fund managers, how well should the best one do over the ten-year period if none of them had any skill? So, in this case, you don't have just one fund manager as we had in this example so far, we now have M of them, okay? And it stands to reason that even if none of them had any skill, then as M gets large, you would expect at least one of them or even a few of them to do very well. Well, how can you analyze that? Again, you can use the binomial model and what are called order statistics of the binomial model to do this. And we'll actually return to this question later in the course. Okay. So, let's talk about another distribution that often arises in finance and financial engineering, that is the Poisson distribution. We say, that x has a Poisson lambda distribution so lambda is the parameter of the distribution. If the probability that x equals r is equal to the lambda to the power of r times e to the minus lambda, divided by r factorial. And for those who have forgotten factorials, I also used it in the binomial model a while ago. R factorial is equal to r times r minus 1 times r minus 2, all the way down to 2 times 1. Okay. So, this is the Poisson distribution. The expected value and the variance of a Poisson random variable are identical and equal to lambda. So, for example, we'll actually just show this result here. It's very simple and the mean is calculated as follows. We know that the expected value of x is equal to the sum of the possible values of x, so these are the r's, times the probability that x is equal to r and r runs from 0 to infinity. We can calculate that as follows. So, we have the summation of r and the probability that X equals r. We know from up here, okay, and we can substitute that down in here and now, we just evaluate the sum. The first thing to notice is that when r equals 0, this term in the sum is equal to 0. So, we can actually ignore the 0, the first element, the 0 element and replace the summation running from r equals 1. So then, we get this quantity here. We can cancel this r out with the first r up here and write, this is r minus 1 factorial. We can also pull one of these lambdas out here leaving us with a lambda to the r minus 1. And now, if we look at this quantity here, this summation here, we see that this is the same as changing this to run from r equals 1 to r equals 0 and replacing r minus 1 with r and r minus 1 factorial with r factorial here. This total we see is equal to the sum of the probabilities. These are the probability that x equals r, so this is the sum of the probabilities that x equals 0, x equals 1, x equals 2, so this is equal to 1. The total sum of probabilities must be equal to 1, so this is equal to lambda. Okay, let's talk a little bit now about Bayes' theorem. Let A and B be two events for which the probability of B is nonzero, then the probability if A given B, and this is notation we'll use throughout the course, this vertical line means it's a conditional probability. S,o it's the probability of A given that B has occurred, well, this is equal to the probability of A intersection B divided by the probability of B. Alternatively, we can actually write this, this numerator probably of A intersection B, as being the probability of B given A by the probability of A. So, this is another way to write a Bayes' theorem. And finally, if we like, we can actually expand the denominator here, the probability of B, and write it as the summation of the probability of B given Aj, by the probability of Aj. Let me sum over all Aj's. For the Aj's, form a partition of the sample-space. What do I mean by partition? Well, I mean the following. So, Ai intersection Aj is equal to the null set, for i not equal to j, and at least 1 Ai, at least, at least one Ai must occur. And, in fact, because Ai intersection Aj is equal to the null set, for i not equal to j, I can actually replace this condition with the following, exactly one Ai must occur. Okay. So, that's Bayes' theorem. Let's look at an example. So, here's an example where we're going to toss 2 fair 6-sided dice. So, Y1 is going to be the outcome of the first toss, and Y2 would be the outcome of the second toss. X is equal to the sum of the two, and that's what we plotted in the table here. So, for example, the 9 here comes from the 5 on the first toss and 4 on the second toss. So, 4 plus 5 equals 9. So, that's X equals Y1 plus Y2. So, the question we're interested in answering is the following. What is the probability of Y1 being greater than or equal to 4, given that x is greater than or equal to 8? Well, we can answer this using this guy here on the previous slide. So, this is equal to the probability that Y1 is greater than or equal to 4 and X is greater than or equal to 8, divided by the probability that X is greater than or equal to 8. Okay. So, how do we calculate these two quantities? Let's look at the numerator first of all. So, we need two events here. Y1 must be greater than or equal to 4 and X being greater than or equal to 8. Okay. So, the first event is clearly captured inside this box here, okay, because this corresponds to Y1 being greater than or equal to 4. So, all of these outcomes correspond to that event. The event that X is greater than or equal to 8 corresponds to this event or these outcomes. So therefore, the intersection of these two outcomes, where Y1 is greater than or equal to 4 and X is greater than or equal to 8, is this area here, which is very light, so let me do it a little bit darker. So, it's this area here. Now, each of these cells is equally probable and occurs at probability 1 over 36. There are a total of 3, 4, 7, plus 5, 12. So that's 12 cells here. So, the numerator occurs with probability 12 over 36. And the, the denominator, the probability that X is greater than or equal to 8, well, that's what we highlighted in the red here. And the probability of that occurring, well, there's 12 plus these 3 additional outcomes equals 15 outcomes. So, that's 15 over 36, and that is equal to 4 over 5. So, that's our application of, of Bayes' theorem. Okay. So, let me talk a little about continuous random variables. We say a continuous random variable x has a probability density function, or a PDF, f. If f of x is greater or equal to 0, and for all events, A, the probability that x is in A, or the probability that A has occurred is the integral of the density, f of y, dy over A. The CDF, cumulative distribution function, and the PDF are related as follows, f of x is equal to the integral from minus infinity to little x of f of y dy. And, of course, that's because we know that f of x, by definition, is equal to the probability that X is less than or equal to x, so this, of course, is equal to the probability that minus infinity is less than or equal to X, is less than or equal to little x. So, this is our event A here and this definition here. So, A is now integrated from, A is now the event minus infinity less than or equal to the random variable x, less than or equal to little x, so that's what we have over here. So, it's often convenient to recognize the following, that the probability that x is in this little integral here, x minus epsilon of 2 and x plus epsilon over 2. Well, that's equal to this integral, x minus epsilon over 2 to x plus epsilon over 2 times f of y dy, okay? And if you like, we can draw, something like this. So, this could be the density, f of x. This is x here, maybe we've got some point here which is little x, and this is x minus epsilon over 2. This is x plus epsilon over 2. So, in fact, what we're saying is that the probability is this shaded area, and it's roughly equal to this value, which is f of x times epsilon, which is the width of this interval here, okay? And, of course, the approximation clearly works much better as epsilon gets very small. Okay. So, there are continuous random variables. Let me talk briefly about the normal distribution. We say that X has a normal distribution or write X tilde N mu sigma squared if it has this density function here. So, f of x equals 1 over root 2 pi sigma squared times the exponential of minus x minus mu, all to be squared divided by 2 sigma squared. The mean and variance are given to us by mu and sigma squared respectively. So, the normal distributions are very important distribution in practice, its mean is at mu, its mode, the highest point in the density is also at mu and approximately 95% of the probability actually lies within plus or minus 2 standard deviations of the mean. So, this is approximately equal to 95% for a normal distribution. Okay. So, this is a very famous distribution. It arises an awful lot in finance. It certainly has its weaknesses and we'll discuss some of them as well later in the course. A related distribution is the log-normal distribution. And we will write that x has got a log-normal distribution with parameters mu and sigma squared if the log of x, is normally distributed with mean mu and variance sigma squared. The mean and variance of the log-normal distribution as given to us by these two quantities here, and again, the log-normal distribution plays a very important role in financial applications.

### 045. Review of Conditional Expectations and Variances

We're now going to review the concepts of conditional expectation and conditional variances. We'll see that conditional expectations identity as well as the conditional variance identity, and we'll see an example where we put them to work. This material is useful because we will use it later in the course when we discuss credit derivitives. When x and y be two random variables, then the conditional expectation identity states that the expected value of x can be calculated as follows. We first compute the expected value of x conditional on y and then we actually compute the expected value of that quantity. Likewise, the conditional variance identity states that we can compute the variance of x as the summation of two quantities. First of all, we can compute the expected value of x given y, and then compute the variance of this quantity. And then, also compute the variance of the expected value, sorry, then compute the variance of x given y and compute the expected value of this quantity. Okay. One thing I want to emphasize here is that the expected value of x given y, and the variance of x given y, are both functions of y, and are there for random variables themselves. So for example, I actually could write this as g of y, say, so this is also a g of y, and maybe the variance of x given y, I could write as h of y. So g of y, and h of y, are random variables. So in fact, I can write the expected value of x, as being the expected value of g of y, okay. And, I can write the variance, of x, as then being equal to the variance, of the random variable g of y. Plus the expected value of the random variable h of y. Okay so there the conditional expectation and conditional variance identities and they can be very useful in many applications. So we'll see one application here. So, we want to compute a random sum of random variables. In particular we're going to that w equal to x1 plus x2 and so on up to xn where the xi's are IID with mean ux and variance sigma x squared. But where n is also a random variable and this random variable is assumed to be independent of the variable xi's. So the question that arises is the following. What is the expected value w? Well I can compute the expected value of w using the conditional expectation identity. In particular the expected value of w. Well, over here I can write that as being equal to the expected value of the expected value of w given n. And this quantity here inside here is w. Okay. So the expected value of w, given n, if you think about it, the expected value of w, given n, is equal to the expected value of this summation, i equals 1 to n of the xi's. And because n is a constant, given n, I should have an n here, okay. This is equal to the sum, n, i equals 1, of the expected value of the xi's, and this is equal to, well this is equal to mu x. And there's n terms, so that's n mu x. And that's where this comes from here. Okay. So now the mu x is a constant. We can take it outside the outer expectation over here, and we're left with the expected value of N. So that's how we compute the expected value of w. How about the variance of w. Well, we can compute the variance of w by using the conditional variance identity. So this is the variance identity here. We've already calculated the expected value of w given n. It's equal to n times mu x, so that's what this quantity is down here. The variance of w given n, well that's the variance of this quantity given n. These are n IID rounding variables and the variance of n IID rounding variables is simply n times the variance of one of them, which is sigma x squared. And so we get n times sigma x squared here. So now, the variance of mu x times n, well mu x is a constant, so it comes out the variance, outside the variance is a square. And we're left with mu x squared times the variance of n. And over here, sigma x squared is a constant, and it comes outside the expectation, and we're left the expected value of n. So that's how we compute the variance of w. So here's an example with chickens and eggs. A hen lays n eggs where n is plus on with parameter lambda. Each egg hatches and yields a chicken with probability p independently of the other eggs and then. Let k be the number of chickens. So the first question I want to ask is, what is the expected value of k given n? And of course one of the reasons I want to ask this question is because I want to introduce indicator functions, which are often very useful in probability, and in fact we'll use them later in the course. We'll be using indicator functions later in the course to describe the event of companies defaulting on their bonds. So we'll use it to compute the expected number of defaults in the basket of bonds for example. So it's a good place right now, we could add here right now to introduce these indicator functions. So what we're going to do is we're going to write the total number of chickens, k, as being the sum from I equals 1 to capital N times one subscript hi where hi is the event that the ith egg hatches. Okay. So in particular, one subscript to hi. This is the indicator function, and it takes on 2 possible values. It takes on the value 1 if the ith egg hatches. And it takes on the value 0 otherwise. So in fact that's an indicator function in general it takes on two values one and zero. One if the event in question occurs zero otherwise. In this particular example the event in question is hi which is the event that the ith egg hatches. Okay so we've written k as the sum from i equals 1 to n of these indicator functions. It's also clear that the expected value of one of these indicator functions is easily computed. In particular, it takes on the value 1 with probability p. It takes on the value 0 with probability 1 minus p, and so this is equal to p. So the expected value of the indicator function 1 hi is equal to p. So now the expected value of k given n is the expected value of this quantity which is k given n and n is a constant at this point because of conditions on its value. So, we can just take the expectation inside the summation and get this, but we know the expected value of 1hi is equal to p. There's n of these terms, so we get np. So therefore the expected value of k given n equals n times p. Which of course is what you'd expect if you've got n eggs and each of them occurs with probability p. You would expect the total number of chickens to be n times p. Okay. So now, we can use the conditional expectation form to compute the expected value of k. The expected value of k is equal to the expected value of the expected value of k, given n. But that, we have calculated there. It's np. So now, the expected value of k is the expected value of np. P is a constant. So it can come outside over here. And the expected value of n? Well n is Poisson we're told and if we recall, the expected value of a Poisson random variable is equal to lamda and so that's why we get the lamda down here. And so we see that the expected number of chickens is equal to lambda times p.

## 026.II

### 046. Review of Multivariate Distributions

>> We're now going to review multivariate distributions. We'll talk about multivariate CDFs, multivariate PDFs, conditional distributions, and so on. Much of this material is a little tedious, a little dull, but we thought it was worthwhile collecting it all and having it in one place for your review if it crops up later in the course. Okay, so let's get started. Let x be a vector of random variables, x 1 up to x n. We say the joint CDF of x is given to us by the following. So, the joint CDF, Fx of little x is equal to the probability that X1 is less than or equal to little x1. X2 is less than or equal to little x2. Up to xn being less than or equal to little x n. And from this joint CDF, we can actually calculate the marginal CDF, so for example, the marginal CDF of Xi is given to us by just plugging infinity into all of the components in the joint CDF except for the ith component which is little xi. Okay, so we can go from the joint CDF to the marginal CDF. It is also straightforward to generalize the previous definition to joint marginal distributions. So for example, if I want the joint CDF of just xi and xj, I can also recover that from the joint CDF of 1 up to xn by placing infinity in all of the arguments, except for the ith argument where I have xi and the jth, where I have xj. We also say that x is a joint PDF or probability density function, f subscript x, if we can write the joint CDF as an integral like this. So, this is just the way we, we, we capture our joint CDF by integrating out the density function by appropriate limits. Okay. We can also talk about conditional CDFs. So what we're going to do is we're going to partition our vector x1 up to xn into two components. The first component is x1, which contains x1 up to xk. And the second component is this boldface x2 which contains xk plus 1 up to xn. And then we can talk about the conditional CDF of x2 given x1, and in fact, it's defined as following, as follows. So the conditional CDF of x2 given x1 is equal to the probability that the random vector x2 is less than or equal to little x2 conditional on x1 being equal to little x1. If x is a PDF, f of x, then the conditional PDF of xx2 is given to us by this quantity here. So it's the joint PDF divided by the marginal PDF of x1, which we can also write like this. Okay. And the conditional CDF, f of x2 given x1, can be determined by integrating the conditional PDF. So this is our conditional PDF, and we can integrate this out with respect to uk1 up to un and that will give us our conditional CDF. Okay, independence. We say the collection x is independent if the joint CDF can be factored into the product of marginal CDFs. So in particular the joint CDF here in the left hand side is equal to the product of the marginal PDFs over here on the right hand side. Similarly, actually, this implies that if x is a PDF fx, then we can also factorize the joint PDF into the product of the marginal PDFs over here. We can also see from one, and one is here on the previous slide. So we can use this, okay, to see that if x1 and x2 are independent, then the conditional PDF of x2 given x1, well by 1, that's equal to this ratio here. So the joint PDF of x divided by the margin PDF of x 1 and by independence here, we can replace the joint PDF by the product. Then these two cancel and we're left with the marginal PDF of x2. So what we're saying here is that if x1 and x2 are independent then the conditional PDF of x2 given x1 is simply the marginal PDF, f of x2. In other words, having information about x1 tells you nothing about x2 when x1 and x2 are independent. Okay. Some implications of independence. Well,and I expect we're all familiar with this, but let's, let's go through it anyway. Let X and Y be independent random variables. Then for any events A and B, the probability that X is in A and Y is in B, well, that factorize into the product of the probability of X being an A times the probability of Y being in B. More generally, for any functions, f and g, independence of X and Y implies the expected value of f of X times g of Y is equal to the expected value of f of X times the expected value of g of Y. And in fact, 2 follows from 3, okay? So the implication goes that way and it's easy to see this, because we can write this probability of X being in A and Y being in B as the expected value of the indicator function of X and A times the indicator function of Y and B. Just to remind ourselves what is this indicator function, while it takes on two possible values, it takes on the value 1 if X is in A and it takes on the value 0 otherwise. So therefore, the product of these two indicator functions is 1 or 0 and will only be 1 if X is in A and Y is in B. Okay? That occurs with probability X and A, and Y and B. So this statement here is correct. Okay, so we've got this first line. And now we can use the independents X and Y in condition three to break down this expectation down into the product of these two seperate expectations. Okay. But of course, this expectation is the probability that X is in A and this expectation is the probability that Y is in B. So indeed we do see that we can go from three to two. Okay. More generally, if X1 up to Xn are independent random variables, then we can write the expected value of f1 of X1, f2 of X2, and so on up to fn of Xn. That factorizes into a product of n separate expectations. The expected value of f1 of X1 times the expected value of f2 of X2 and so on. Random variables can also be conditionally independent. For example, we say that X and Y are conditionally independent given Z, if the expected value of f of X times g of Y given Z is equal to the expected value of f of X given Z times the expected value of g of Y given Z and I should mention this is for all functions f and g. Okay, and in fact, this idea of conditioned independence, we're going to see later in the course, because it's used in the, well, the now infamous Gaussian copula model for pricing CDOs. So just to give you a brief idea of how it might be used in a bond context or a CDO context, let Di be the event that the ith bond in a portfolio defaults, okay? So we'll assume that there is a portfolio of n bonds. Okay. It's not reasonable to assume that the Di's are independent. You might ask, why is that? Well, if you think about it, there will be all sorts of macroeconomic factors or industry specific factors, which will cause defaults to actually be dependent. So for example, maybe some industry crashes that might cause not just one firm to default but multiple firms in that industry to default. And so, it doesn't make sense to assume that these events, these Di's are independent. But, we might be able to say that they're conditionally independent given some other random variable zed. Zed, for example, might reflect some industry factor. Some, some factor that governs how well a particular industry is doing. In that case, if we assume that the default events are conditionally independent given zed, then we can write the probability of D1 up to Dn given Z as being the product of these factors here, probability of D1 given Z up to probability of Dn given Z. And it's actually often easy to compute these quantities. So we'll actually be using this kind of idea later in the course, as I said, when we discuss the Gaussian copula model for pricing CDOs. We'll also see it in a couple of other applications as well. Okay, so very briefly, I also want to mention the mean vector and covariance matrix of a vector round the variables X. I hope we're all familiar with this already, but let's go through it anyway. So the mean vector of X is simply the vector of expected values, expected value of X1 up to expected value of Xn and the covariance matrix of x is. Well, this matrix of covariances. Okay, so, formula is expected value of X minus expected value of X times X minus expected value of X transposed. And just to be clear, this is an n by 1 vector, and this is a 1 by n vector, so the product is n by n. And we get an n by n covariance matrix, with the i, jth element of sigma being the covariance of Xi and Xj. The covariance matrix is symmetric that of course is because the covariance of Xi, Xj is equal to the covariance of Xj and Xi. And this diagonal element satisfies sigma i greater or equal to 0, and of course, the diagonal elements are just the variances. So this is equal to the variance of Xi and variances are always nonnegative. It is also positive semi-definite, so this is a, an important well-known property of a covariance matrix, in particular, it means that X transpose sigma X is greater than or equal to 0 for all vectors X and Rn. The correlation matrix row X is similar to the covariance matrix except it has as its i, jth element, the correlation Xi with Xj itself is symmetric, positive semi-definite, and has 1's along the diagonal. And just to remind ourselves, the correlation of Xi and Xj, is equal to the covariance of Xi and Xj, divided by, well, the square root of the variance of Xi times the variance of Xj. Okay. For any matrix A, which is a k by n matrix and a k by 1 vector A, we can take a linear combination of AX plus little a and we can compute the mean of this vector. So the mean is a times expected value of X plus little a and the covariance matrix of this new vector of random variables is a times the covariance of X times A transpose. And of course, five actually implies this result, which you're probably familiar with, that is the variance of aX plus bY equals a squared variance of X plus b squared variance of Y plus 2ab the covariance of X, Y. Note that if X and Y are independent, then the covariance of X, Y equals 0, but the converse is not true in general. And some people tend to forget this, but it is not in general true that if the covariance of two random variables equals zero, then those two random variables are Independent. That is not true.

### 047. The Multivariate Normal Distribution

>> We are now going to discuss the multivariate normal distribution. The multivariate normal distribution is a very important distribution in finance. It crops up in many different applications including, for example, mean variance analysis and asset allocation, as well as geometric Brownian motion and the Black-Scholes[UNKNOWN]. So we say an n-dimensional vector, X, is multivariate normal with mean vector Mu and covariance matrix Sigma; if the PDF of X is given to us by this quantity here. Okay, so the PDF is equal to 1 over 2 pi to the power of n over 2, times the terminant of the covarience matrix raised to the power of a half, times the exponential of this quantity up here. And be right that X is multivariate normal Mu, sigma. The little subscript n here, denotes the dimensionality of the vector x. The standard multivariate normal, has mean vector mu equal to 0, and variance covariance matrix equal to the n by n identity matrix. And in this case, the xi's are independent. We can actually see that, because in this case we can write, the joint PD f of x, as being equal to the product. I equals one to in. One over route to pie e to the minus a half x i squared. And that follows just from this line here because mu equals zero so this term disappears, and Sigma is just the identity. So, in fact, you just end up with a sum of xi squared divided by 2. So as we saw in an earlier module on multivariant distributions. If the joint PDF factorizes into a product of marginal PDF's, then the random variables are independent. Okay. The moment generating function of x is given to us by this quantity here. So phi subscript x of s is actually a function of s. Okay this vector s. And it's the expected value of e, to the s transpose x. Okay, and this is equal to e to the s, transpose mu, plus a half s transpose sigma s. Now, you're probably familiar with this in the 1 dimensional case, we'll just recover here. Suppose x is really just a scale of random variable, then the moment generating function of x is equal to the expected value of e to the sx, and it's equal to e to the s mu plus the half sigma squared s squared. And this is the case where x is normal with mean mu and variance sigma squared. So this is the moment generating function of the scalar. Normal random variable. This is, it's generalization to a multivariate normal random vector, x. Okay. So, we call our partition we saw in an earlier module. We can break x into two blocks of vectors x1 and x2 as such. We can extend this notation, notation naturally. So we can write Mu equals 1 2, and equals to This sigma 11, sigma 12, sigma 21, sigma 22 and they are the mean vector and covariance matrix of x1, x2. So we have the following results on the marginal conditional distributions of x. The marginal distribution of a multivariate normal random variable is itself normal. In particular the marginal. Distribution of Xi is multivariate normal with mean vector Ui and variance covariance matrix sigma Ii. So for example X1 is multivariate normal, in fact it's k components, mu 1, sigman 1, 1. And similarly X2 is multivariate normal. Mu 2, sigma 2, 2, and this is n minus k components. And we have here an example of the bi-variance normal density function, where the correlation beween x1 and x2 is 80%. If we rotate the service you can see the correlation of 80 percent the large values of X 1 are associated with values of x 2 like all values of x 1 are related to all values of x 2. So we can also talk about the conditional distribution assuming sigma is positive definite. The conditional distribution of the multivariate normal distribution is also multivariate normal. In particular x 2, given that x 1 equals little x 1 is multivariate normal with mean vector mu 2.1. In the variance, covariance matrix, sigma 2.1. Where mu 2 1, is given to us by this expression here, and sigma 2.1 is given to us by this expression here. And we can get some intuition for this result, by just imaging the following situation; so we've got X one down here. We have X two over here, and imagine we plot some points from X one and X two if you like, we generate X one and X two from some distribution, from the bivariate normal distribution, in particular. So the mean of X one is, let's say mew one and the mean of X two is mew two. Okay. Now what if I tell you that we observe that X 1 was equal to this little value X 1. Well if that's the case, then you can come up here and you'll see that X 2 is more likely than not to be in this region as. I'll circle them right here. So in fact you would expect the conventional mean x one equals little x one to be maybe somewhere around here . And this would be near 2.1 okay? Likewise you can see just from this. Again, that the variance of x2 would have shrunk. Because knowing something about x1 would give us information about x2, and that would decrease our uncertainty about the location of x2. And in fact this expression here tells us how to actually do that. This mathematically. So, so they're conditional distributions. A conditional distribution of a multivariate normal is again, multivariate normal. We also mention that the linear combination, ax plus a, of multivariate normal random variable x, is normally distributed with mean, a times the expected value of x plus little a, and covariance mix, matrix a times covariance of x times A transpose.

### 048. Introduction to Martingales

>> In this module we're going to introduce Martingales. Martingales play a very important role in finance. They won't play a hugely important role in this course, but they will crop up now and again and it's worthwhile understanding what they are and seeing one or two examples of Martingales. We're going to have the following definition of a Martingale, a random process, Xn is a martingale, with respect to the information filtration Fn and probability distribution P, if these two conditions are satisfied. The first condition is just a technical integrability condition which states that the expected value of the absolute value of Xn must be finite for all n. The really important condition, is condition two here, which states that the expected value of Xn plus m, given Fn, is equal to Xn for all nm greater than or equal to 0. A quick comment on what I mean by information filtration. So the information filtration, Fn, is just a complicated way of recognizing the information we have at time n. So Fn will denote all of the information in our model that we know at time n. So usually, you will actually, it'd be the case that Fn is equal to the information given to you by X1 up to Xn. So basically, it's just recognizing that at time n, we've already seen the values X1 up to Xn. Returning to condition two here, we see that what this is really saying, is that the expected value of X, at any time in the future, is equal to its current value today. And so, Martingales have often been used to, to model what are called fair games, they've got a rich history in gambling, for example. Because this condition here, models the idea of a fair game, so your future pay-off, or your expected future pay-off, is equal to your current wealth today, Xm. We define a sub martingale, by replacing condition two with a greater than or equal to sign, And we define a super martingale by replacing condition two with a less than or equal to sign. A martingale then is both a sub martingale and a super martingale. Here's our first example of a martingale. We can construct one from a random walk. Let Sn be equal to the sum of the Xi's from i equals 1 to N, where the Xi's are IID with mean mu, then we can set Mn equal to Sn minus n times mu, and in that case, Mn is a martingale. We can see this because of the following, the expected value of Mn plus n, conditional time n information, is equal to, what we have over here on the right-hand side. So recall, Mn plus n will be equal to Sn plus m, minus n, plus m times mu. So this here is Sn, and here's our m plus m times is mu. Well were taking this expectation conditional on time n information, so in that case, what we can do is, we can take out the first nxi's, because they're known to us as a time end, so we can take them outside the expectation. And what we're left is the expectation of time n, of the sum of the xi's from i equals n plus 1 up to n plus m. Well, the xi's are IID, so knowing the value of the first nxi's tells us nothing about these. We also know that they've got mean mu, so therefore the expected value of this sum here, is equal to m times mu. We also have the n plus m mu over here. Now when we simplify all of this, this m-mu will cancel with this m-mu, we're left with the sum of the xi's and i equals 1 minus n times mu, and of course, we see that this is equal to Mn. So in fact, we have shown that the expected value of m, subscript m plus n, conditional on time n information is equal to Mn, and so it's a Martingale. In this example, we're going to consider what we will call a Martingale betting strategy. Let x1 x2 and so on be IID random variables, where xi can take on two possible values, it can take on 1 or minus 1, in each case it takes on that value with probability 1/2. So you can imagine xi representing the result of a coin-flipping game, you win $1 if coin comes up heads, and you lose $1 if coin comes up tails, that assumes that you bet, $1 on the game. What we're going to do now is to consider a doubling strategy, where we keep doubling the bet until we eventually win, once we win, we stop and our initial bet is $1. So the first thing to note, is that the size of the bet on the nth play is 2 to the n minus 1, and that's because of the following, so on the first play, we bet $1 which is equal to 2 to the 0. On the second play we bet $2, because we're doubling our bet, and this is equal to 2 to the power of 1. On the third play of the game we would double our bet again, so we would bet 4, and that's equal to 2 squared, and so on. So we can see that every time you played the game, we've doubled our bet and so the play, the size of the bet on the nth play is 2 to the n minus 1. That of course assumes we're still playing at time n, because we will only be playing at time n if we haven't yet won the game up until this point. Let Wn denote the total winnings after m coin tosses, And assume we start off with W0 equals 0. What we're going to show, then, is that Wn is a Martingale. To see this, first note that Wn can only take on two possible values, it can only take on the value 1, or it will take on the value minus 2 to the n plus 1, and that is true for all n. Why is this the case? Well, consider the following two situations. The first situation is as follows, suppose we win for the first time on the nth bet. Well in that case, Wn is equal to minus this sum here. Where does this sum come from? Well, we've lost $1 on the first bet, $2 on the second bet, and so on, up to 2 to the n minus $2, on the n minus first bet. Then on the nth bet we win and we win 2 to the power of n minus 1. Remember 2 to the power of n minus 1 is the size of the bet on the nth game, so therefor these are our winnings at time n, if we win for the first time on the nth bet. If you actually compute this sum, just using the, the formula for summing a geometric series, remember it's a to the 1 minus r to the power of n, all over 1 minus r, that's the general formula. In this case, this translates to 1 times 1 minus 2 to the power of n minus 1 divided by 1 minus 2, and that is equal to 2 to the power of n minus 1 minus 1, which is what we have here. So W n, if we win for the first time on the nth bet, is equal to minus 2 to the n minus 1 minus 1, plus 2 to the n minus 1, this term cancels with this term and we're left With 1. Thereafter of course, we're always left with 1 because we stop playing the game as soon as we win. So the other situation that can arise, is that we have not yet won after n bets, in that case, the winnings, Wn is equal to minus 1 plus 2 and so on up to 2 to the n minus 1. It's 2 to the n minus 1 because we also lost the nth bet, so in fact this is a minus, this becomes a minus down here, and we get this quantity here, we sum it up and we get a sum of minus 2 to the n plus 1. So therefore these are the two possible values of Wn, 1 and minus 2 to the power of n plus 1. To show Wn as a martingale, we only need to show the following, that the expected value of Wn plus 1, given Wn, is equal to Wn. And this follows by an iterated expectations argument. And the reason is as follows, suppose we want to calculate the expected value of Wn plus 2 given Wn. Well in that case, we can write this as the following, the expected value of the expected value of Wn plus 2, given Wn plus 1, all given Wn. Now this term inside here, is equal to Wn plus 1 by this result here. So by star, with n equals m plus 1, so by evaluating star but not taking n equals m plus 1 we get that this inner expectation here equals Wn plus 1. So therefore, this is equal to the expected value of Wn plus 1, given wn and of course, this is equal to Wn again by star. So in fact, for any value of little n, we can show that this result holds, just using this iterated expectations argument we did here. So all we need to do to show that Wn is martingale, is to establish star, and that's what we'll do now. There are two cases to consider. The first case is where Wn equals 1. Recall, we have shown that Wn can only take on two values, the first value is 1. So if Wn equals 1, then actually we stop playing the game, because it means we've already won at some point, we've stopped playing the game and therefore, Wn is always equal to 1 in every period after we have first won. So in this case, the probability that Wn plus 1 equals 1, given Wn equals 1, is indeed equal to 1. Which means, the expected value of Wn plus 1, given Wn equals 1 well it must be equal to 1 because that's the only value it can take. It takes on this value 1 with probability 1, so the, this expected value equals 1, which is equal to Wn. The other situation that can occur, is that Wn equals minus 2 to the power of n plus 1. If that's the case, then we will bet 2 to the power of n, on the n plus first toss. So in that case, Wn plus 1 will be either 1, if we win the n plus first toss, or it will be minus 2 to the power of n plus 1 plus 1, and this follows from our arguments on the previous slides. Wn plus 1 will take on this value with probability a half and it'll take on this value with probability half, and that follows because it's a fair coin, we win with probability a half and we lose with probability half. So therefore, we have these two expressions here, from which it immediately follows that the expected value of Wn plus 1, given Wn equals minus 2 to the power of n plus 1, it is equal to 1, with prob-, with probability a half and is equal to minus 2 to the n plus 1, plus 1 of probability a half. If we sum these two together, we get minus 2 to the n plus 1, and that of course is equal to Wn. So in both possible cases, case 1 and case 2, we have shown that the expected value of Wn plus 1, given Wn, is equal to Wn. And so we have shown that Wn is a Matingale. Now let me mention this example is quite complicated, but it was worthwhile introducing because it is easy to generalize this example to the case where you allow random bets on each play of the game, as long as those bets only depend on what you've seen up to that point, you will actually still get a Martingale. For a final example, we look at something called Polya's Urn, we won't go through all the details, in fact, you can complete the details yourself. Considering urn, which contains red balls and green balls, so we've got some urns like this, there are red balls in there and there are green balls inside this urn. And at each time step a ball is chosen randomly from the urn, if the ball is red, then it's returned to the urn with an additional red ball. If the ball is green, then it is returned to the urn with an additional green ball. So what we're going to do is we're going to see that there are n plus 2 balls in the urn, at time n. And this follows, because we begin with two balls, and after every play of the game we add an additional ball, either an additional red ball, or an additional green ball. So we have n plus 2 balls in the urn, after time n. Let Xn denote the number of red balls in the urn after n draws. Then, if Xn is equal to k, Xn plus 1 can only take on two possible values, it will take on the value k plus 1, or the value k. It will take on the value k plus 1, if the ball withdraw on the nth plus 1 play is a red ball and that will occur with probability k over n plus 2, k because there are k balls-, k red balls in the urn and n plus 2 because n plus 2 is the total number of balls in the urn. Likewise Xn plus 1 would be equal to k given Xn equals k, if we draw a green ball, because if we draw a green ball we will not be adding an additional red ball. So Xn plus 1 equals k, given Xn equals k that occurs with probability n plus 2 minus k divided by n plus 2. And now, what we claim and what you can easily check, is that Mn, which is equal to Xn divided by n plus 2, is a Martingale.

## 027.III

### 049. Introduction to Brownian Motion

>> We're now going to introduce Brownian Motion. Brownian Motion is a very commonly used stercastic process in finance. It is the process that underlies the Black-Scholes methodology and we're going to discuss it now. So, let's define our Brownian Motion first. We say that a random process or stercastic process xt where t greater than or equal to 0 is a Brownian motion with parameters mu and sigma if, for the following fixed times: t1 less than t2 up to tn. The following increments: xt2 minus xt1, xt3 minus xt2, up to xtn minus xtn minus 1, if they are mutually independent. For s greater than 0, xt plus s minus xt, must have a normal distribution with mean mu-s, and variance sigma squared s. So notice mu and sigma are the parameters of the Brownian motion, and the increment, so this is an increment of length s, it's xt plus s minus xt, that increment must have mean, mu-s variance sigma squared s and be normally distributed. And the third condition that must be satisfied is that xt is a continuous function of t. In other word, if I was to plot and we'll see this in a moment, Brownian Motion, okay through time, in fact it's actually a lot more jagged than I've shown you here, but it actually never jump. So I can draw a path of Brownian Motion with my pen never leaving the page. And that's what I mean when I say xt is a continuous function of t. We say that xt is a b-mu sigma Brownian motion. Mu is the drift, okay and sigma is the volatility. Property number one, is often called the Independent Increments Property. So they're among the first people to introduce Brownian Motion from a mathematical viewpoint as we've defined here. Were Bachelier in 1900 and Einstein in 1905, it's interesting that Bachelier, very little is known about him, he was a French mathematician and in fact, it turns out he, he has had a great role to play in, in, in finance. He was trying to model stock prices on the Paris stock exchange way back in 1900 and he tried to introduce the idea of a Brownian motion to do that. So it's very interesting to see, that a concept as important as Brownian motion, which is used throughout the physical sciences and engineering was actually introduced by Bachelier in a financial context. Wiener, in the 1920s, was the first to show that it actually exists as a well defined mathematical entity. So Brownian motion, it's a hugely important stochastic process, and it plays a very big role in, in finance as well. Some other pieces of information when mu equals 0 and sigma equals 1, we have what's called a standard Brownian motion. We will use wt to denote a standard Brownian motion, and, we also assume that it begins at 0. So w0 is equal to 0. Note that if Xt is a b-mu sigma Brownian motion and X0 equals little x then we can write Xt equals little x plus mu-t plus sigma Wt, where Wt is our standard Brownian motion. We therefore see that Xt, is normally distributed with mean x plus mu-t and variance sigma squared plus t. Because of course, if Xt equals this, then the expected value of Xt is equal to the constants X plus mu-t plus sigma times the expected value of Wt. Wt is a standard Brownian motion, so has mean mu equals 0 times t, so this is equal to, X plus mu-t and the variance of Xt. Well the constants don't matter, they don't factor into the variance, so the variance of Xt is equal to sigma squared times the variance of Wt. And the variance of a standard Brownian motion has sigma equals 1, So it's equal to sigma squared times t, and that's where we get this calculation from here. So here's a sample path for Brownian motion. I've been simulating this Brownian motion by simulating these increments, which are normally distributed between t equals 0, and t equals 2 years. So this axis represents, a time period of 2 years and I've been simulating a Brownian motion. I've-, assuming it's-, I've been assuming it starts at a hundred, so I'm thinking maybe of a security price, although you wouldn't model a security price as a Brownian motion typically, but for the purposes of this demonstration you can think of doing so. So, that's one sample path, here's another one. We can see there's lots of different behavior, very jagged, In fact if I was to zoom in here, you would see that jaggedness still up here. Key thing to note is that these paths they're continuous, even though they're very jagged none of them jump, okay so again, I could draw one of these paths, and make sure that my pen never leaves the page. It doesn't suddenly jump from here down to here, okay? So Brownian motion is continuous, the paths of it are continuous. On this slide, I want to introduce an important fact about Brownian motion, but before I do so, let us review by what we mean by an information filtration. For any random process, we will us Ft to denote the information available at time t. And then Ft for all values of t greater than or equal to 0 is called the information filtration. And we actually discussed this in a previous module when we spoke and introduced, when we spoke about and introduced Martingales. This quantity here, this expectation, conditional on Ft, then denotes an expectation conditional on the time t information that's available to us. And usually, it would be very clear what that information is. So really, this, this information filtration ss just a mathematical way of describing what is intuitively obvious to us anyway. The important fact I want to introduce is the following. The independent increments property of Brownian motion implies that any function of Wt plus s, minus Wt is independent of Ft. In other words, knowing all of the information available at time level t, that tells us nothing about the increment Wt plus s minus Wt. So that in the predictor means that Wt plus s minus Wt is normal with mean 0 and variant, variance s, and that's in-, and that's even conditional on time Ft information. So let's do a calculation with Brownian Motion. We probably won't use this calculation during the course, but there's no problem in doing such a calculation, and it helps improve our intuition of what's going on with the Brownian Motion. So let's compute the expected value at time 0, conditional times 0, information of Wt plus s times Ws. Well we can use a version of the conditional expectation identity to obtain the following. So Wt plus s, I can rewrite this as Wt plus s minus Ws plus Ws. Okay, and then i'm multiplying by Ws outside, so that's this second Ws out here. I can multiply through this Ws through the-, this term here and break it down into two terms. I get Ws times this term, so that's what comes into the first term here, and then I get Ws times Ws is Ws squared, and that goes to that term, so this goes here. So now I've got two terms. Well the first thing is, let's deal with this guy first. I claim that the expected value of Ws squared is equal to s, how do I know that? Well I know that because of the following. I know, that s is equal to the variance of Ws, but the variance of Ws is of course equal to the expected value of Ws squared minus the expected value of Ws all to b squared. But the expected value of, Ws is equal to 0, because it's a standard Brownian Motion, so therefore the variance at w s is just the expected value of Ws squared, and that's equal to s as we've seen over here.So that handles this second term on the right hand side of 9. How about the first term? Well a version of the conditional expectation identity implies the following. So I want to compute the expected value of Wt plus s minus Ws times Ws, so what I'm going to do is first condition on time s information. So I can actually rewrite this expectation by conditioning first of all in time s information, I get dou-, Wt plus s minus Ws times Ws, conditional on time s information this Ws term can actually come outside this inner expectation, which is where it is over here. And I'm left with, inside the inner expectation with Wt plus s minus Ws. But that important fact over here. So let's call this star. That important fact tells me, that this guy is normal with mean 0 and variance, in this case t. So therefore, the expect-, and it's independent of Fs. So therefore, this quantity here, this inner expectation, has expected value 0, and that's where the 0 comes from, and so I get 0 here. And so, therefore what we've shown, is that the expected value of Wt plus s, times Ws, is equal to s.

### 050. Geometric Brownian Motion

>> In this module we're going to discuss Geometric Brownian Motion. Geometric Brownian motion is a very important Stochastic process, a random process that's used everywhere in finance. We have the following definition, we say that a random process, Xt, is a Geometric Brownian Motion if for all t, Xt is equal to e to the mu minus sigma squared over 2 times t plus sigma Wt, where Wt is the standard Brownian motion. So we've discussed Brownian Motion, in a separate module, so you can look at that module, if you'd like, to remind yourself what a Brownian Motion is. But one thing to keep in mind with the Brownian Motion, is that Wt, has got a normal distribution, with mean 0, and variance t, This is one of the properties of a Brownian Motion. Recall mu the drift, sigma the volatility, and write Xt till GBM mu sigma. An interesting observation to make is the following, let's take a look at this expression, but let's replace t with t plus s, if we do that, we'll see that Xt plus s equals X0, and in fact I should have had an X0 here. So Xt plus s equals X0, e to the mu, minus sigma squared over 2 times t plus s, plus sigma plus Wt plus s. And now what we can do, is we can rewrite this expression up here in the exponential. We can subtract a minus Wt, and add a Wt here, and we can break this summation up into t times this plus s times this. If we do that, we get this term here in the right hand side, but what's interesting is that this quantity here, is actually equal to Xt. So we can write Xt plus s equals Xt times the exponential of mu minus sigma squared over 2 times s plus sigma times Wt plus s, and this representation is very useful, it's in fact very useful for simulating security prices, when those security prices follow a Geometric Brownian Motion. This quantity here, Wt plus s minus Wt, well that's just a normal random variable with mean 0, and variance s. Moreover, it is actually independent of Xt and this follows from the independent increment property of Brownian motion that we discussed in that other module on Brownian motion. So that means for example, suppose that we wanted to generate values of a Geometric Brownian Motion at time 0 and at time t, bit also may be at these intermediate times may be delta, 2 delta, 3 delta, and so on. Well, what we can do, so we want to generate x delta, x2 delta, x3 delta, and so on. Well, what we can do is we can actually simulate the Geometric Brownian Motion at these time periods by just simulating, and zero delta random variables, that's very easy to do in standard software, you can even do it easily in Excel. So you could generate a sample path of your Geometric Brownian Motion or a sample path of your stock. You start at time zero with x zero which you know, and then you get x delta, using this formula here, with t equal to 0 and Wt plus s minus Wt, well that's just equal to a normal mean 0 variance delta random variable, so that would give you x delta. You could then get x2 delta by taking t equal to delta and s equal to delta, so you will get x delta plus delta is x2 delta, that's equal to x delta times this quantity again here. And again, to generate this term you could just generate a standard normal random variable, with mean zero and variance delta. So it's actually very useful simulating a Geometric Brownian Motion and we may return to this again, later in the course. Here's a question, suppose Xt is a Geometric Brownian Motion with parameters mu and sigma, what is the expected value of Xt plus s given little t? Well from equation 10 of the previous slide, we know that Xt plus s is equal to Xt times the exponential of this term here. Well, at time t, all of this is known to us, so we can take this outside the expectation, and we're left with this times the expected value of each of the sigma Wt plus s minus Wt. Well this term here, as I've already said, is normal with mean 0 and variance s, so all you're trying to do when you compute this expectation, is actually compute the moment generating function of a normal rounding variable. How many have seen that before? Suppose Zed is normal with mean a and variance b squared. Then it implies that the expected value of e to the s times Zed is equal to e to the a s plus a half, b squared times s squared, so this the moment generating function of a normal rounding variable. And we can just use the standard result up here, to recognize that this must be equal to e to the sigma squared over 2 times s. This term, cancels with this term, and we get this expectation equals e to the mu s times Xt, so that the expected growth rate of Xt, is in fact, mu. Here are some sample paths of Geometric Brownian Motion. The important thing to notice with these paths, is that they are continuous, they are very jagged. If I was to zoom in, I would still see that they are very jagged and they are continuous as I said, so they do not jump. I can draw any one of these paths, by keeping my pen on the page. The following properties of Geometric Brownian Motion, follow immediately from the definition of Brownian Motion. Recall that we saw the following, so we know that Xt plus s, is equal to Xt, e to the mu minus sigma squared, over 2 times s, plus sigma times Wt plus s minus Wt. Okay so what are these three properties? Well the first property states, that these ratios xt2 over xt1, xt3 over xt2 and so on, they're mutually independent. And that follows, because if I divide across here by Xt, I can see I've got the only random variable here is this increment, and the independent property, independent increments property of Brownian Motion will actually imply this first property here. The second property is, the property I mentioned on the previous slide that is that the paths of Xt our continuous as a function of t, they do not jump. The third property states, that the log of Xt plus s over Xt has got a normal distribution as follows, and that also follows from equation 10, which I've rewritten here. So I can easily see that the log of Xt plus s divided by Xt is equal to, well it's just this term up here in the exponent, it's equal to mu, minus sigma squared over 2 times s, plus sigma times Wt plus s, minus Wt. This guy is normal with mean 0 and variance s, and so this quantity is normal with mean mu minus sigma squared over 2s, and variance sigma squared s, which is exactly what we have here. A couple of observations about Geometric Brownian Motion. It is clear #1, that if Xt is greater than 0, than Xt plus s is always positive for any value of s greater than 0. And again, let's write out equation 10 here just to see this more clearly. It's, so this is our equation 10 from an earlier slide. We can see that if Xt is greater than 0, then of course the exponential of this would be greater than 0, and so then Xt plus s would be greater than 0. So if we are using a Geometric Brownian Motion to model stock prices, then we can see that the limited liability of a stock price, i.e., the fact that the stock price cannot go negative, is not violated. Another observation, is that the distribution of Xt plus s divided by Xt, only depends on s and not on Xt. In fact, this was clear, from the previous slide where we had this result here. The log of Xt plus s is a normal distribution, and this normal distribution does not depend on Xt, it only depends on s and the parameters mu and sigma. And this is nice, because we wouldn't expect returns to depend on Xt, so we can view this as being the return on a stock the return between times t and t plus s and we don't expect in general that this return should depend n the current value of the stock. So again, this is another nice property that Geometric Brownian Motion has, that is generally reflected in stock prices as well. So these two properties suggest that Geometric Brownian Motion might be a reasonable model for stock prices. And indeed, Geometric Brownian Motion is the underlying model for the famous Black-Scholes option formula that we will also see in this course.

### 051. Review of Vectors

>> In this module we'll review vectors. I will go over definitions of vectors, what are row vectors, column vectors. We're going to define linear independence, bases, transposes, inner products, lengths of vectors or norms. All of these concepts are going to be needed for doing some of the elementary linear algebra that's needed in this course. What's a vector? It's just a collection of real numbers. You can collect them, and put them in a row or you can put them in a column. So here is an example of a row vector. Where I've put everything as a row here's an example of a column vector and if you notice carefully both of these vectors have n components. So we will call a vector to have n components if it consists of n real numbers. A row vector or column vector and we will denote any of these vectors by the symbol r to the n. R to the n means that every component is a real number and they, there are n of them in the place. To just fix ideas it might be easier to think in terms of R2 which means these are vectors with just two components and it's easiest to think of these vectors as belonging to a plane. And we're used to calling this plane by the x axis and the y axis. So think of x axis being one of the components of the vector. Y axis being another component of the vector. So, let me just give you some examples of vectors that we going to use later on in this module. So, here's one vector. It's x component or the first component is going to be one and the second component is say going to be equal to two. So that the vector will be this vector. At the end of the dot the dot corresponds to a y axis of two and x axis of one. So was labeled this as V. This will simply be the vector one two. The first component equal to one in the second component equal to two. Here's another example. The x axis, or the first component equal to 4 and y axis equal to 1. So that's that point, and I'm going to be connecting it with this vector. And in the rest of this module, I'm going to referring to this vector as w. It has 4 in the first component, and 1 in the second component. By default in this course unless otherwise specified we will assume that all vectors are column vectors, that is all the components have been arranged as a column. So we now know what a vector is, they are collections of real numbers without, by default it's going to be a column vector. Now we want to understand what can we represent using these vectors, what happens with them and so on So the first thing that we want to do is multiply these vectors with real numbers and add them up. So v1 and v2 are vectors. And I want to multiply them by a real number, alpha 1. And a real number, alpha 2. And then get a final vector w. So, to give you an example, here is my vector, v1. One, here is my vector V two. And just to fix ideas, each of these V one and V two actually lives in R to the three. Why R to the three? Every component is a real number, and there are three components. So the three refers to the fact that there are three components. I'm going to multiply them by two real numbers, so two is going to play the role of alpha one. 4 is going to play the role of alpha 2. And what do I do? I take these real numbers, multiply them component by component and add them up. So, in order to get the first component, I take the 2, multiply it to the 1, take the 4, multiply it to the 0. I get 2 times 1 plus 4 times 0 equals 2. That gives me the first component. If I want to go to the second component then I take the 2 and multiply it to the second component 1. Take the 4 multiply it to the second component which is also 1, 2 times 1 is 2, 4 times 1 is 4 add it up together you get 6. Want to go to the third component the same thing, 2 times 0. 4 times z, 1, 2 times 0 is 0. 4 times 1 i 4. You get a total component 4. So when you write a vector w as a combination of vectors v1 and v2, we're going to say that this Vector w is linearly dependent on v1 and v2. Why the linear? Because I'm multiplying by a real number, and adding them up. Other words are, w's a linear combination of v1 and v2. Get another word. W belongs to the linear span of v1 and v2. All of these 3 things mean the same. Linear dependency, linear combination, linear span. Now, we'll, in the next set of ideas, we'll need a concept of linear independence. When can we say that we cannot write a vector as a linear combination of other vectors. To fix ideas, let's again go back to r2, and I'm going to use my favorite two vectors, v and w. So here's my vector v and here's my vector w. For now we don't really need what the components are so I'm not going to bother with that. Now we want to understand what does a linear span mean, what can I, what kind of vectors can I generate by scaling the w? What can I do by multiplying w by areal number? And you can convince yourself very easily That all the vector that you can get, are going to be on that straight line. When you scale it up you get, by a positive number you get up the line if you multiply by a negative number you go down the line. Similarly all the vector that can be gotten as linear combinations of v rely on this straight line. Now we want to ask ourself can I represent v as A multiple of w. Clearly that's not true because I can't, I can't, when I scale the w I get points on this line, v doesn't belong to that line so I can't do anything about that. Similarly, w is not written as a linear combination of v and therefore we'll say that v and w are linearly independent. Let's throw in another vector now, x. It's again a vector in r 2 and I want to ask myself, is this linearly independent of v and w? Is it possible that x can not be written as a linear combination of v and w? Again it's very easy to convince yourself that if you just draw a line parallel to v, you can write, your vector x as a combination of vector that starts from the origin, it's aligned to the vector w and comes up to this point. So therefore, this vector is some alpha 1 times w. This vector here is, is parallel to the vector v. So I can write it at sum scale multiple alpha 2 times v. And because, now, x is the sum of this vector and that vector, you end up getting that x is actually equal to alpha 1 times w, plus alpha 2 times v which means that x is linearly dependent, LD just for short, linearly dependent on v and w. In fact we'll see in the next slide that in R2 if I give you any 2 linearly independent vectors you can write any other vector as a linear combination of these 2. And that set of vectors, say these two, v and w, would actually be called a basis. So that's the next concept that I want to learn about vectors. A basis is a linearly independent set of vectors that spans the entire space. Any basis for Rn, meaning a vector which has n components, has exactly n elements. So basis for Rn has exactly n elements. In the last page I showed you an example of R2, and this should have just two elements. V and W are linearly independent, there were two of them, and therefore I know, that this must be a basis. Now it will turn out that its much easier to think in terms of a standard basis. What's a standard basis is shown here. Its a collection of vectors such that they have only one in one of the components and all of the other components are equal to zero. So the vector E1 will have 1 in the first component, the vector E2 is going to have a 1 in the second component, and the vector En is going to have a 1 in the last, or the nth, component. Now if you give me any vector W which belongs to Rn meaning that it has n components, I can very easily write it as a linear combination of E1 through En. Why, because in each of these vectors is exactly one element that's not zero. So if I want to get the first element of w, right? I have to, say, take it to be w1 times e1, because everything else has zero contribution. If I want the second component, right, I have to take w2 times e2, nnd so on up to wn times en. And therefore, this basis. I can split any vector w as a linear combination very easily. And we will see that, in practice, these terms ought to be very convenient. Again, to put it in perspective. Here's r2. Here is my x asix. Here is my y axis. And when I showed you in the first slide, x axis refers to the first component. And y axis refers to the second component. So the vector e1 is just this one. It has one component one in the x direction and zero in the y direction. E2 is this one, it has a component one in the y direction and zero in every other direction and it's very easy if I take a vector x, all I have to do is drop it down here and This, this length down here on the x-axis is x1, on the y-axis is x2. And it's a very easy way to combine. But any other set of linearly independent vectors, two of them will make sure that this is going to be a basis. So, again, this was v, and this was w from the last page. And v and w is also a basis. This is also a basis. And E1, E2, which is are these 2 special ones, are also a basis. The second basis is special. And we'll just call it the standard basis, because it turns out it's very convienent to work in terms of this basis. Alright. So, so far what do we know? We know what are vectors. We know linear dependence, we know linear independence. We know that if I am a vector in Rn, meaning it has n components, I can find a basis of n linearly independent vectors, such that every vector can be written as a combination of these. So what's the next concept? The next concept that we want to learn, is that of a length of a vector. Vector. So let's start with the basics. And then we'll generalize is to what I want here. So, if I give you r2. And let's take a vector which has the x component equal to, let's say, 4. And the y component equal to, let's say. So this vector, has a representation four, three. Then our high school trigonometry tells us that the length of this vector is nothing but 4 squared plus 3 squared. So I'm taking the x-axis and squaring it. I'm taking the y-axis and squaring it. Square root. So that gives me 16. Plus 9 square root which gives me 25 square root equaled to 5. So that's nice. I have a, I have a definition of length. What does this definition of length satisfy? It satisfies several properties. It satisfies that the length of any vector is always great than equal to 0. If the length of a vector is equal to zero, then that vector itself must be zero. So you cannot have a vector which is not equal to zero who's length is equal to zero. And the intuition follows from this triangular expression as well. If I scale a vector by an amount alpha it doesn't matter whether I scale it positively or negatively. The length just gets scaled by the absolute value. So, here's the idea here's the value of vector v if I double it. >> I get this vector if I multiply it by minus 2 I get that vector, the length of this vector and the length of that vector is the same. The direction has changed, but the length remains the same. That's what this absolute value does. The third one here. Tells you the relationship between lengths of additional vectors and the original lengths, and this is known as a triangle inequality. The way you remember this geometrically is that if you've got one vector here, you've got another vector there, the sum of the vectors is this one, the length, this length is always going to be, let's call it l. Three is always going to be lessthan equal to L1 plus L2. This is the basic geometic fact L3 has to be less than equal to L1 plus L2. And this particular fact is encapsulated in this little >> Statement over here, and that's why it's also called the tirangle inequality. Now mathematicians have looked at this concept of length, this particular concept of length that I've been talking about which is take each of the components, square it, add it up, take the square root and now they're calling it the I2 norm. The 2 stands for the fact that I'm squaring it and take the square root and you'll notice that the properties that I want. The fact that the length is greater or equal to zero. The fact that triangle inequality holds. The fact that if I scale things remain the same is true for other definitions of length. Now, since I am taping this in New York, I'm going to try to tell you about a particular notion of language, which is called the L1 norm, otherwise known as the Manhattan distance. I'm sitting at a particular point here, I want to travel to another point, I can only go In blocks north and south or east and west, and I want to figure out how much do I need to walk in order to get from this point to that point. So I have to walk from this point to this point and then walk from that point to that point. So this distance is 4, that distance is 3, so the L1 distance, or the L1 length, or the Manhattan distance is 4 plus 37. The L two distance is five because I can sort of cut across. The L one distance is seven. L one also satisfies all the properties of a norm or a length and therefor it's sometimes convenient to encapsulate all of them as just norms and lengths. For the purposes of this course we will mostly be focusing on L two. But I just wanted you to know, that there are other definitions of length, that are interesting, and sometimes become important in applications. Alright, now we know vectors, we know linear combination, we know lengths. Now we want to go to the next concept, which is that of an angle. And in order to get to an angle, I have to introduce this idea of an inner product or a dot product. So the dot product of any two vectors v and w, so v and w are vectors in Rn. They have n components. So the dot product between v and w is simply going to be taking the ith component of v, taking the ith component of w, multiplying them together, and adding them up. For those of you who are experts in Excel, this is nothing but sum product, take the product of the components and add them up. The sum product function in excel is nothing but an inner product or dot product. If you review back, into the last slide we had defined the L 2 norm there to be every component's squared square root and that can now be written that length L 2 norm of the vector is simply take the vector v, take its dot product. So v, dot product with v, and take the square root. So now we want to understand an angle between these two vectors, so to do that, here's a picture. Here's my w, here's my v, here's an angle theta between them. So in order to understand how the inner product relates to the angle, the length of this vector is The length we, the length of this vector is w. So that inner product of v and w, simply is, take a, take the component of v along w and multiply to the length of w. So if you drop down an orthogonal point over here, this component. Is exactly equal to the norm, or the length, of v cosine of theta, and that I'm going to multiply with the length of w, and that should give me v dot w, which ends up giving me the cosine of theta Is exactly equal to vw divided by the norm of v, and the norm of w, or the length of v, and the length of w. And, to emphasize the fact that these are all 2 norms. I'm just going to put a 2 there. All of that is encapsulated in this slide. Cosine of theta is v.w divided by v and w. And this is true, not just in our 2, but in our n. You an define angles in rn. I'm going to show you in the next module that v dot w is actually a combination of two operations, the transpose operation and the matrix multiplication operation. But that has to wait until we get to the module of matrixes. So that pretty much brings us to the end of the introduction to vectors. This is all we need to do in terms of vectors, and this is all we're going to be using in the course. In the next prerequisite module, the next, the module that comes up next, we're going to review concepts about matrixing

## 028.IV

### 052. Review of Matrices

>> In this module, we're going to review matrices. We'll define matrices, we're going to define operations such as transposes, inverses. We're going to talk about linear functions, and how they are related to matrices. We're going to define concepts such as rank, which will play a role later on in the course in defining complete markets, and hedging instruments. To start at the very basic, what is a matrix? A matrix is simply a rectangular array of real numbers, and we represent the matrix by the number of rows, and the number of columns. So I'll walk you through some examples. So this matrix a, has 2 rows, row 1, row 2. It has 3 columns, 1, 2, and 3, and therefore, we're going to call it a 2 by 3 matrix. 2 rows, 3 columns, 2 by 3 matrix. Its elements, I'm going to index by the row index and the column index. So if you have, if I'm talking about an in, an element called a 1 2. So the first index is going to be the row index. The second index is going to be the column index. So, it's going to be row 1 column 2. So that's the number that I am talking about. So, a 1 2 is equal to 3. Similarly, if I talked about another element a 2 3, so remember the first index refer to the row, so we're talking about the second row. The second index is going refer to the column. The third column, so that's this element down here, so a 2 3, is equal to 5. So every matrix is a rectangular array, we say a matrix is an m by n matrix, if it has m rows and n columns, so that's down here. So this is the general a that I'm talking about. This particular matrix has m rows. So if you look at a partic, elements over here, it goes from a 1, 1. And remember, the row index always comes first. So it's a, 1, 1, a, 2, 1, and so on, these dot, dot, dot means, and so on. A m 1, it has n columns so the column index comes second. It's a 1, 1, a 1 2, a 1 3, and so on, and a 1 n, and the last one is a m n. Here's another example; b, it has 1 row and 3 columns, that's a row vector. In the col, in the module and vectors, we noticed that there were two kinds of vectors, so column vectors and row vectors. Row vectors have row equal to 1, and a many number of columns. Column vectors have column equal to 1, and several rows. So here's an example of a column vector; w equals, 3, 4, 1. 3 rows, 1 column, so either, I can think of it either as a vector in r 3, or as a matrix in r 3 times 1. The second 1 says it's got 1 column and 3 rows. So the first thing that I want to do, is introduce an operation called transpose. Transpose really takes rows to columns and columns to rows. So, the easiest way to start thinking about it is to think in terms of column vectors and row vectors. I've got a column vector here, v. It's got 1 column and 3 rows, 1, 2, 3 rows. If I take it's transpose, if I put the operation transpose on this vector v, I'll go from column to row. So v transpose is simply this row vector. Now, we want to do the same thing, to matrices. I want to pretend that the matrix is nothing but a collection of columns. I'll take every column and flip it and make it into a row, and that's what transpose does. I have a column 2, 1 over here, I'm going to flip it, and make it a row, 2 1. Same thing that I did with the vector. I have 2 6 4, 2 6 4, 2 1, 2 1. I take the second column, and I flip it, I get the second row. I take the third column and I flip it, I get the third row. So columns go to rows and vice versa, rows go to columns. It's, it's symmetric in that sense. More generally, here's a matrix a which is r m times d. To remind, to remind you once more, m is the row index, d is the column index. So it has m rows and d columns. If I put the transpose operator, that's what this is doing, I'm going to take this column and transform it into a row, and that's what I'm going to do to everyone of them. So now, after the transposition is done, you end up getting that the number of columns becomes the number of rows, and number of rows becomes the number of columns. And so a matrix which is in r n times d, ends up being a matrix in r d times m. In the module on vectors, we had learned, that the inner product between 2 vectors, involves a transpose and a multiplication, so we figured out the transpose part. It's going to take a column vector into a row vector. Now we're going to try to see what happens, how do I multiply matrices? So the next concept is that of a matrix. So I've a matrix which is rm times d. So it's the, the row index is m, the column index, I'm going to put them in red just to make, emphasize the fact. The column index here is d, the row index for the matrix b that I'm going to multiply to it, must be the same as the column index of a. The inner multiplication dimension should be the same, otherwise it cannot multiply these matrices. And the column index of b could be anything, say p in this particular case. So when you multiply these matrices, you get a new matrix. So the inner index that was there this d index, it disappears, and the new matrix c that you end up getting, is going to be in m times p. So the m in the row index, becomes the row index here, and p which is the column index, becomes a column index there. So you end up getting a matrix which is in r m times p. The inner dimensions have to be the same in order the multiplication to happen. And when the multiplication happen, that disappears. There's a general formula for how to get the elements of c, but before going there, let me give you some examples, so that this idea becomes clearer. So I've got 2 matrices down here. I've got this matrix, which is in r, 2 times 3, 2 rows, 3 columns. This is a vector, but I'm going to treat it as a matrix, which is an r 3 times 1, 3 rows and 1 column. Now, if I apply the general rule that I just talked about, I should end up getting a matrix, which should be r 2 times 1, because I end up getting that the inner dimension which is the same for the multi, for the vec, matrix a and the matrix b. That will disappear and the outer dimensions are what are going to define the product. So this is the matrix c that I'm going to get, that's in r, 2 times 1, as I expected. So, how do I get the elements of this matrix c? What I do, is I take the rows, and multiply them to the corresponding columns. So in order to get c 1, 1, so I have, this is the row index, this is the column index. In order to get this element c 1, 1, I'm going to take the first row of a, and multiply it to the first column of b. I've got the first row, I've got the first column, and what does it mean to multiply a row and a column? I multiply them component by component add them up, sum product. So I take the 2, multiply to that 2. I take the 3, multiply to 6, take the 7, multiply to 4. And that's what I have written up here. 2 times 2, plus 3 times 6, plus 7 times 4. In order to make it clear what I'm trying to do here, the elements in the brackets correspond to the column, the elements outside the bracket corresponds to the row, and the first component ends up being 50. So let's look at c 2 1. Second row, first column, same story. So I've got the second row here, and that's going to multiply the same column, and I'll get elements 1 times 2, 1 times 2, 6 times 6, and 5 times 4. And, if you multiply, multiply all of that together you get 58, and that's how matrix multiplication works. So let's now go back and look at the more general case about matrix a, which is r m times d. I've got a matrix b which is r b times p, their inner dimension disappears. I get a matrix c, which is r m times p. If i'm looking at a particular element c i j, this is the row index, that's the column index. How do I get this element? I take the ith row of a and multiply it to the jth column of b. So the ith row of a, is a i 1, a i 2, the row index remains the same all the way through. Over here, I have b one j, b two j, up through b d j. So these last indices actually should be d not n. If you multiply them together using the rule that we just generated, I'm going to multiply this element with that element and component wise, and then add it up. We'll end up getting, this is the same as the sum over l going from 1 through d, a, i, l, b, l, d, which is exactly what we have done down here. So once we know how to multiply matrixes, I can start simplifying a lot of things. L 2 norm, remember, in the modular and vectors we talked about L 2 norm? We had said that L 2 norm is the sum of the components squared, square root. We'd also shown that this is nothing but a dot product square root. Now I'm going to show you a different interpretation for it. So I've got a vector 1 and minus 2. It's, L 2 norm is 1 squared plus minus 2 squared square root. I'm going to write that as 1 minus 2, that's a row vector times 1 minus 2, which is a column vector, and why do I do that? Because if I write out the expression for what this multiplication means, its the first component times the first component, second component times the second component, square root. So that's 1 squared, plus minus 2 squared, the same thing as down here. Now this row vector, I can also write it as, this vector, 1 minus 2, which is a column vector transpose, a transpose takes it to a row. Now we have the same vector, a vector 1 minus 2 transpose times itself square root, and that's what is written down here. The inner product between 2 vectors is nothing but take the first vector, take it's transpose, and multiply it to the second vector. This is a reminder, we had said in the, in the module for vectors, that if I don't specify it, every vector is a column vector. So, w is a column vector, v by itself is a column vector, I take it's transpose, I get a row vector, row vectors times a column vector always gives me a real number. And that's why the inner product turns out to be the real number. Alright. We know what our matrices now, the rectangular arrays of numbers. We know how to take its transpose, we know how to take its multiplication. Now we want to take the next step, and try to figure out what can matrices do, how are matrices and vectors connected to each other? And their connection turns out to be, coming from linear functions. So that's our next component of this module, linear functions. I'm going to call a function linear, if it has the following property. I take a vector x, and I take a vector y, I multiply this vector by a number alpha, and I multiply the vector y with the number beta, beta and alpha are real numbers. Back in the modular on vectors, we had talked about that alpha x plus beta y is another vector. All we do is making, multiply every component of x by alpha, every component of y by beta, and add them both component by component. So, now alpha x plus beta y is a new vector. I'm going to take the function at this new vector. If it so turns out that for any choice of x, any choice of y, any choice of alpha and beta, the function evaluated at this combination vector, is nothing but the same combination of evaluations of x and y. So, what's, what's important in terms of linearity, is that in one case I'm taking the liner combination inside the bracket, in the other case I'm taking the linear combination outside the bracket, and the 2 answers are the same, alpha x plus beta y. The function evaluated at this vector does nothing but the function evaluated at the vector x multiplied by alpha, plus the function evaluated at the vector y multiplies by beta. If this is true for all x, y, alpha, beta the function is linear. There is a simple theorem, we won't get into it, that a function is linear, if and only if, I can write that function as the multiplication of the vector by a matrix. So f of x is a linear function, if and only if, I can find some matrix a, such that f of x is nothing but a times x. It's just a multiplication by a matrix a, and that's why this is the next mod, next component to understanding what matrices can do. So, if I want to have a linear function from r 3 to r, I have to take vectors in r 3, and I have to get a number in r. So what should be a? So this multiplication, if a is going to be an r tie, m times d, and x is going to be an r d, a times x is going to be a vector in r to the m. Now, I want to map r 3, to r and therefore, the row index of a should be 1, and the column index should be exactly equal to d in effect, this should be a row vector. So here's a particular row vector 2 3 4, just as an example, if you look at the combination, if you look at the multiplication of 2 3 4 to the vector x1 X2, x3, you end up getting 2x 1, plus 3x 2, plus 4x 3. It takes vectors and maps it to real numbers. Take it one step further, here's another matrix a. Now this matrix has 2 rows and 3 columns, it's going to multiply a vector with 3 rows. And you'll end up getting another vector which has 2 components. Why 2? Because the row index is 2. So again, component by component multiplication. 2 times x1, plus 3 times x2, plus 4 times x3, that gives you the first component. 1 times x1, 0 times x2, 2 times x3, that gives you the second component, and that's what linear functions are. Linear functions take vectors, multiply them by a matrix, and give another vector. So, in most of this course, we won't really be interested in just functions, we'll be interested in constraints, we'll be interested in sets of vectors that are defined by functions. These might be portfolios, these might be values of options, these might be other kinds of things that are, random variables and so on. So we're going to talk about 2 different kinds of constraints, a linear equality. It would mean all those vectors x, such that they satisfy some linear equality. This is a linear function, it's equal to some given vector b. We'll all talk about linear inequalities, which means that all vectors x, such that ax is less than, equal to b. When I mean less than here, I mean component by component. So I'm going to say a vector 2, 3, is less than equal to a vector 4, 5, because component by component, 2 is less than 4, 3 is less than 5. But the same vector 2, 3, is not less than equal to the vector 4 1. Why? Because the first component is less than 4, but the second component is not. So therefore, this vector is not less than 4 1, but this vector 2 3, is less than 4 5. So if I say a vector a x, meaning the vector obtained by multiplying, a to x, is less than or equal to b. I mean that by component by component that vector should be less than b. Why did I only show you 1 inequality? Because, if you had an inequality, which is going the other way, ax greater than equal to b, that's nothing but minus a x, less than or equal to minus b. So, without loss of generality, I can just look at 1 side of the inequality, it turns out that it becomes easier to keep track of various things, if I just look at 1 side of the inequalities. Alright. I've got linear functions, I've got the notion of linear constraints. Now the next concept that I want to know about matrices, is what can linear functions do? How complicated can a set can linear function generate? And, that's going to be important when we start talking about spans of matrices, and how we can think in terms of what these spans do. So the next concept that we're going to learn is that of a rank of a matrix. There are 2 notions, I call them rank of a matrix, and a row rank of a matrix. Let's look through the examples, and we'll come back and look at more general ideas. And another related concept to rank, is the range of a matrix, and we'll, we'll try to make all of this clearer by looking at an example. So, down here is an example, I've got a matrix a, which is a 2 by 3 matrix, 2 rows, 3 columns. We know that this matrix induces a linear function, and what that linear function does is it takes a vector x which is in r3, so x is in r3, meaning it has three components. If you multiply this vector by the matrix a, you end up getting a vector ax, which is in r2. So, it maps 3 dimensional vectors into 2 dimensional vectors. This concept is important when we talk about ranges. But before we get there, let's start talking about a column rank. Column rank, I want to look at the rank, columns of this matrix, and ask myself, how many linear independent columns are there. How many columns can I take and write, and still leave them linearly independent? So I know for a fact, that because the columns are 2 dimensional, meaning that each column is an r 2, I can at most get 2 vectors. Back in the module, for vectors, we had talked about linear independent, and we said that in r 2, 2 vectors can be linearly independent, and the third vector will become linearly independent. So at most, I can get 2 columns that are linearly independent, but it turns out, that for this particular matrix, only 1 column is linear independent. Why? Because if I take the first column, 1 2, I can get the second column simply by multiplying the first column by 2. I can get the third column by simply multiplying the first column by 3. So the second and the third column are not linearly independent of the first column. So the column rank, which is the number of linearly independent columns, is 1, because I can only get 1 column. Now let's do the same thing for the rows, and we end up getting a concept of a row rank. So, here's my row 1, now it turns out, that if I take that row and multiply it by 2, I get the second row. So the row rank is also equal to 1. That's not a coincidence, there is a theorem which says that their row rank and the column rank are equal always for any matrix. So it turns out for this matrix the row rank is equal to 1, the column rank is equal to 1 and the rank itself is just equal to 1. So, next let's look at this notion of range. So, what we want to do, is we want to understand what does this matrix a do to the vectors in r3. So, now I want to think of this matrix not really as a matrix, but as a function since taking vectors in r3 and mapping them into vectors in r2. What kind of vectors I can get? What is the largest set of vectors that I can generate by this transformation? So, it, I'm going to multiply them by different components, so the vector ax is going to be equal to x1 plus 2 times x2 plus 3 times x3. The second component is going to be equal to 2 times x1, plus 4 times x 2, plus 6 times x3. That is what this vector a x 3 is going to be. So, x1 plus 2, times, x2 plus 3, times, x3 times 1, gives me the first component, x1 plus 2, times x2 plus 3, times, x3 times 2, gives me the second component. So every vector that I can generate by multiplying by the vector x, is of the form some real number, let's just call it lambda, times the vector 1 2, and that's exactly what is written down here. The range of a, the set of all vectors that I can generate by multiplying to the right hand side of a, by sum vector x, is all the vectors of the form lambda times 1 2. What does that mean? Now, going back to the notion r2 is this plane, one chooses the second component is equal to 2, the first component is equal to 1, that's this vector 1 2. In, in the r2 plane, all the, all the vectors that are possible, are represented by this r2 plane. But this matrix a, can only generate vectors on the straight line, nothing else can be generated by multiplying it by the vector x, and this is exactly what it means to have a rank 1. Rank 1, means that although the vector is sitting in r2, meaning that it has 2 components, really it's a one dimensional thing, that's what this 1 dimensional line tells me. On the other hand if this matrix a had rank 2, then that would tell me, that I should be able to generate everything in r2. Because it would, it would mean that there are two independent vectors that I could generate, and I know that in r2, using 2 independent vectors, I can generate anything, and so on. In the in this course, we will never get down to the details of how do I compute the rank, and so on. We'll work mostly with the, sort of the idea of what a rank is. And the idea that I want you to keep in mind is, the rank tells you the rich. Higher rank means that you can get a lot more things out of this linear function, lower rank means that you get less out of this linear function. In the next module, we're going to start talking about hedging, and bringing an optimization problem. And, there we'll notice that the rank, of the matrix will tell me how many different payoffs can I, can hedge. Before we finish this module on matrices, there's 1 last concept, and that's of inverse. If I've got a matrix a, which is a square matrix n by n, both the row column, row index, and the column index is the same. And the rank of the matrix is n, meaning that all the columns are linearly independent, all the rows are linearly independent, then, this matrix is invertible. What does that mean? It means that there exists a matrix a inverse, such that a inverse times a, is the same as, a times a inverse, and which is the same as identity. So this i, remember, was identity.

## 029.V

### 053. Review of Linear Optimization

>> . In this module, we will be walking through a review of linear optimization using a hedging example. We are going to see how there are two kinds of optimization problems, something called a primal optimization problem, something called a dual optimization problem, how they are related. And we also introduced the idea of La Grangian relaxation. Here's the hedging problem that we are interested in. I've got d assets. So take d, just to fix ideas, take d to be 3 or 4. But some number of assets that are there in the market. The price of these assets at time 0 is r to the d. It's some price vector, which has d components, where every component tells me the price of that particular asset. At time t equal to 1, the market outcomes are uncertain. I don't know what, which state the market is going to be, it's going to be in one of m possible states. So here's the situation at time T equal to zero, and I'm in state zero, And I could go to one of n different possible states. Go from one, two, all the way to, down to m. What do I mean by a state? For my purposes, state is simply telling me what are the different prices that can happen. So I'm going to characterize every state by the prices of the asset in that particular state And I can do it in 2 different ways. I could either tell you, what is the price of all the assets in any given state, Or I can tell you the price of a given in all possible states and we'll flip between these two ideas as we go through. We'll use the power of matrices to see what it means, sometimes, it's easier to represent it one way, Sometimes it's easier to represent it the other way. And understanding it both ways gives us an insight of which one is more beneficial for the particular application that I'm looking for. So, to motivate that, I'm going to define something called Sj. So S sub j, will be a column vector, and it will tell me the price of asset j in all possible states, So it's s1j, s2j all the way down to smj. J is fixed, it's asset j and the number of states would ran-, go from 1 to m. Now how do I represent all the assets in the market? I'm just going to take these column and stack them. S1 would refer to the column corresponding to S, asset one S2, asset two and so one up to S D. If I write them out in gory detail, you end up getting this matrix. The matrix has M rows, because it's got M states, its got D columns because its got D assets. And what going on here, every row here, tells you the price of all the assets in a particular state. So what I've circled here, are the prices in state 1, S1d, 12S, 11S, 12, all the way up to S1D. Genetically, somewhere it's going to be Sm1, Sm2 , all to Smd. So every row tells me what happens to all the assets in a given state, every column tells me what happens to a particular asset in all the different states. Alright, so that's how I'm going to describe my market. At times 0 I know the price, at time 1, which is the place where the market opens again, I don't know the price, it's uncertain, it's going to be one of n possible states, but I know that if the state is given to me, what the prices are. Now you might think that this is a very simple representation of the market, and indeed it is. But it turns out, that even in the most modern methods, of risk management, like value at risk, and conditional value at risk, people represent what happens to the market By a model which looks very much like this. Except instead of talking about states, we'll talk about simulations. I'm going to simulate returns and I'm going to say, depending on all of these different scenarios, what happens? But essentially the, the main ideas are going to be captured by this simple toy model. Alright, I know what happens to the asset. Now, what I want to do with these assets is to hedge an obligation. I'm going to walk through what does hedging mean. So, I have an obligation. What is an obligation? It's a vector x in rm. Why m? Because the obligation depends on the state. In a good state I might had to pay more, in a bad state I might had to pay less. So depending upon which state occurs, I'm going to pay an obligation xi, if this state i occurs. And what I want to do, is I want to buy a portfolio now, I want to buy a certain number of shares of the assets right now, in order to have enough money to pay my obligation. So, I'm going to choose a portfolio theta. Theta-1 through theta-d are going to be the number of shares that I'm going to purchase of each of these assets. I'm going to allow for the possibility of short selling, so thetas could be negative, or I'll buy them long, which is, when thetas are positive. And I want to do, I want to choose this portfolio, so I can hedge the obligation that, That I'm interested in hedging. So I'll step you through what it means and what, what hedging will ensue and then we'll go to what is the linear optimization problem that we end up getting. Okay! So at time 0, I'm going to put, buy a position theta at rd. Why d? Because it's got d different assets. So theta J's the number of shares of assets J that I purchased, where J goes from 1 through d. What's the cost of this purchase? The cost of the position theta, is simply the price of every asset times the number of shares that I produce. A lot of those assets! So it's pj times theta j, sum from j equal to 1 through d. It's the inner product of the vector p, with the vector theta. And we know that inner products are nothing but p transpose times theta. What happens at time t equal to 1? So, if a state i occurs, then I'm going to liquidate my position. And when I liquidate positions, I'm going to sell the assets. And what's going to happen? In state i, the price of asset j is s, i, j, I hold theta j positi-, shares of this asset, so by selling asset j I get Sij times theta j But I'm going to liquidate the entire portfolio. So j I'm going to sum from 1 equal to d and that's the amount of money, that's the pay-off that I'm going to get in the stake. Its just Sij time theta j sum from j equal to 1 through d, That gives me yi. And if you just think about it for a moment, if I stock up all the pay-offs as a vector. If I call a vector y to be y1, y2, all the way up to y m, the pay-offs in the m states This is nothing but the matrix S, Times the vector theta. Just to remind you, this is my matrix S, it has prices for every state as rows. So the payoff in the first state would be this row times the vector. And the second state would be this row times the vector. And that's exactly what is being done here. Sij, as j goes from 1 through D, is a row. You take the i'th row, multiply it by the vector, you get the payoff in the i'th state. And therefore, the vector y is simply the matrix, times theta. Now I want to look at this, in a different way. I want to think of this, as not multiplying row, row by row but column by column. So, instead of looking at this matrix S, as row by row as we have done so far, I'm going to put them in columns. I've got the column for the first asset, column for the second asset, column for the d asset and, that's going to multiply theta-1 theta-2 up to theta-d. And you can see that this multiplication is nothing but, this row, times this column, so you'll get theta j times Sj. J is summed from 1 through, that should not be an n, but a d. It goes from j equals 1, through d. Interpreting it this way, you end up getting a different interpretation of what is going on. Now, the pay-offs ys are nothing but linear combinations of the columns. So vector y, will, I can represent, I can generate a particular pay-off, if it's in the range of the matrix S. Remember in the concept, we had introduced this concept in the model of matrices, that a vector y, belongs to the range, of s, if these are all vectors s-theta, where theta is in, r to the d. And therefore, y belongs to the range of S. And remember, we had also introduced the notion of rank. We had said, that rank tells me how rich that space is. Can I, how many different vectors can I generate in the range? So if the rank of the matrix S is n, is equal to m, meaning all possible pay-offs can be generated, then I can hedge everything. If on the other hand, the rank of the matrix s, is less than m, that means there are certain pay-offs. There are certain pay-off vectors that can not be generated because they can not be produced as if I'm make, taking the matrix S and multiplying it to theta. So that's the concept that's going to play a role in the course.We're going to talk about complete markets and incomplete markets, and that has to do with the rank of this matrix. Before we get there, here's a simpler notion. We'll say that a pay-off y hedges x, if y is greater than or equal to x. Component by component, the pay-off that I've generated using my portfolio is greater than the pay-off that I need to hedge or give-, the payoff that I need to give at time 1. Alright, now comes our first optimization problem. What's the optimization problem? I want to minimize the price of the portfolio such that it hedges my obligation. I want to minimize p transpose theta, such that s-theta is greater or equal to x. And, what are some features about this optimization problem? The objective! What I'm trying to maximize or minimize is a linear function, linear function of theta. The constraints! Constraints, and what thetas that I can choose, are again linear constraints, as theta must be greater than or equal to x. Linear or inequality. So any optimization problem, which has a linear objective function, either minimization or maximization it doesn't matter, and all the constraints are either linear inequalities, as is the case here, or linear equalities. We will call that problem, a linear optimization problem, or a linear program. It turns out that linear programs are very rich, there's a rich theory about them, and you can do a lot of interesting things with them. You can model lots of problems, you can solve them very efficiently, you can get a lot of interpretation out of them. So the one thing that we're going to focus on in linear optimization, and the interpretation of linear optimization is the notion of duality. And what do I mean by the notion of duality? For every linear program, I can write another linear program which is intimately connected to it, and this connection is called duality. So I've got a linear program here minimize x, c transpose x, Ax greater than or equal to b. Here's another linear program. Maximize B transpose U, A transpose U equal to C and U is greater than or equal to 0. Min goes to max. Now, for the purposes of this course, you will not be responsible for how I generated the dual linear program from the primal linear program, or the second linear program from the first linear program, we will give you that in the course. The only thing that you're going to be responsible for is, to understand the relationship, and we'll emphasize this again during the course. They're here from-, some of the interesting resolve that comes from this duality concept. The first thing is something called weak duality. What it says is that this minimization problem. So the way I, the picture that I have, I wanted to keep in mind is that here's my value P. For all feasible values, for all xs, such that Ax is greater than or equal to wha-, b, I get some numbers on this side. Why do I get greater? Because I'm trying to minimize. So I get the lowest possible number is p. I've got another number d. Which is the value of this second linear program down here. For all Us that are feasible, meaning that satisfies A transpose U equal to C, and U is greater than or equal to 0, I'll get values that are less than this D. Why? Because this is a maximization problem. The largest possible thing that I can get is B transpose U, is going to be equal to D. The first theorem says, that in fact, this picture that I'm drawing is correct. That P is going to be greater than D. There's no reason for it to be that way, they could have crossed. But the nice thing is, if you construct the dual linear program correctly, and in the next slide I'm going to show you a simple example. Again let me emphasize you're not responsible for knowing it. Just walking through the exercise, and understanding how I'm going to use the duality. So the primal and the dual are intimately connected; the optimum value of the primal P is greater than equal to the optimum value of the dual D. And because this is true, you end up getting a chain of inequalities that are very good. We know that c transpose x is greater than equal to p. Why? Because I''m trying to minimize c transpose x, so for any feasible x, anything that satisfies the inequality Ax greater than equal to b, I'll get a value greater that b. The second piece is also true, D is greater than equal to b, transpose u because I'm trying to maximize b transpose u. And the inner part comes because of the v duality. So now this gives you a very interesting way, if I can find an x, and I can find a u, such that c transpose x is close to b transpose u, then I know that the x must be very close to optimal, And u must also be very close to optimal for the dual. Why? Because P is greater than, equal to D, if these two at, points are very close, it must, it must be that P is also very close to c transpose x, which means that it's optimum. Similarly, b transpose u must be close to D, which means that is optimum. You end up, you can go one step further, and say that when either P, or D, is finite, either the primal value is finite, or the dual value is finite, then in fact, they must be equal. And finally, the reason why we call them dual, is because if you go from the primal to the dual, and from, you take the dual of the dual, you get back the primal, and that's why they're called dual linear programs. Going a little bit further. Here's another pair of primal dual linear programs that we'll be, that we'll be using in the course. Minimize over x, c transpose x, Ax equals b, they, it's equal to maximize u, b transpose u, A transpose u equal to c. And this equality, I'm putting it there to emphasize the fact that there is strong duality between them. But to keep in mind that this equality holds only if you can show that either this one, p or this one, b is finite. So if p, or d is less than, is less than, is not equal to let's say, plus infinity or minus infinity, in that case these two values are the same, and in that sense they are equal. So, the last piece in this module, we're going to walk through and tell you how to construct a duel, it's a very general concept called La Grangian relaxation. And we'll use that in the next module on non linear programming, as well. So here's the problem. The primal problem is, minimize c transpose x, Ax, greater than or equal to b. Now I'm going to take a vector u, which is greater than or equal to zero. And so u is component wise greater then or equal to 0, and remember Ax is going to be greater than equal to b. So Ax minus b is component wise greater than equal to 0, you take some vector which is component wise greater than equal to the oh, multiplied to another vector that is component wise greater than equal to 0, you end up getting a number, which is greater than or equal to 0. So I'm subtracting it, so I'm getting a number, which is less than c transpose x. So this linear program, which has a changed objective function involving this vector u, is going to have a value, which is going to be less than equal to P. B transpose U does not involve the decision x, it does not involve the minimization, the minimization is going on over x, it does not involve x, so I pull that out. I end up getting a new problem, which is minimize c minus a transpose u times x. And what happened to this constraint? I threw it away! Why did I throw it away? It's complicated. I don't know how to deal with constraints, so I threw it away. But I'm guaranteed that if I throw away these constraints my set over which I can optimize, the xs over that I can chose become larger, and therefore this minimum only becomes smaller. So I end up getting that this quantity, is going to be smaller than the previous line. Now, because I don't have any constraints, I have a very simple problem. I've got some vector, let's call this vector d. I've got d transpose x. So I want to minimize d transpose x. So here's my d vector. I want to minimize this, d transpose x, and I can choose my x to be anything. So what am I going to do? I'm going to choose my x to be in the negative direction and going off to infinity. Here's my b, here's my x! If I multiply d and x together I get a very large negative number. So if I have vector d which is not equal to 0, I can make this optimization problem equal to minus infinity and that's what this says. If d is not equal to 0 and, just to emphasize d's equal to c minus A transpose u, if this is not equal to 0 you get to minus infinity. If in fact, d is equal to 0, which means that c is equal to A transpose u, then I can't do anything over here. This vector is equal to 0, I multiply to any other vector, I'll get a 0. So you end up getting that this minimization problem has a value equal to 0. And p is greater then equal to b transpose u. Now u is arbitrary, the only thing that I needed to do was, which is missed over here, is that I needed to have that u must be greater than equal to zero. So now, you have p must be greater than equal to maximize b transpose u, which is the value here, provided A transpose u is equal to c and u is greater than equal to 0. That immediately gives you a weak duality, a little bit more work gives you a strong duality. So here's the connection. Max-, minimize C transpose x, Ax greater than or equal to B is equal to maximize B transpose U, A transpose U equal to C, and U greater than equal to 0. That's what we derived over here. What we did, we dualize constraints, and this word will show up some times during the course. Dualize means I take the constraints and multiply them by a variable which has a particular sign. We had a constraint Ax minus b, I multiplied by a vector of u which is greater than equal to 0, that's dualization and then I'd relax the constraint. I have this constraint Ax greater than equal to b, I didn't like it, it was too complicated, I threw it away. I'd relaxed them! And by doing dualization and relaxation, you end up getting something called a La Grangian relaxation, which gives you duals, And gives you some very nice properties that we'll explore more in the course. .

